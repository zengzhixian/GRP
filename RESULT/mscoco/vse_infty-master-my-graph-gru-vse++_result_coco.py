[root@gpu1 vse_infty-master-my-graph-gru-vse++]# sh train_region.sh 
2021-06-23 08:26:49,773 Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=False, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vse_mean_warmup_epochs=1, word_dim=300, workers=10)
2021-06-23 08:26:49,773 Model name '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' not found in model shortcut name list (bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese, bert-base-german-cased, bert-large-uncased-whole-word-masking, bert-large-cased-whole-word-masking, bert-large-uncased-whole-word-masking-finetuned-squad, bert-large-cased-whole-word-masking-finetuned-squad, bert-base-cased-finetuned-mrpc). Assuming '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' is a path or url to a directory containing tokenizer files.
2021-06-23 08:26:49,773 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/added_tokens.json. We won't load it.
2021-06-23 08:26:49,773 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/special_tokens_map.json. We won't load it.
2021-06-23 08:26:49,773 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/tokenizer_config.json. We won't load it.
2021-06-23 08:26:49,774 loading file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/vocab.txt
2021-06-23 08:26:49,774 loading file None
2021-06-23 08:26:49,774 loading file None
2021-06-23 08:26:49,774 loading file None
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-vse++/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-vse++/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
2021-06-23 08:27:20,165 loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
2021-06-23 08:27:20,165 Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

2021-06-23 08:27:20,166 loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
2021-06-23 08:27:28,481 Use adam as the optimizer, with init lr 0.0005
2021-06-23 08:27:28,482 Image encoder is data paralleled now.
2021-06-23 08:27:28,483 runs/coco_butd_region_bert/log
2021-06-23 08:27:28,483 runs/coco_butd_region_bert
2021-06-23 08:27:28,485 image encoder trainable parameters: 20490144
2021-06-23 08:27:28,495 txt encoder trainable parameters: 137319072
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
2021-06-23 08:31:19,223 Epoch: [0][199/4426]	Eit 200  lr 0.0005  Le 309.5188 (565.2847)	Time 1.019 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:34:49,732 Epoch: [0][399/4426]	Eit 400  lr 0.0005  Le 321.7711 (431.7807)	Time 0.982 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:38:17,643 Epoch: [0][599/4426]	Eit 600  lr 0.0005  Le 265.6764 (374.0884)	Time 0.775 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:41:44,731 Epoch: [0][799/4426]	Eit 800  lr 0.0005  Le 146.7235 (338.3644)	Time 0.977 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:45:10,540 Epoch: [0][999/4426]	Eit 1000  lr 0.0005  Le 176.2880 (315.1437)	Time 1.006 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:48:41,514 Epoch: [0][1199/4426]	Eit 1200  lr 0.0005  Le 215.8603 (297.3361)	Time 1.130 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:52:08,870 Epoch: [0][1399/4426]	Eit 1400  lr 0.0005  Le 305.1017 (282.5666)	Time 0.575 (0.000)	Data 0.004 (0.000)	
2021-06-23 08:55:33,509 Epoch: [0][1599/4426]	Eit 1600  lr 0.0005  Le 217.0822 (271.1952)	Time 1.368 (0.000)	Data 0.002 (0.000)	
2021-06-23 08:59:02,539 Epoch: [0][1799/4426]	Eit 1800  lr 0.0005  Le 168.8362 (261.8182)	Time 0.973 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:02:29,534 Epoch: [0][1999/4426]	Eit 2000  lr 0.0005  Le 171.2332 (253.4841)	Time 1.095 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:05:56,858 Epoch: [0][2199/4426]	Eit 2200  lr 0.0005  Le 166.1968 (246.2224)	Time 0.948 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:09:22,367 Epoch: [0][2399/4426]	Eit 2400  lr 0.0005  Le 212.8664 (239.8829)	Time 1.048 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:12:49,435 Epoch: [0][2599/4426]	Eit 2600  lr 0.0005  Le 164.3303 (233.6675)	Time 0.954 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:16:17,458 Epoch: [0][2799/4426]	Eit 2800  lr 0.0005  Le 191.4212 (228.6325)	Time 1.168 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:19:45,099 Epoch: [0][2999/4426]	Eit 3000  lr 0.0005  Le 147.9240 (224.2577)	Time 1.041 (0.000)	Data 0.004 (0.000)	
2021-06-23 09:23:12,932 Epoch: [0][3199/4426]	Eit 3200  lr 0.0005  Le 164.4457 (220.2208)	Time 0.955 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:26:37,570 Epoch: [0][3399/4426]	Eit 3400  lr 0.0005  Le 179.3179 (216.3863)	Time 1.390 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:30:06,366 Epoch: [0][3599/4426]	Eit 3600  lr 0.0005  Le 232.5741 (212.9530)	Time 1.040 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:33:34,043 Epoch: [0][3799/4426]	Eit 3800  lr 0.0005  Le 123.8747 (209.6636)	Time 1.053 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:37:06,797 Epoch: [0][3999/4426]	Eit 4000  lr 0.0005  Le 96.3170 (206.5005)	Time 0.955 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:40:36,300 Epoch: [0][4199/4426]	Eit 4200  lr 0.0005  Le 132.9693 (203.7338)	Time 0.840 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:44:07,919 Epoch: [0][4399/4426]	Eit 4400  lr 0.0005  Le 161.8207 (201.1183)	Time 1.141 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:44:43,404 Test: [0/40]	Le 325.5653 (325.5651)	Time 7.536 (0.000)	
2021-06-23 09:45:00,180 calculate similarity time: 0.07382559776306152
2021-06-23 09:45:00,673 Image to text: 55.7, 87.3, 95.1, 1.0, 3.7
2021-06-23 09:45:00,985 Text to image: 44.4, 79.9, 91.7, 2.0, 4.6
2021-06-23 09:45:00,986 Current rsum is 454.03999999999996
2021-06-23 09:45:04,007 runs/coco_butd_region_bert/log
2021-06-23 09:45:04,007 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 09:45:04,009 image encoder trainable parameters: 20490144
2021-06-23 09:45:04,014 txt encoder trainable parameters: 137319072
2021-06-23 09:48:14,758 Epoch: [1][174/4426]	Eit 4600  lr 0.0005  Le 37.6176 (34.1351)	Time 0.872 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:51:44,511 Epoch: [1][374/4426]	Eit 4800  lr 0.0005  Le 34.0107 (33.9779)	Time 1.172 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:55:14,282 Epoch: [1][574/4426]	Eit 5000  lr 0.0005  Le 31.3793 (33.5904)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-23 09:58:37,264 Epoch: [1][774/4426]	Eit 5200  lr 0.0005  Le 31.7474 (33.1835)	Time 1.270 (0.000)	Data 0.003 (0.000)	
2021-06-23 10:02:07,007 Epoch: [1][974/4426]	Eit 5400  lr 0.0005  Le 30.2364 (32.9258)	Time 0.852 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:05:34,611 Epoch: [1][1174/4426]	Eit 5600  lr 0.0005  Le 30.5116 (32.7070)	Time 1.320 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:09:02,128 Epoch: [1][1374/4426]	Eit 5800  lr 0.0005  Le 24.3921 (32.4482)	Time 1.297 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:12:30,387 Epoch: [1][1574/4426]	Eit 6000  lr 0.0005  Le 27.9241 (32.2155)	Time 0.989 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:16:00,735 Epoch: [1][1774/4426]	Eit 6200  lr 0.0005  Le 34.6610 (32.0233)	Time 1.314 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:19:28,803 Epoch: [1][1974/4426]	Eit 6400  lr 0.0005  Le 29.0376 (31.8325)	Time 0.877 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:22:57,527 Epoch: [1][2174/4426]	Eit 6600  lr 0.0005  Le 30.3376 (31.6477)	Time 0.960 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:26:28,245 Epoch: [1][2374/4426]	Eit 6800  lr 0.0005  Le 29.5271 (31.4759)	Time 1.237 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:29:57,236 Epoch: [1][2574/4426]	Eit 7000  lr 0.0005  Le 26.7439 (31.3000)	Time 0.974 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:33:18,503 Epoch: [1][2774/4426]	Eit 7200  lr 0.0005  Le 28.9768 (31.1360)	Time 0.952 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:36:47,896 Epoch: [1][2974/4426]	Eit 7400  lr 0.0005  Le 28.2194 (31.0072)	Time 0.886 (0.000)	Data 0.003 (0.000)	
2021-06-23 10:40:16,633 Epoch: [1][3174/4426]	Eit 7600  lr 0.0005  Le 30.2228 (30.8679)	Time 0.943 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:43:45,833 Epoch: [1][3374/4426]	Eit 7800  lr 0.0005  Le 29.3470 (30.7191)	Time 0.837 (0.000)	Data 0.003 (0.000)	
2021-06-23 10:47:17,362 Epoch: [1][3574/4426]	Eit 8000  lr 0.0005  Le 28.7141 (30.5797)	Time 1.205 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:50:48,509 Epoch: [1][3774/4426]	Eit 8200  lr 0.0005  Le 25.5707 (30.4539)	Time 1.323 (0.000)	Data 0.018 (0.000)	
2021-06-23 10:54:16,761 Epoch: [1][3974/4426]	Eit 8400  lr 0.0005  Le 24.3645 (30.3439)	Time 0.907 (0.000)	Data 0.002 (0.000)	
2021-06-23 10:57:47,001 Epoch: [1][4174/4426]	Eit 8600  lr 0.0005  Le 27.2373 (30.2322)	Time 1.230 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:01:17,312 Epoch: [1][4374/4426]	Eit 8800  lr 0.0005  Le 25.7613 (30.1296)	Time 1.154 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:02:18,888 Test: [0/40]	Le 58.6010 (58.6010)	Time 7.804 (0.000)	
2021-06-23 11:02:35,041 calculate similarity time: 0.07432937622070312
2021-06-23 11:02:35,477 Image to text: 72.3, 95.0, 98.8, 1.0, 3.9
2021-06-23 11:02:35,797 Text to image: 58.0, 88.9, 95.4, 1.0, 3.9
2021-06-23 11:02:35,797 Current rsum is 508.4800000000001
2021-06-23 11:02:39,683 runs/coco_butd_region_bert/log
2021-06-23 11:02:39,683 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 11:02:39,686 image encoder trainable parameters: 20490144
2021-06-23 11:02:39,697 txt encoder trainable parameters: 137319072
2021-06-23 11:05:19,918 Epoch: [2][149/4426]	Eit 9000  lr 0.0005  Le 29.0226 (26.6533)	Time 0.909 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:08:50,862 Epoch: [2][349/4426]	Eit 9200  lr 0.0005  Le 26.9193 (26.6613)	Time 0.926 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:12:18,006 Epoch: [2][549/4426]	Eit 9400  lr 0.0005  Le 23.8513 (26.6918)	Time 1.028 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:15:43,652 Epoch: [2][749/4426]	Eit 9600  lr 0.0005  Le 26.8250 (26.7089)	Time 0.900 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:19:12,445 Epoch: [2][949/4426]	Eit 9800  lr 0.0005  Le 27.3854 (26.6808)	Time 0.893 (0.000)	Data 0.003 (0.000)	
2021-06-23 11:22:42,472 Epoch: [2][1149/4426]	Eit 10000  lr 0.0005  Le 27.9113 (26.6184)	Time 1.034 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:26:09,789 Epoch: [2][1349/4426]	Eit 10200  lr 0.0005  Le 25.5295 (26.6013)	Time 0.957 (0.000)	Data 0.003 (0.000)	
2021-06-23 11:29:34,662 Epoch: [2][1549/4426]	Eit 10400  lr 0.0005  Le 27.3629 (26.5659)	Time 1.014 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:33:03,330 Epoch: [2][1749/4426]	Eit 10600  lr 0.0005  Le 27.2232 (26.5625)	Time 1.033 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:36:27,888 Epoch: [2][1949/4426]	Eit 10800  lr 0.0005  Le 26.6235 (26.5372)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:39:53,070 Epoch: [2][2149/4426]	Eit 11000  lr 0.0005  Le 24.0891 (26.4702)	Time 0.910 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:43:22,192 Epoch: [2][2349/4426]	Eit 11200  lr 0.0005  Le 24.2002 (26.4300)	Time 0.805 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:46:49,378 Epoch: [2][2549/4426]	Eit 11400  lr 0.0005  Le 24.9618 (26.3945)	Time 0.990 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:50:14,355 Epoch: [2][2749/4426]	Eit 11600  lr 0.0005  Le 26.2362 (26.3632)	Time 1.014 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:53:40,587 Epoch: [2][2949/4426]	Eit 11800  lr 0.0005  Le 26.5419 (26.3386)	Time 0.970 (0.000)	Data 0.002 (0.000)	
2021-06-23 11:57:09,526 Epoch: [2][3149/4426]	Eit 12000  lr 0.0005  Le 27.0330 (26.3045)	Time 1.006 (0.000)	Data 0.003 (0.000)	
2021-06-23 12:00:41,509 Epoch: [2][3349/4426]	Eit 12200  lr 0.0005  Le 24.0358 (26.2669)	Time 0.913 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:04:11,158 Epoch: [2][3549/4426]	Eit 12400  lr 0.0005  Le 21.3436 (26.2224)	Time 1.059 (0.000)	Data 0.011 (0.000)	
2021-06-23 12:07:37,893 Epoch: [2][3749/4426]	Eit 12600  lr 0.0005  Le 22.7061 (26.1972)	Time 1.003 (0.000)	Data 0.009 (0.000)	
2021-06-23 12:11:01,756 Epoch: [2][3949/4426]	Eit 12800  lr 0.0005  Le 25.0730 (26.1637)	Time 1.063 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:14:31,455 Epoch: [2][4149/4426]	Eit 13000  lr 0.0005  Le 23.5419 (26.1290)	Time 0.830 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:18:00,102 Epoch: [2][4349/4426]	Eit 13200  lr 0.0005  Le 27.1201 (26.0962)	Time 1.263 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:19:27,880 Test: [0/40]	Le 59.2626 (59.2626)	Time 8.101 (0.000)	
2021-06-23 12:19:43,513 calculate similarity time: 0.07386064529418945
2021-06-23 12:19:43,936 Image to text: 75.4, 97.2, 99.0, 1.0, 2.2
2021-06-23 12:19:44,247 Text to image: 61.4, 90.7, 96.3, 1.0, 3.7
2021-06-23 12:19:44,248 Current rsum is 519.98
2021-06-23 12:19:48,119 runs/coco_butd_region_bert/log
2021-06-23 12:19:48,120 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 12:19:48,123 image encoder trainable parameters: 20490144
2021-06-23 12:19:48,135 txt encoder trainable parameters: 137319072
2021-06-23 12:22:05,354 Epoch: [3][124/4426]	Eit 13400  lr 0.0005  Le 24.6022 (24.1336)	Time 1.011 (0.000)	Data 0.003 (0.000)	
2021-06-23 12:25:37,257 Epoch: [3][324/4426]	Eit 13600  lr 0.0005  Le 25.6774 (24.3713)	Time 1.088 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:29:06,018 Epoch: [3][524/4426]	Eit 13800  lr 0.0005  Le 26.1152 (24.3160)	Time 0.888 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:32:35,873 Epoch: [3][724/4426]	Eit 14000  lr 0.0005  Le 26.7860 (24.2303)	Time 0.906 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:36:06,742 Epoch: [3][924/4426]	Eit 14200  lr 0.0005  Le 29.4396 (24.2730)	Time 0.823 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:39:36,978 Epoch: [3][1124/4426]	Eit 14400  lr 0.0005  Le 27.7598 (24.2869)	Time 1.031 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:42:59,490 Epoch: [3][1324/4426]	Eit 14600  lr 0.0005  Le 29.1596 (24.2780)	Time 0.990 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:46:25,140 Epoch: [3][1524/4426]	Eit 14800  lr 0.0005  Le 24.4937 (24.2784)	Time 1.250 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:49:55,179 Epoch: [3][1724/4426]	Eit 15000  lr 0.0005  Le 29.2154 (24.2726)	Time 0.999 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:53:22,570 Epoch: [3][1924/4426]	Eit 15200  lr 0.0005  Le 24.3610 (24.2968)	Time 0.864 (0.000)	Data 0.002 (0.000)	
2021-06-23 12:56:49,582 Epoch: [3][2124/4426]	Eit 15400  lr 0.0005  Le 20.9052 (24.2449)	Time 0.997 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:00:14,819 Epoch: [3][2324/4426]	Eit 15600  lr 0.0005  Le 24.8901 (24.2069)	Time 0.991 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:03:45,723 Epoch: [3][2524/4426]	Eit 15800  lr 0.0005  Le 26.8319 (24.2124)	Time 1.066 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:07:12,862 Epoch: [3][2724/4426]	Eit 16000  lr 0.0005  Le 24.1689 (24.1686)	Time 1.005 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:10:40,650 Epoch: [3][2924/4426]	Eit 16200  lr 0.0005  Le 19.9079 (24.1454)	Time 1.257 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:14:09,743 Epoch: [3][3124/4426]	Eit 16400  lr 0.0005  Le 21.2902 (24.1259)	Time 0.972 (0.000)	Data 0.004 (0.000)	
2021-06-23 13:17:33,129 Epoch: [3][3324/4426]	Eit 16600  lr 0.0005  Le 24.6155 (24.1107)	Time 1.243 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:21:01,044 Epoch: [3][3524/4426]	Eit 16800  lr 0.0005  Le 21.7083 (24.0852)	Time 1.007 (0.000)	Data 0.003 (0.000)	
2021-06-23 13:24:28,682 Epoch: [3][3724/4426]	Eit 17000  lr 0.0005  Le 23.1321 (24.0656)	Time 1.037 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:27:58,658 Epoch: [3][3924/4426]	Eit 17200  lr 0.0005  Le 24.2047 (24.0619)	Time 0.950 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:31:25,277 Epoch: [3][4124/4426]	Eit 17400  lr 0.0005  Le 23.9288 (24.0336)	Time 1.251 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:34:52,888 Epoch: [3][4324/4426]	Eit 17600  lr 0.0005  Le 24.2650 (24.0141)	Time 0.870 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:36:47,736 Test: [0/40]	Le 60.1421 (60.1420)	Time 8.733 (0.000)	
2021-06-23 13:37:03,575 calculate similarity time: 0.06139850616455078
2021-06-23 13:37:04,039 Image to text: 75.5, 96.3, 98.9, 1.0, 3.5
2021-06-23 13:37:04,349 Text to image: 62.2, 91.0, 96.3, 1.0, 3.8
2021-06-23 13:37:04,349 Current rsum is 520.2400000000001
2021-06-23 13:37:07,865 runs/coco_butd_region_bert/log
2021-06-23 13:37:07,865 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 13:37:07,867 image encoder trainable parameters: 20490144
2021-06-23 13:37:07,874 txt encoder trainable parameters: 137319072
2021-06-23 13:39:01,225 Epoch: [4][99/4426]	Eit 17800  lr 0.0005  Le 24.2372 (22.6441)	Time 0.924 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:42:27,324 Epoch: [4][299/4426]	Eit 18000  lr 0.0005  Le 21.0393 (22.6997)	Time 1.353 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:45:53,709 Epoch: [4][499/4426]	Eit 18200  lr 0.0005  Le 23.8863 (22.7388)	Time 0.819 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:49:15,014 Epoch: [4][699/4426]	Eit 18400  lr 0.0005  Le 21.8106 (22.7866)	Time 0.906 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:52:41,780 Epoch: [4][899/4426]	Eit 18600  lr 0.0005  Le 22.6204 (22.7291)	Time 0.802 (0.000)	Data 0.005 (0.000)	
2021-06-23 13:56:09,789 Epoch: [4][1099/4426]	Eit 18800  lr 0.0005  Le 17.7737 (22.6964)	Time 1.040 (0.000)	Data 0.002 (0.000)	
2021-06-23 13:59:37,082 Epoch: [4][1299/4426]	Eit 19000  lr 0.0005  Le 17.9488 (22.7322)	Time 1.064 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:03:06,009 Epoch: [4][1499/4426]	Eit 19200  lr 0.0005  Le 23.7926 (22.7109)	Time 0.965 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:06:36,033 Epoch: [4][1699/4426]	Eit 19400  lr 0.0005  Le 18.2029 (22.6801)	Time 1.606 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:10:05,156 Epoch: [4][1899/4426]	Eit 19600  lr 0.0005  Le 21.0125 (22.7022)	Time 1.027 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:13:35,792 Epoch: [4][2099/4426]	Eit 19800  lr 0.0005  Le 21.8869 (22.6879)	Time 0.914 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:17:05,325 Epoch: [4][2299/4426]	Eit 20000  lr 0.0005  Le 25.8180 (22.6610)	Time 0.897 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:20:30,509 Epoch: [4][2499/4426]	Eit 20200  lr 0.0005  Le 23.1366 (22.6915)	Time 1.233 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:23:53,691 Epoch: [4][2699/4426]	Eit 20400  lr 0.0005  Le 22.5580 (22.6805)	Time 1.264 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:27:22,890 Epoch: [4][2899/4426]	Eit 20600  lr 0.0005  Le 18.5232 (22.6773)	Time 0.868 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:30:48,999 Epoch: [4][3099/4426]	Eit 20800  lr 0.0005  Le 24.2041 (22.6791)	Time 1.315 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:34:17,596 Epoch: [4][3299/4426]	Eit 21000  lr 0.0005  Le 21.5419 (22.6635)	Time 0.941 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:37:44,694 Epoch: [4][3499/4426]	Eit 21200  lr 0.0005  Le 20.9799 (22.6441)	Time 1.116 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:41:13,137 Epoch: [4][3699/4426]	Eit 21400  lr 0.0005  Le 25.8592 (22.6272)	Time 1.189 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:44:41,944 Epoch: [4][3899/4426]	Eit 21600  lr 0.0005  Le 26.2525 (22.6285)	Time 0.860 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:48:11,064 Epoch: [4][4099/4426]	Eit 21800  lr 0.0005  Le 25.2381 (22.6186)	Time 0.911 (0.000)	Data 0.003 (0.000)	
2021-06-23 14:51:38,274 Epoch: [4][4299/4426]	Eit 22000  lr 0.0005  Le 18.9274 (22.6084)	Time 1.224 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:53:55,033 Test: [0/40]	Le 59.6791 (59.6791)	Time 8.637 (0.000)	
2021-06-23 14:54:11,186 calculate similarity time: 0.06562423706054688
2021-06-23 14:54:11,737 Image to text: 79.4, 97.0, 98.9, 1.0, 4.3
2021-06-23 14:54:12,051 Text to image: 63.1, 91.4, 96.8, 1.0, 4.0
2021-06-23 14:54:12,051 Current rsum is 526.5600000000001
2021-06-23 14:54:15,599 runs/coco_butd_region_bert/log
2021-06-23 14:54:15,600 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 14:54:15,603 image encoder trainable parameters: 20490144
2021-06-23 14:54:15,613 txt encoder trainable parameters: 137319072
2021-06-23 14:55:41,741 Epoch: [5][74/4426]	Eit 22200  lr 0.0005  Le 27.8233 (21.6653)	Time 0.967 (0.000)	Data 0.002 (0.000)	
2021-06-23 14:59:13,050 Epoch: [5][274/4426]	Eit 22400  lr 0.0005  Le 23.5793 (21.4298)	Time 1.010 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:02:39,645 Epoch: [5][474/4426]	Eit 22600  lr 0.0005  Le 19.4946 (21.6126)	Time 1.242 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:06:08,013 Epoch: [5][674/4426]	Eit 22800  lr 0.0005  Le 19.1219 (21.5991)	Time 0.942 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:09:36,766 Epoch: [5][874/4426]	Eit 23000  lr 0.0005  Le 18.2704 (21.6395)	Time 1.210 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:13:03,952 Epoch: [5][1074/4426]	Eit 23200  lr 0.0005  Le 20.3908 (21.6414)	Time 1.003 (0.000)	Data 0.003 (0.000)	
2021-06-23 15:16:31,822 Epoch: [5][1274/4426]	Eit 23400  lr 0.0005  Le 19.1883 (21.6436)	Time 0.797 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:20:01,554 Epoch: [5][1474/4426]	Eit 23600  lr 0.0005  Le 21.0370 (21.6295)	Time 1.224 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:23:29,998 Epoch: [5][1674/4426]	Eit 23800  lr 0.0005  Le 19.4656 (21.6359)	Time 1.032 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:26:54,246 Epoch: [5][1874/4426]	Eit 24000  lr 0.0005  Le 24.9605 (21.6407)	Time 0.810 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:30:22,298 Epoch: [5][2074/4426]	Eit 24200  lr 0.0005  Le 21.4236 (21.6521)	Time 0.874 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:33:48,332 Epoch: [5][2274/4426]	Eit 24400  lr 0.0005  Le 24.6809 (21.6555)	Time 1.289 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:37:14,351 Epoch: [5][2474/4426]	Eit 24600  lr 0.0005  Le 20.1410 (21.6559)	Time 1.062 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:40:42,957 Epoch: [5][2674/4426]	Eit 24800  lr 0.0005  Le 25.0585 (21.6456)	Time 0.847 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:44:11,554 Epoch: [5][2874/4426]	Eit 25000  lr 0.0005  Le 25.3547 (21.6690)	Time 0.895 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:47:37,096 Epoch: [5][3074/4426]	Eit 25200  lr 0.0005  Le 20.2834 (21.6796)	Time 1.114 (0.000)	Data 0.010 (0.000)	
2021-06-23 15:51:08,009 Epoch: [5][3274/4426]	Eit 25400  lr 0.0005  Le 22.3208 (21.6885)	Time 0.877 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:54:35,785 Epoch: [5][3474/4426]	Eit 25600  lr 0.0005  Le 24.8115 (21.6833)	Time 0.912 (0.000)	Data 0.002 (0.000)	
2021-06-23 15:58:05,131 Epoch: [5][3674/4426]	Eit 25800  lr 0.0005  Le 24.3079 (21.6831)	Time 1.176 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:01:30,723 Epoch: [5][3874/4426]	Eit 26000  lr 0.0005  Le 19.1365 (21.6859)	Time 1.281 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:05:00,056 Epoch: [5][4074/4426]	Eit 26200  lr 0.0005  Le 20.8358 (21.6887)	Time 0.982 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:08:31,184 Epoch: [5][4274/4426]	Eit 26400  lr 0.0005  Le 21.3043 (21.6784)	Time 1.062 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:11:19,821 Test: [0/40]	Le 58.9454 (58.9454)	Time 8.882 (0.000)	
2021-06-23 16:11:35,744 calculate similarity time: 0.07346653938293457
2021-06-23 16:11:36,167 Image to text: 78.0, 97.7, 99.4, 1.0, 2.7
2021-06-23 16:11:36,493 Text to image: 64.0, 91.4, 96.6, 1.0, 3.7
2021-06-23 16:11:36,493 Current rsum is 527.1
2021-06-23 16:11:39,986 runs/coco_butd_region_bert/log
2021-06-23 16:11:39,986 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 16:11:39,989 image encoder trainable parameters: 20490144
2021-06-23 16:11:40,000 txt encoder trainable parameters: 137319072
2021-06-23 16:12:42,148 Epoch: [6][49/4426]	Eit 26600  lr 0.0005  Le 23.2834 (20.6744)	Time 0.824 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:16:11,734 Epoch: [6][249/4426]	Eit 26800  lr 0.0005  Le 19.8860 (20.6223)	Time 0.914 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:19:41,131 Epoch: [6][449/4426]	Eit 27000  lr 0.0005  Le 23.7399 (20.5801)	Time 0.907 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:23:09,093 Epoch: [6][649/4426]	Eit 27200  lr 0.0005  Le 23.9794 (20.6832)	Time 1.553 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:26:37,204 Epoch: [6][849/4426]	Eit 27400  lr 0.0005  Le 22.6630 (20.7489)	Time 1.080 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:30:08,044 Epoch: [6][1049/4426]	Eit 27600  lr 0.0005  Le 21.5687 (20.7300)	Time 1.036 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:33:30,494 Epoch: [6][1249/4426]	Eit 27800  lr 0.0005  Le 18.7552 (20.7255)	Time 0.898 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:36:59,324 Epoch: [6][1449/4426]	Eit 28000  lr 0.0005  Le 20.3880 (20.7181)	Time 1.021 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:40:25,357 Epoch: [6][1649/4426]	Eit 28200  lr 0.0005  Le 24.6673 (20.7236)	Time 0.807 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:43:52,242 Epoch: [6][1849/4426]	Eit 28400  lr 0.0005  Le 19.7345 (20.7466)	Time 0.800 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:47:22,436 Epoch: [6][2049/4426]	Eit 28600  lr 0.0005  Le 21.2486 (20.7704)	Time 1.042 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:50:49,903 Epoch: [6][2249/4426]	Eit 28800  lr 0.0005  Le 19.7145 (20.7560)	Time 1.258 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:54:20,189 Epoch: [6][2449/4426]	Eit 29000  lr 0.0005  Le 23.3495 (20.7726)	Time 1.265 (0.000)	Data 0.002 (0.000)	
2021-06-23 16:57:46,876 Epoch: [6][2649/4426]	Eit 29200  lr 0.0005  Le 21.1556 (20.7807)	Time 0.898 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:01:14,165 Epoch: [6][2849/4426]	Eit 29400  lr 0.0005  Le 22.1905 (20.7931)	Time 1.044 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:04:38,684 Epoch: [6][3049/4426]	Eit 29600  lr 0.0005  Le 21.8854 (20.7960)	Time 1.049 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:08:07,802 Epoch: [6][3249/4426]	Eit 29800  lr 0.0005  Le 20.9273 (20.8001)	Time 0.970 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:11:37,933 Epoch: [6][3449/4426]	Eit 30000  lr 0.0005  Le 19.4380 (20.8096)	Time 0.898 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:15:08,165 Epoch: [6][3649/4426]	Eit 30200  lr 0.0005  Le 20.7863 (20.8187)	Time 1.001 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:18:38,917 Epoch: [6][3849/4426]	Eit 30400  lr 0.0005  Le 21.0609 (20.8182)	Time 1.284 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:22:08,808 Epoch: [6][4049/4426]	Eit 30600  lr 0.0005  Le 21.5740 (20.8087)	Time 1.023 (0.000)	Data 0.003 (0.000)	
2021-06-23 17:25:39,428 Epoch: [6][4249/4426]	Eit 30800  lr 0.0005  Le 17.9587 (20.8041)	Time 0.937 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:28:52,931 Test: [0/40]	Le 59.4109 (59.4108)	Time 8.916 (0.000)	
2021-06-23 17:29:08,992 calculate similarity time: 0.0775144100189209
2021-06-23 17:29:09,505 Image to text: 79.5, 95.9, 98.8, 1.0, 2.6
2021-06-23 17:29:09,823 Text to image: 64.9, 91.6, 96.7, 1.0, 3.7
2021-06-23 17:29:09,823 Current rsum is 527.4599999999999
2021-06-23 17:29:13,577 runs/coco_butd_region_bert/log
2021-06-23 17:29:13,578 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 17:29:13,583 image encoder trainable parameters: 20490144
2021-06-23 17:29:13,594 txt encoder trainable parameters: 137319072
2021-06-23 17:29:47,081 Epoch: [7][24/4426]	Eit 31000  lr 0.0005  Le 20.7845 (19.3409)	Time 0.909 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:33:12,921 Epoch: [7][224/4426]	Eit 31200  lr 0.0005  Le 21.6472 (19.6722)	Time 1.235 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:36:37,922 Epoch: [7][424/4426]	Eit 31400  lr 0.0005  Le 20.7962 (19.7817)	Time 0.910 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:40:09,255 Epoch: [7][624/4426]	Eit 31600  lr 0.0005  Le 17.5069 (19.8358)	Time 0.953 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:43:39,816 Epoch: [7][824/4426]	Eit 31800  lr 0.0005  Le 17.5174 (19.8547)	Time 1.123 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:47:06,520 Epoch: [7][1024/4426]	Eit 32000  lr 0.0005  Le 16.6523 (19.8759)	Time 1.228 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:50:36,932 Epoch: [7][1224/4426]	Eit 32200  lr 0.0005  Le 22.8130 (19.9040)	Time 0.856 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:54:05,743 Epoch: [7][1424/4426]	Eit 32400  lr 0.0005  Le 20.1112 (19.9058)	Time 1.032 (0.000)	Data 0.002 (0.000)	
2021-06-23 17:57:33,865 Epoch: [7][1624/4426]	Eit 32600  lr 0.0005  Le 17.8898 (19.8982)	Time 0.945 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:01:00,384 Epoch: [7][1824/4426]	Eit 32800  lr 0.0005  Le 15.8029 (19.9164)	Time 0.847 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:04:26,147 Epoch: [7][2024/4426]	Eit 33000  lr 0.0005  Le 18.6840 (19.9302)	Time 0.927 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:07:54,641 Epoch: [7][2224/4426]	Eit 33200  lr 0.0005  Le 20.0494 (19.9547)	Time 0.997 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:11:17,146 Epoch: [7][2424/4426]	Eit 33400  lr 0.0005  Le 21.0145 (19.9755)	Time 1.242 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:14:46,358 Epoch: [7][2624/4426]	Eit 33600  lr 0.0005  Le 24.2835 (19.9815)	Time 0.943 (0.000)	Data 0.003 (0.000)	
2021-06-23 18:18:12,670 Epoch: [7][2824/4426]	Eit 33800  lr 0.0005  Le 18.8557 (19.9636)	Time 0.906 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:21:41,216 Epoch: [7][3024/4426]	Eit 34000  lr 0.0005  Le 14.9187 (19.9789)	Time 0.994 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:25:09,982 Epoch: [7][3224/4426]	Eit 34200  lr 0.0005  Le 20.3100 (19.9834)	Time 0.838 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:28:37,611 Epoch: [7][3424/4426]	Eit 34400  lr 0.0005  Le 18.7003 (19.9886)	Time 1.279 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:32:08,700 Epoch: [7][3624/4426]	Eit 34600  lr 0.0005  Le 19.4749 (19.9768)	Time 1.285 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:35:39,242 Epoch: [7][3824/4426]	Eit 34800  lr 0.0005  Le 23.4405 (19.9878)	Time 0.892 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:39:09,020 Epoch: [7][4024/4426]	Eit 35000  lr 0.0005  Le 21.4293 (20.0011)	Time 1.372 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:42:31,825 Epoch: [7][4224/4426]	Eit 35200  lr 0.0005  Le 18.4705 (19.9929)	Time 1.085 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:46:01,216 Epoch: [7][4424/4426]	Eit 35400  lr 0.0005  Le 21.2141 (20.0069)	Time 0.883 (0.000)	Data 0.009 (0.000)	
2021-06-23 18:46:11,928 Test: [0/40]	Le 59.9487 (59.9486)	Time 9.372 (0.000)	
2021-06-23 18:46:27,756 calculate similarity time: 0.06976604461669922
2021-06-23 18:46:28,241 Image to text: 79.9, 97.4, 99.5, 1.0, 2.6
2021-06-23 18:46:28,615 Text to image: 65.9, 92.2, 96.5, 1.0, 3.6
2021-06-23 18:46:28,615 Current rsum is 531.4
2021-06-23 18:46:32,413 runs/coco_butd_region_bert/log
2021-06-23 18:46:32,413 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 18:46:32,416 image encoder trainable parameters: 20490144
2021-06-23 18:46:32,429 txt encoder trainable parameters: 137319072
2021-06-23 18:50:11,408 Epoch: [8][199/4426]	Eit 35600  lr 0.0005  Le 21.7302 (18.8139)	Time 1.174 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:53:41,372 Epoch: [8][399/4426]	Eit 35800  lr 0.0005  Le 19.1270 (19.0699)	Time 0.879 (0.000)	Data 0.002 (0.000)	
2021-06-23 18:57:07,922 Epoch: [8][599/4426]	Eit 36000  lr 0.0005  Le 19.8923 (19.1252)	Time 0.984 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:00:35,640 Epoch: [8][799/4426]	Eit 36200  lr 0.0005  Le 21.2236 (19.1171)	Time 0.902 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:04:07,813 Epoch: [8][999/4426]	Eit 36400  lr 0.0005  Le 20.2954 (19.1661)	Time 1.127 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:07:36,742 Epoch: [8][1199/4426]	Eit 36600  lr 0.0005  Le 18.5312 (19.1813)	Time 0.955 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:11:07,064 Epoch: [8][1399/4426]	Eit 36800  lr 0.0005  Le 21.1177 (19.2304)	Time 1.003 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:14:27,574 Epoch: [8][1599/4426]	Eit 37000  lr 0.0005  Le 20.7087 (19.2621)	Time 1.364 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:17:57,528 Epoch: [8][1799/4426]	Eit 37200  lr 0.0005  Le 16.7658 (19.3090)	Time 1.262 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:21:26,114 Epoch: [8][1999/4426]	Eit 37400  lr 0.0005  Le 18.9604 (19.3354)	Time 0.797 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:24:53,992 Epoch: [8][2199/4426]	Eit 37600  lr 0.0005  Le 22.3586 (19.3193)	Time 0.983 (0.000)	Data 0.003 (0.000)	
2021-06-23 19:28:25,354 Epoch: [8][2399/4426]	Eit 37800  lr 0.0005  Le 17.1803 (19.3325)	Time 1.172 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:31:57,685 Epoch: [8][2599/4426]	Eit 38000  lr 0.0005  Le 23.0723 (19.3570)	Time 1.250 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:35:24,814 Epoch: [8][2799/4426]	Eit 38200  lr 0.0005  Le 19.9214 (19.3655)	Time 0.852 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:38:52,392 Epoch: [8][2999/4426]	Eit 38400  lr 0.0005  Le 15.5215 (19.3713)	Time 0.911 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:42:18,246 Epoch: [8][3199/4426]	Eit 38600  lr 0.0005  Le 19.7073 (19.3845)	Time 1.259 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:45:52,762 Epoch: [8][3399/4426]	Eit 38800  lr 0.0005  Le 20.1196 (19.3988)	Time 0.953 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:49:13,915 Epoch: [8][3599/4426]	Eit 39000  lr 0.0005  Le 23.3750 (19.4012)	Time 1.095 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:52:45,263 Epoch: [8][3799/4426]	Eit 39200  lr 0.0005  Le 19.8970 (19.4040)	Time 0.899 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:56:15,493 Epoch: [8][3999/4426]	Eit 39400  lr 0.0005  Le 17.8800 (19.4173)	Time 1.001 (0.000)	Data 0.002 (0.000)	
2021-06-23 19:59:43,881 Epoch: [8][4199/4426]	Eit 39600  lr 0.0005  Le 18.8802 (19.4271)	Time 1.027 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:03:12,624 Epoch: [8][4399/4426]	Eit 39800  lr 0.0005  Le 20.8943 (19.4459)	Time 1.036 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:03:48,516 Test: [0/40]	Le 59.5573 (59.5572)	Time 8.822 (0.000)	
2021-06-23 20:04:04,629 calculate similarity time: 0.06723260879516602
2021-06-23 20:04:05,060 Image to text: 78.9, 97.4, 99.6, 1.0, 2.0
2021-06-23 20:04:05,387 Text to image: 64.8, 92.0, 96.8, 1.0, 3.8
2021-06-23 20:04:05,387 Current rsum is 529.52
2021-06-23 20:04:07,025 runs/coco_butd_region_bert/log
2021-06-23 20:04:07,025 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 20:04:07,026 image encoder trainable parameters: 20490144
2021-06-23 20:04:07,032 txt encoder trainable parameters: 137319072
2021-06-23 20:07:20,460 Epoch: [9][174/4426]	Eit 40000  lr 0.0005  Le 16.6317 (18.4132)	Time 1.241 (0.000)	Data 0.003 (0.000)	
2021-06-23 20:10:48,914 Epoch: [9][374/4426]	Eit 40200  lr 0.0005  Le 19.2766 (18.5210)	Time 1.287 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:14:13,923 Epoch: [9][574/4426]	Eit 40400  lr 0.0005  Le 16.6158 (18.5737)	Time 1.372 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:17:42,774 Epoch: [9][774/4426]	Eit 40600  lr 0.0005  Le 20.7202 (18.6398)	Time 0.986 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:21:04,347 Epoch: [9][974/4426]	Eit 40800  lr 0.0005  Le 16.1670 (18.5856)	Time 0.997 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:24:32,840 Epoch: [9][1174/4426]	Eit 41000  lr 0.0005  Le 19.0706 (18.5602)	Time 0.915 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:28:00,411 Epoch: [9][1374/4426]	Eit 41200  lr 0.0005  Le 15.9435 (18.5737)	Time 0.990 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:31:28,823 Epoch: [9][1574/4426]	Eit 41400  lr 0.0005  Le 14.9378 (18.5623)	Time 0.879 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:34:54,952 Epoch: [9][1774/4426]	Eit 41600  lr 0.0005  Le 20.0829 (18.6007)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:38:24,605 Epoch: [9][1974/4426]	Eit 41800  lr 0.0005  Le 17.0206 (18.6356)	Time 0.967 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:41:54,052 Epoch: [9][2174/4426]	Eit 42000  lr 0.0005  Le 20.4559 (18.6539)	Time 0.991 (0.000)	Data 0.003 (0.000)	
2021-06-23 20:45:22,768 Epoch: [9][2374/4426]	Eit 42200  lr 0.0005  Le 19.8914 (18.6636)	Time 1.189 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:48:53,013 Epoch: [9][2574/4426]	Eit 42400  lr 0.0005  Le 18.3331 (18.6832)	Time 1.400 (0.000)	Data 0.003 (0.000)	
2021-06-23 20:52:16,570 Epoch: [9][2774/4426]	Eit 42600  lr 0.0005  Le 17.6765 (18.6949)	Time 1.125 (0.000)	Data 0.005 (0.000)	
2021-06-23 20:55:44,489 Epoch: [9][2974/4426]	Eit 42800  lr 0.0005  Le 17.3902 (18.7031)	Time 1.507 (0.000)	Data 0.002 (0.000)	
2021-06-23 20:59:15,366 Epoch: [9][3174/4426]	Eit 43000  lr 0.0005  Le 16.9632 (18.7107)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:02:44,138 Epoch: [9][3374/4426]	Eit 43200  lr 0.0005  Le 19.1948 (18.7278)	Time 1.246 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:06:10,280 Epoch: [9][3574/4426]	Eit 43400  lr 0.0005  Le 24.0333 (18.7341)	Time 0.886 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:09:40,237 Epoch: [9][3774/4426]	Eit 43600  lr 0.0005  Le 16.5300 (18.7376)	Time 0.895 (0.000)	Data 0.003 (0.000)	
2021-06-23 21:13:09,434 Epoch: [9][3974/4426]	Eit 43800  lr 0.0005  Le 17.1849 (18.7568)	Time 1.044 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:16:41,368 Epoch: [9][4174/4426]	Eit 44000  lr 0.0005  Le 16.4695 (18.7625)	Time 1.237 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:20:12,192 Epoch: [9][4374/4426]	Eit 44200  lr 0.0005  Le 17.0837 (18.7759)	Time 1.067 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:21:16,044 Test: [0/40]	Le 59.3700 (59.3700)	Time 9.552 (0.000)	
2021-06-23 21:21:31,433 calculate similarity time: 0.06402087211608887
2021-06-23 21:21:31,856 Image to text: 81.3, 97.7, 99.6, 1.0, 4.1
2021-06-23 21:21:32,355 Text to image: 65.3, 92.3, 96.7, 1.0, 3.8
2021-06-23 21:21:32,355 Current rsum is 532.86
2021-06-23 21:21:36,583 runs/coco_butd_region_bert/log
2021-06-23 21:21:36,583 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 21:21:36,585 image encoder trainable parameters: 20490144
2021-06-23 21:21:36,594 txt encoder trainable parameters: 137319072
2021-06-23 21:24:21,788 Epoch: [10][149/4426]	Eit 44400  lr 0.0005  Le 15.6944 (17.6381)	Time 1.317 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:27:46,661 Epoch: [10][349/4426]	Eit 44600  lr 0.0005  Le 20.0993 (17.9160)	Time 1.090 (0.000)	Data 0.003 (0.000)	
2021-06-23 21:31:14,232 Epoch: [10][549/4426]	Eit 44800  lr 0.0005  Le 17.5362 (17.9808)	Time 1.322 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:34:44,331 Epoch: [10][749/4426]	Eit 45000  lr 0.0005  Le 17.1400 (18.0840)	Time 0.956 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:38:09,262 Epoch: [10][949/4426]	Eit 45200  lr 0.0005  Le 19.8632 (18.1019)	Time 0.861 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:41:38,655 Epoch: [10][1149/4426]	Eit 45400  lr 0.0005  Le 13.1952 (18.0603)	Time 0.958 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:45:07,924 Epoch: [10][1349/4426]	Eit 45600  lr 0.0005  Le 17.9675 (18.0563)	Time 1.072 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:48:36,295 Epoch: [10][1549/4426]	Eit 45800  lr 0.0005  Le 22.6095 (18.0770)	Time 0.853 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:52:06,520 Epoch: [10][1749/4426]	Eit 46000  lr 0.0005  Le 18.3026 (18.1306)	Time 1.122 (0.000)	Data 0.003 (0.000)	
2021-06-23 21:55:37,502 Epoch: [10][1949/4426]	Eit 46200  lr 0.0005  Le 19.7874 (18.1512)	Time 1.257 (0.000)	Data 0.002 (0.000)	
2021-06-23 21:58:36,206 Epoch: [10][2149/4426]	Eit 46400  lr 0.0005  Le 21.9371 (18.1526)	Time 0.536 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:00:53,783 Epoch: [10][2349/4426]	Eit 46600  lr 0.0005  Le 16.6862 (18.1398)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:02:55,613 Epoch: [10][2549/4426]	Eit 46800  lr 0.0005  Le 15.7765 (18.1797)	Time 0.571 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:04:58,027 Epoch: [10][2749/4426]	Eit 47000  lr 0.0005  Le 21.1514 (18.2004)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:07:00,315 Epoch: [10][2949/4426]	Eit 47200  lr 0.0005  Le 18.8749 (18.2146)	Time 0.629 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:09:02,228 Epoch: [10][3149/4426]	Eit 47400  lr 0.0005  Le 16.4247 (18.2242)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:11:03,249 Epoch: [10][3349/4426]	Eit 47600  lr 0.0005  Le 16.2402 (18.2255)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:13:05,858 Epoch: [10][3549/4426]	Eit 47800  lr 0.0005  Le 18.9613 (18.2342)	Time 0.858 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:15:06,847 Epoch: [10][3749/4426]	Eit 48000  lr 0.0005  Le 21.1747 (18.2469)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:17:09,497 Epoch: [10][3949/4426]	Eit 48200  lr 0.0005  Le 16.3811 (18.2374)	Time 0.650 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:19:10,650 Epoch: [10][4149/4426]	Eit 48400  lr 0.0005  Le 21.6640 (18.2455)	Time 0.632 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:21:12,356 Epoch: [10][4349/4426]	Eit 48600  lr 0.0005  Le 15.9056 (18.2494)	Time 0.781 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:22:07,140 Test: [0/40]	Le 60.0774 (60.0773)	Time 8.788 (0.000)	
2021-06-23 22:22:17,131 calculate similarity time: 0.04750823974609375
2021-06-23 22:22:17,633 Image to text: 80.9, 97.7, 99.3, 1.0, 2.8
2021-06-23 22:22:17,958 Text to image: 65.7, 92.2, 96.7, 1.0, 3.8
2021-06-23 22:22:17,958 Current rsum is 532.5
2021-06-23 22:22:19,456 runs/coco_butd_region_bert/log
2021-06-23 22:22:19,456 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 22:22:19,458 image encoder trainable parameters: 20490144
2021-06-23 22:22:19,463 txt encoder trainable parameters: 137319072
2021-06-23 22:23:44,842 Epoch: [11][124/4426]	Eit 48800  lr 0.0005  Le 16.0447 (17.3243)	Time 0.610 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:25:47,137 Epoch: [11][324/4426]	Eit 49000  lr 0.0005  Le 13.9790 (17.3678)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:27:50,627 Epoch: [11][524/4426]	Eit 49200  lr 0.0005  Le 18.3742 (17.4424)	Time 0.591 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:29:51,301 Epoch: [11][724/4426]	Eit 49400  lr 0.0005  Le 16.9798 (17.5144)	Time 0.570 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:31:52,236 Epoch: [11][924/4426]	Eit 49600  lr 0.0005  Le 15.7705 (17.5535)	Time 0.594 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:33:53,253 Epoch: [11][1124/4426]	Eit 49800  lr 0.0005  Le 15.3210 (17.5751)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:35:54,042 Epoch: [11][1324/4426]	Eit 50000  lr 0.0005  Le 18.2214 (17.6046)	Time 0.544 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:37:55,843 Epoch: [11][1524/4426]	Eit 50200  lr 0.0005  Le 14.2514 (17.6111)	Time 0.570 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:39:57,991 Epoch: [11][1724/4426]	Eit 50400  lr 0.0005  Le 21.5364 (17.6268)	Time 0.595 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:42:00,599 Epoch: [11][1924/4426]	Eit 50600  lr 0.0005  Le 18.5715 (17.6748)	Time 0.624 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:44:02,034 Epoch: [11][2124/4426]	Eit 50800  lr 0.0005  Le 20.8641 (17.6937)	Time 0.534 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:46:03,746 Epoch: [11][2324/4426]	Eit 51000  lr 0.0005  Le 18.8394 (17.7162)	Time 0.649 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:48:05,773 Epoch: [11][2524/4426]	Eit 51200  lr 0.0005  Le 18.9665 (17.7156)	Time 0.598 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:50:08,396 Epoch: [11][2724/4426]	Eit 51400  lr 0.0005  Le 17.8718 (17.7162)	Time 0.688 (0.000)	Data 0.003 (0.000)	
2021-06-23 22:52:10,463 Epoch: [11][2924/4426]	Eit 51600  lr 0.0005  Le 17.5545 (17.7274)	Time 0.569 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:54:11,869 Epoch: [11][3124/4426]	Eit 51800  lr 0.0005  Le 17.0946 (17.7173)	Time 0.642 (0.000)	Data 0.003 (0.000)	
2021-06-23 22:56:12,983 Epoch: [11][3324/4426]	Eit 52000  lr 0.0005  Le 23.3545 (17.7193)	Time 0.608 (0.000)	Data 0.002 (0.000)	
2021-06-23 22:58:13,700 Epoch: [11][3524/4426]	Eit 52200  lr 0.0005  Le 19.8951 (17.7258)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:00:14,149 Epoch: [11][3724/4426]	Eit 52400  lr 0.0005  Le 20.1618 (17.7273)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:02:15,650 Epoch: [11][3924/4426]	Eit 52600  lr 0.0005  Le 21.1553 (17.7456)	Time 0.596 (0.000)	Data 0.015 (0.000)	
2021-06-23 23:04:17,729 Epoch: [11][4124/4426]	Eit 52800  lr 0.0005  Le 21.4709 (17.7437)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:06:18,644 Epoch: [11][4324/4426]	Eit 53000  lr 0.0005  Le 19.5181 (17.7589)	Time 0.818 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:07:29,494 Test: [0/40]	Le 60.0522 (60.0521)	Time 8.536 (0.000)	
2021-06-23 23:07:39,510 calculate similarity time: 0.04697990417480469
2021-06-23 23:07:40,012 Image to text: 80.2, 96.8, 99.3, 1.0, 2.8
2021-06-23 23:07:40,340 Text to image: 65.4, 92.1, 96.8, 1.0, 3.8
2021-06-23 23:07:40,340 Current rsum is 530.6600000000001
2021-06-23 23:07:41,794 runs/coco_butd_region_bert/log
2021-06-23 23:07:41,794 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 23:07:41,795 image encoder trainable parameters: 20490144
2021-06-23 23:07:41,800 txt encoder trainable parameters: 137319072
2021-06-23 23:08:50,579 Epoch: [12][99/4426]	Eit 53200  lr 0.0005  Le 18.5875 (16.7797)	Time 0.569 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:10:54,693 Epoch: [12][299/4426]	Eit 53400  lr 0.0005  Le 20.4412 (16.8440)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:12:56,863 Epoch: [12][499/4426]	Eit 53600  lr 0.0005  Le 12.5851 (16.9153)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:14:58,662 Epoch: [12][699/4426]	Eit 53800  lr 0.0005  Le 16.8615 (16.8364)	Time 0.578 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:16:58,897 Epoch: [12][899/4426]	Eit 54000  lr 0.0005  Le 15.5675 (16.8285)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:19:01,224 Epoch: [12][1099/4426]	Eit 54200  lr 0.0005  Le 17.7082 (16.8348)	Time 0.605 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:21:01,880 Epoch: [12][1299/4426]	Eit 54400  lr 0.0005  Le 18.9142 (16.9136)	Time 0.557 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:23:03,722 Epoch: [12][1499/4426]	Eit 54600  lr 0.0005  Le 21.3908 (16.9504)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:25:06,117 Epoch: [12][1699/4426]	Eit 54800  lr 0.0005  Le 17.2369 (16.9989)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:27:06,627 Epoch: [12][1899/4426]	Eit 55000  lr 0.0005  Le 17.2868 (17.0358)	Time 0.622 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:29:08,090 Epoch: [12][2099/4426]	Eit 55200  lr 0.0005  Le 18.5516 (17.0315)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:31:08,734 Epoch: [12][2299/4426]	Eit 55400  lr 0.0005  Le 18.2815 (17.0512)	Time 0.835 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:33:11,835 Epoch: [12][2499/4426]	Eit 55600  lr 0.0005  Le 21.3801 (17.0431)	Time 0.597 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:35:13,909 Epoch: [12][2699/4426]	Eit 55800  lr 0.0005  Le 18.4661 (17.0623)	Time 0.735 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:37:15,988 Epoch: [12][2899/4426]	Eit 56000  lr 0.0005  Le 22.2172 (17.0810)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:39:18,854 Epoch: [12][3099/4426]	Eit 56200  lr 0.0005  Le 17.5271 (17.1025)	Time 0.540 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:41:21,944 Epoch: [12][3299/4426]	Eit 56400  lr 0.0005  Le 20.3920 (17.1087)	Time 0.668 (0.000)	Data 0.008 (0.000)	
2021-06-23 23:43:23,803 Epoch: [12][3499/4426]	Eit 56600  lr 0.0005  Le 16.8765 (17.1219)	Time 0.581 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:45:27,198 Epoch: [12][3699/4426]	Eit 56800  lr 0.0005  Le 13.9255 (17.1360)	Time 0.535 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:47:31,461 Epoch: [12][3899/4426]	Eit 57000  lr 0.0005  Le 17.1533 (17.1494)	Time 0.553 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:49:32,568 Epoch: [12][4099/4426]	Eit 57200  lr 0.0005  Le 16.9520 (17.1592)	Time 0.597 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:51:33,782 Epoch: [12][4299/4426]	Eit 57400  lr 0.0005  Le 20.1007 (17.1809)	Time 0.592 (0.000)	Data 0.009 (0.000)	
2021-06-23 23:53:00,590 Test: [0/40]	Le 59.5980 (59.5979)	Time 9.365 (0.000)	
2021-06-23 23:53:10,733 calculate similarity time: 0.03857564926147461
2021-06-23 23:53:11,240 Image to text: 77.8, 96.3, 98.8, 1.0, 2.4
2021-06-23 23:53:11,569 Text to image: 65.3, 92.0, 96.6, 1.0, 3.9
2021-06-23 23:53:11,569 Current rsum is 526.84
2021-06-23 23:53:12,902 runs/coco_butd_region_bert/log
2021-06-23 23:53:12,902 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-23 23:53:12,904 image encoder trainable parameters: 20490144
2021-06-23 23:53:12,909 txt encoder trainable parameters: 137319072
2021-06-23 23:54:06,808 Epoch: [13][74/4426]	Eit 57600  lr 0.0005  Le 19.1854 (16.2201)	Time 0.639 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:56:09,289 Epoch: [13][274/4426]	Eit 57800  lr 0.0005  Le 13.3139 (16.3153)	Time 0.647 (0.000)	Data 0.002 (0.000)	
2021-06-23 23:58:10,669 Epoch: [13][474/4426]	Eit 58000  lr 0.0005  Le 13.1504 (16.2389)	Time 0.597 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:00:12,853 Epoch: [13][674/4426]	Eit 58200  lr 0.0005  Le 13.4982 (16.2733)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:02:15,336 Epoch: [13][874/4426]	Eit 58400  lr 0.0005  Le 17.6382 (16.3391)	Time 0.540 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:04:15,729 Epoch: [13][1074/4426]	Eit 58600  lr 0.0005  Le 13.8167 (16.3408)	Time 0.730 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:06:18,555 Epoch: [13][1274/4426]	Eit 58800  lr 0.0005  Le 19.8339 (16.3865)	Time 0.581 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:08:20,709 Epoch: [13][1474/4426]	Eit 59000  lr 0.0005  Le 17.2094 (16.4012)	Time 0.610 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:10:22,297 Epoch: [13][1674/4426]	Eit 59200  lr 0.0005  Le 20.0674 (16.3986)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:12:24,154 Epoch: [13][1874/4426]	Eit 59400  lr 0.0005  Le 19.3305 (16.4367)	Time 0.572 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:14:25,991 Epoch: [13][2074/4426]	Eit 59600  lr 0.0005  Le 16.6160 (16.4466)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:16:27,061 Epoch: [13][2274/4426]	Eit 59800  lr 0.0005  Le 15.5653 (16.4403)	Time 0.619 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:18:30,207 Epoch: [13][2474/4426]	Eit 60000  lr 0.0005  Le 17.2596 (16.4523)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:20:31,685 Epoch: [13][2674/4426]	Eit 60200  lr 0.0005  Le 12.9840 (16.4705)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:22:33,474 Epoch: [13][2874/4426]	Eit 60400  lr 0.0005  Le 20.2064 (16.5093)	Time 0.642 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:24:35,413 Epoch: [13][3074/4426]	Eit 60600  lr 0.0005  Le 15.1278 (16.5240)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:26:37,299 Epoch: [13][3274/4426]	Eit 60800  lr 0.0005  Le 16.7174 (16.5072)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:28:38,953 Epoch: [13][3474/4426]	Eit 61000  lr 0.0005  Le 13.8062 (16.5174)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:30:41,039 Epoch: [13][3674/4426]	Eit 61200  lr 0.0005  Le 17.2276 (16.5460)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:32:44,312 Epoch: [13][3874/4426]	Eit 61400  lr 0.0005  Le 18.6198 (16.5498)	Time 0.553 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:34:46,641 Epoch: [13][4074/4426]	Eit 61600  lr 0.0005  Le 14.9027 (16.5453)	Time 0.748 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:36:49,094 Epoch: [13][4274/4426]	Eit 61800  lr 0.0005  Le 18.9888 (16.5341)	Time 0.596 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:38:31,728 Test: [0/40]	Le 59.6728 (59.6728)	Time 9.034 (0.000)	
2021-06-24 00:38:41,782 calculate similarity time: 0.0409700870513916
2021-06-24 00:38:42,284 Image to text: 79.4, 97.7, 99.6, 1.0, 2.1
2021-06-24 00:38:42,606 Text to image: 65.8, 92.3, 96.8, 1.0, 3.7
2021-06-24 00:38:42,606 Current rsum is 531.6400000000001
2021-06-24 00:38:43,851 runs/coco_butd_region_bert/log
2021-06-24 00:38:43,851 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 00:38:43,852 image encoder trainable parameters: 20490144
2021-06-24 00:38:43,858 txt encoder trainable parameters: 137319072
2021-06-24 00:39:22,383 Epoch: [14][49/4426]	Eit 62000  lr 0.0005  Le 15.4546 (15.2983)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:41:23,598 Epoch: [14][249/4426]	Eit 62200  lr 0.0005  Le 16.4576 (15.5971)	Time 0.642 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:43:25,633 Epoch: [14][449/4426]	Eit 62400  lr 0.0005  Le 15.1050 (15.7118)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:45:27,517 Epoch: [14][649/4426]	Eit 62600  lr 0.0005  Le 12.0328 (15.7098)	Time 0.687 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:47:28,558 Epoch: [14][849/4426]	Eit 62800  lr 0.0005  Le 17.9620 (15.7722)	Time 0.621 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:49:29,854 Epoch: [14][1049/4426]	Eit 63000  lr 0.0005  Le 17.0816 (15.8594)	Time 0.569 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:51:30,450 Epoch: [14][1249/4426]	Eit 63200  lr 0.0005  Le 18.8763 (15.8777)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:53:33,420 Epoch: [14][1449/4426]	Eit 63400  lr 0.0005  Le 13.7782 (15.8956)	Time 0.571 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:55:35,286 Epoch: [14][1649/4426]	Eit 63600  lr 0.0005  Le 16.4111 (15.8895)	Time 0.571 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:57:37,036 Epoch: [14][1849/4426]	Eit 63800  lr 0.0005  Le 12.6988 (15.8978)	Time 0.688 (0.000)	Data 0.002 (0.000)	
2021-06-24 00:59:39,256 Epoch: [14][2049/4426]	Eit 64000  lr 0.0005  Le 17.4815 (15.9372)	Time 0.556 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:01:41,266 Epoch: [14][2249/4426]	Eit 64200  lr 0.0005  Le 16.2189 (15.9528)	Time 0.673 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:03:43,474 Epoch: [14][2449/4426]	Eit 64400  lr 0.0005  Le 15.2560 (15.9429)	Time 0.606 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:05:44,771 Epoch: [14][2649/4426]	Eit 64600  lr 0.0005  Le 17.5276 (15.9520)	Time 0.542 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:07:46,604 Epoch: [14][2849/4426]	Eit 64800  lr 0.0005  Le 20.0782 (15.9567)	Time 0.570 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:09:47,550 Epoch: [14][3049/4426]	Eit 65000  lr 0.0005  Le 15.9987 (15.9791)	Time 0.671 (0.000)	Data 0.011 (0.000)	
2021-06-24 01:11:49,978 Epoch: [14][3249/4426]	Eit 65200  lr 0.0005  Le 17.6317 (15.9903)	Time 0.627 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:13:51,920 Epoch: [14][3449/4426]	Eit 65400  lr 0.0005  Le 12.6292 (15.9822)	Time 0.633 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:15:54,915 Epoch: [14][3649/4426]	Eit 65600  lr 0.0005  Le 17.5759 (15.9854)	Time 0.618 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:17:56,885 Epoch: [14][3849/4426]	Eit 65800  lr 0.0005  Le 9.8401 (15.9997)	Time 0.618 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:19:58,658 Epoch: [14][4049/4426]	Eit 66000  lr 0.0005  Le 17.3592 (16.0035)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:22:00,228 Epoch: [14][4249/4426]	Eit 66200  lr 0.0005  Le 14.8432 (16.0027)	Time 0.566 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:23:57,383 Test: [0/40]	Le 59.1015 (59.1014)	Time 9.071 (0.000)	
2021-06-24 01:24:07,556 calculate similarity time: 0.048981666564941406
2021-06-24 01:24:08,061 Image to text: 79.8, 97.1, 99.3, 1.0, 2.3
2021-06-24 01:24:08,393 Text to image: 66.4, 92.1, 96.7, 1.0, 4.1
2021-06-24 01:24:08,393 Current rsum is 531.4399999999999
2021-06-24 01:24:10,070 runs/coco_butd_region_bert/log
2021-06-24 01:24:10,070 runs/coco_butd_region_bert
2021-06-24 01:24:10,070 Current epoch num is 15, decrease all lr by 10
2021-06-24 01:24:10,070 new lr 5e-05
2021-06-24 01:24:10,070 new lr 5e-06
2021-06-24 01:24:10,070 new lr 5e-05
Use VSE++ objective.
2021-06-24 01:24:10,071 image encoder trainable parameters: 20490144
2021-06-24 01:24:10,077 txt encoder trainable parameters: 137319072
2021-06-24 01:24:34,184 Epoch: [15][24/4426]	Eit 66400  lr 5e-05  Le 12.1613 (15.1554)	Time 0.596 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:26:35,341 Epoch: [15][224/4426]	Eit 66600  lr 5e-05  Le 16.3473 (14.9412)	Time 0.555 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:28:37,300 Epoch: [15][424/4426]	Eit 66800  lr 5e-05  Le 21.4187 (14.8877)	Time 0.573 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:30:39,407 Epoch: [15][624/4426]	Eit 67000  lr 5e-05  Le 17.7827 (14.8415)	Time 0.589 (0.000)	Data 0.003 (0.000)	
2021-06-24 01:32:42,128 Epoch: [15][824/4426]	Eit 67200  lr 5e-05  Le 13.5398 (14.6867)	Time 0.733 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:34:43,958 Epoch: [15][1024/4426]	Eit 67400  lr 5e-05  Le 15.2268 (14.6777)	Time 0.680 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:36:45,954 Epoch: [15][1224/4426]	Eit 67600  lr 5e-05  Le 10.4679 (14.6852)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:38:47,507 Epoch: [15][1424/4426]	Eit 67800  lr 5e-05  Le 20.2543 (14.6513)	Time 0.602 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:40:49,067 Epoch: [15][1624/4426]	Eit 68000  lr 5e-05  Le 11.8627 (14.6266)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:42:50,102 Epoch: [15][1824/4426]	Eit 68200  lr 5e-05  Le 10.6184 (14.5656)	Time 0.534 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:44:52,089 Epoch: [15][2024/4426]	Eit 68400  lr 5e-05  Le 12.1133 (14.5134)	Time 0.631 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:46:54,904 Epoch: [15][2224/4426]	Eit 68600  lr 5e-05  Le 12.9927 (14.4887)	Time 0.577 (0.000)	Data 0.003 (0.000)	
2021-06-24 01:48:55,805 Epoch: [15][2424/4426]	Eit 68800  lr 5e-05  Le 17.4772 (14.4861)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:50:59,022 Epoch: [15][2624/4426]	Eit 69000  lr 5e-05  Le 14.5342 (14.4648)	Time 0.690 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:53:00,758 Epoch: [15][2824/4426]	Eit 69200  lr 5e-05  Le 13.1863 (14.4479)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:55:04,056 Epoch: [15][3024/4426]	Eit 69400  lr 5e-05  Le 9.1096 (14.4170)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:57:04,330 Epoch: [15][3224/4426]	Eit 69600  lr 5e-05  Le 12.7649 (14.3838)	Time 0.582 (0.000)	Data 0.002 (0.000)	
2021-06-24 01:59:05,950 Epoch: [15][3424/4426]	Eit 69800  lr 5e-05  Le 16.1041 (14.3618)	Time 0.578 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:01:07,887 Epoch: [15][3624/4426]	Eit 70000  lr 5e-05  Le 12.8592 (14.3379)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:03:10,265 Epoch: [15][3824/4426]	Eit 70200  lr 5e-05  Le 12.6286 (14.3102)	Time 0.565 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:05:12,197 Epoch: [15][4024/4426]	Eit 70400  lr 5e-05  Le 9.4121 (14.2791)	Time 0.644 (0.000)	Data 0.007 (0.000)	
2021-06-24 02:07:14,644 Epoch: [15][4224/4426]	Eit 70600  lr 5e-05  Le 9.5914 (14.2613)	Time 0.648 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:09:15,485 Epoch: [15][4424/4426]	Eit 70800  lr 5e-05  Le 14.2349 (14.2424)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:09:25,698 Test: [0/40]	Le 60.0340 (60.0339)	Time 8.854 (0.000)	
2021-06-24 02:09:35,795 calculate similarity time: 0.04732465744018555
2021-06-24 02:09:36,300 Image to text: 81.0, 97.4, 99.3, 1.0, 2.1
2021-06-24 02:09:36,621 Text to image: 67.3, 92.5, 96.9, 1.0, 3.8
2021-06-24 02:09:36,621 Current rsum is 534.48
2021-06-24 02:09:40,268 runs/coco_butd_region_bert/log
2021-06-24 02:09:40,269 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 02:09:40,273 image encoder trainable parameters: 20490144
2021-06-24 02:09:40,286 txt encoder trainable parameters: 137319072
2021-06-24 02:11:50,883 Epoch: [16][199/4426]	Eit 71000  lr 5e-05  Le 12.6644 (13.3269)	Time 0.601 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:13:53,094 Epoch: [16][399/4426]	Eit 71200  lr 5e-05  Le 14.2921 (13.4915)	Time 0.592 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:15:55,376 Epoch: [16][599/4426]	Eit 71400  lr 5e-05  Le 14.3780 (13.5497)	Time 0.628 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:17:56,566 Epoch: [16][799/4426]	Eit 71600  lr 5e-05  Le 13.3367 (13.6327)	Time 0.609 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:19:58,826 Epoch: [16][999/4426]	Eit 71800  lr 5e-05  Le 13.7711 (13.6799)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:22:00,525 Epoch: [16][1199/4426]	Eit 72000  lr 5e-05  Le 16.4263 (13.6111)	Time 0.623 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:24:03,758 Epoch: [16][1399/4426]	Eit 72200  lr 5e-05  Le 11.7565 (13.6406)	Time 0.582 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:26:05,834 Epoch: [16][1599/4426]	Eit 72400  lr 5e-05  Le 17.2939 (13.6109)	Time 0.613 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:28:06,482 Epoch: [16][1799/4426]	Eit 72600  lr 5e-05  Le 9.8153 (13.5908)	Time 0.744 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:30:09,184 Epoch: [16][1999/4426]	Eit 72800  lr 5e-05  Le 10.7674 (13.5939)	Time 0.654 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:32:11,154 Epoch: [16][2199/4426]	Eit 73000  lr 5e-05  Le 15.0374 (13.5861)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:34:12,982 Epoch: [16][2399/4426]	Eit 73200  lr 5e-05  Le 17.9320 (13.5772)	Time 0.591 (0.000)	Data 0.009 (0.000)	
2021-06-24 02:36:13,497 Epoch: [16][2599/4426]	Eit 73400  lr 5e-05  Le 13.8453 (13.5858)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:38:16,040 Epoch: [16][2799/4426]	Eit 73600  lr 5e-05  Le 9.4037 (13.5729)	Time 0.584 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:40:18,865 Epoch: [16][2999/4426]	Eit 73800  lr 5e-05  Le 9.1829 (13.5806)	Time 0.543 (0.000)	Data 0.009 (0.000)	
2021-06-24 02:42:21,835 Epoch: [16][3199/4426]	Eit 74000  lr 5e-05  Le 15.5671 (13.5922)	Time 0.778 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:44:23,399 Epoch: [16][3399/4426]	Eit 74200  lr 5e-05  Le 14.0337 (13.5702)	Time 0.566 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:46:25,624 Epoch: [16][3599/4426]	Eit 74400  lr 5e-05  Le 14.4978 (13.5708)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:48:28,284 Epoch: [16][3799/4426]	Eit 74600  lr 5e-05  Le 11.8313 (13.5716)	Time 0.537 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:50:31,099 Epoch: [16][3999/4426]	Eit 74800  lr 5e-05  Le 14.3576 (13.5619)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:52:32,359 Epoch: [16][4199/4426]	Eit 75000  lr 5e-05  Le 11.9349 (13.5458)	Time 0.649 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:54:36,099 Epoch: [16][4399/4426]	Eit 75200  lr 5e-05  Le 11.6389 (13.5413)	Time 0.688 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:55:01,612 Test: [0/40]	Le 59.9917 (59.9917)	Time 8.768 (0.000)	
2021-06-24 02:55:11,913 calculate similarity time: 0.047257184982299805
2021-06-24 02:55:12,416 Image to text: 81.0, 97.7, 99.4, 1.0, 1.9
2021-06-24 02:55:12,746 Text to image: 67.3, 92.7, 97.0, 1.0, 3.7
2021-06-24 02:55:12,746 Current rsum is 535.0600000000001
2021-06-24 02:55:16,391 runs/coco_butd_region_bert/log
2021-06-24 02:55:16,391 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 02:55:16,395 image encoder trainable parameters: 20490144
2021-06-24 02:55:16,409 txt encoder trainable parameters: 137319072
2021-06-24 02:57:12,660 Epoch: [17][174/4426]	Eit 75400  lr 5e-05  Le 14.6220 (13.2566)	Time 0.755 (0.000)	Data 0.002 (0.000)	
2021-06-24 02:59:14,779 Epoch: [17][374/4426]	Eit 75600  lr 5e-05  Le 10.7669 (13.3134)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:01:17,196 Epoch: [17][574/4426]	Eit 75800  lr 5e-05  Le 11.0151 (13.3456)	Time 0.541 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:03:19,471 Epoch: [17][774/4426]	Eit 76000  lr 5e-05  Le 14.5055 (13.3477)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:05:23,133 Epoch: [17][974/4426]	Eit 76200  lr 5e-05  Le 12.0334 (13.3136)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:07:23,398 Epoch: [17][1174/4426]	Eit 76400  lr 5e-05  Le 18.8809 (13.3546)	Time 0.569 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:09:25,377 Epoch: [17][1374/4426]	Eit 76600  lr 5e-05  Le 17.3171 (13.3541)	Time 0.605 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:11:26,735 Epoch: [17][1574/4426]	Eit 76800  lr 5e-05  Le 15.3375 (13.3505)	Time 0.657 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:13:28,930 Epoch: [17][1774/4426]	Eit 77000  lr 5e-05  Le 15.6111 (13.3766)	Time 0.628 (0.000)	Data 0.003 (0.000)	
2021-06-24 03:15:31,452 Epoch: [17][1974/4426]	Eit 77200  lr 5e-05  Le 10.0526 (13.3465)	Time 0.660 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:17:33,302 Epoch: [17][2174/4426]	Eit 77400  lr 5e-05  Le 10.9762 (13.3540)	Time 0.623 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:19:35,393 Epoch: [17][2374/4426]	Eit 77600  lr 5e-05  Le 13.2814 (13.3714)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:21:37,977 Epoch: [17][2574/4426]	Eit 77800  lr 5e-05  Le 14.0760 (13.3999)	Time 0.672 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:23:38,818 Epoch: [17][2774/4426]	Eit 78000  lr 5e-05  Le 13.0655 (13.3924)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:25:40,353 Epoch: [17][2974/4426]	Eit 78200  lr 5e-05  Le 14.4281 (13.3896)	Time 0.601 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:27:42,938 Epoch: [17][3174/4426]	Eit 78400  lr 5e-05  Le 12.2791 (13.4034)	Time 0.625 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:29:45,613 Epoch: [17][3374/4426]	Eit 78600  lr 5e-05  Le 16.2470 (13.3983)	Time 0.535 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:31:47,794 Epoch: [17][3574/4426]	Eit 78800  lr 5e-05  Le 15.7649 (13.3868)	Time 0.629 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:33:51,419 Epoch: [17][3774/4426]	Eit 79000  lr 5e-05  Le 13.2399 (13.3713)	Time 0.620 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:35:52,928 Epoch: [17][3974/4426]	Eit 79200  lr 5e-05  Le 8.5521 (13.3800)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:37:55,642 Epoch: [17][4174/4426]	Eit 79400  lr 5e-05  Le 11.0405 (13.3554)	Time 0.576 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:39:57,373 Epoch: [17][4374/4426]	Eit 79600  lr 5e-05  Le 11.5626 (13.3430)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:40:38,175 Test: [0/40]	Le 59.9219 (59.9218)	Time 8.599 (0.000)	
2021-06-24 03:40:48,231 calculate similarity time: 0.04949378967285156
2021-06-24 03:40:48,735 Image to text: 81.8, 97.4, 99.2, 1.0, 2.0
2021-06-24 03:40:49,048 Text to image: 67.3, 92.9, 96.9, 1.0, 3.6
2021-06-24 03:40:49,048 Current rsum is 535.52
2021-06-24 03:40:52,657 runs/coco_butd_region_bert/log
2021-06-24 03:40:52,657 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 03:40:52,660 image encoder trainable parameters: 20490144
2021-06-24 03:40:52,671 txt encoder trainable parameters: 137319072
2021-06-24 03:42:33,633 Epoch: [18][149/4426]	Eit 79800  lr 5e-05  Le 16.4226 (13.0974)	Time 0.557 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:44:34,683 Epoch: [18][349/4426]	Eit 80000  lr 5e-05  Le 15.8479 (13.1148)	Time 0.547 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:46:38,061 Epoch: [18][549/4426]	Eit 80200  lr 5e-05  Le 13.8021 (13.0384)	Time 0.577 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:48:39,196 Epoch: [18][749/4426]	Eit 80400  lr 5e-05  Le 12.4505 (13.1125)	Time 0.541 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:50:40,926 Epoch: [18][949/4426]	Eit 80600  lr 5e-05  Le 11.5445 (13.0504)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:52:43,503 Epoch: [18][1149/4426]	Eit 80800  lr 5e-05  Le 12.5523 (13.0499)	Time 0.568 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:54:46,459 Epoch: [18][1349/4426]	Eit 81000  lr 5e-05  Le 17.2459 (13.0551)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:56:47,452 Epoch: [18][1549/4426]	Eit 81200  lr 5e-05  Le 12.4322 (13.0380)	Time 0.632 (0.000)	Data 0.002 (0.000)	
2021-06-24 03:58:49,094 Epoch: [18][1749/4426]	Eit 81400  lr 5e-05  Le 12.8443 (13.0180)	Time 0.587 (0.000)	Data 0.004 (0.000)	
2021-06-24 04:00:52,253 Epoch: [18][1949/4426]	Eit 81600  lr 5e-05  Le 16.4283 (13.0533)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:02:53,997 Epoch: [18][2149/4426]	Eit 81800  lr 5e-05  Le 11.7886 (13.0372)	Time 0.611 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:04:56,010 Epoch: [18][2349/4426]	Eit 82000  lr 5e-05  Le 17.0383 (13.0379)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:06:58,697 Epoch: [18][2549/4426]	Eit 82200  lr 5e-05  Le 10.8759 (13.0568)	Time 0.576 (0.000)	Data 0.004 (0.000)	
2021-06-24 04:09:00,143 Epoch: [18][2749/4426]	Eit 82400  lr 5e-05  Le 15.2247 (13.0522)	Time 0.623 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:11:02,016 Epoch: [18][2949/4426]	Eit 82600  lr 5e-05  Le 10.1357 (13.0666)	Time 0.631 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:13:04,041 Epoch: [18][3149/4426]	Eit 82800  lr 5e-05  Le 12.7577 (13.0618)	Time 0.530 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:15:04,980 Epoch: [18][3349/4426]	Eit 83000  lr 5e-05  Le 11.1426 (13.0650)	Time 0.591 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:17:07,098 Epoch: [18][3549/4426]	Eit 83200  lr 5e-05  Le 10.6531 (13.0657)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:19:10,088 Epoch: [18][3749/4426]	Eit 83400  lr 5e-05  Le 9.9561 (13.0599)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:21:11,795 Epoch: [18][3949/4426]	Eit 83600  lr 5e-05  Le 10.4741 (13.0610)	Time 0.588 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:23:14,315 Epoch: [18][4149/4426]	Eit 83800  lr 5e-05  Le 17.0876 (13.0633)	Time 0.545 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:25:15,001 Epoch: [18][4349/4426]	Eit 84000  lr 5e-05  Le 12.7979 (13.0583)	Time 0.616 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:26:10,882 Test: [0/40]	Le 59.7855 (59.7854)	Time 8.849 (0.000)	
2021-06-24 04:26:20,945 calculate similarity time: 0.04780411720275879
2021-06-24 04:26:21,450 Image to text: 81.7, 97.8, 99.5, 1.0, 2.0
2021-06-24 04:26:21,782 Text to image: 67.5, 92.8, 97.1, 1.0, 3.7
2021-06-24 04:26:21,782 Current rsum is 536.3199999999999
2021-06-24 04:26:25,339 runs/coco_butd_region_bert/log
2021-06-24 04:26:25,339 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 04:26:25,343 image encoder trainable parameters: 20490144
2021-06-24 04:26:25,354 txt encoder trainable parameters: 137319072
2021-06-24 04:27:50,295 Epoch: [19][124/4426]	Eit 84200  lr 5e-05  Le 14.2980 (12.9208)	Time 0.678 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:29:53,255 Epoch: [19][324/4426]	Eit 84400  lr 5e-05  Le 12.8116 (12.9937)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:31:55,502 Epoch: [19][524/4426]	Eit 84600  lr 5e-05  Le 16.1667 (13.0140)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:33:57,374 Epoch: [19][724/4426]	Eit 84800  lr 5e-05  Le 13.4995 (12.9825)	Time 0.625 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:35:59,739 Epoch: [19][924/4426]	Eit 85000  lr 5e-05  Le 6.9366 (12.9694)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:38:01,446 Epoch: [19][1124/4426]	Eit 85200  lr 5e-05  Le 13.6438 (13.0047)	Time 0.598 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:40:03,465 Epoch: [19][1324/4426]	Eit 85400  lr 5e-05  Le 13.6908 (12.9799)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:42:05,376 Epoch: [19][1524/4426]	Eit 85600  lr 5e-05  Le 11.2219 (12.9847)	Time 0.543 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:44:07,811 Epoch: [19][1724/4426]	Eit 85800  lr 5e-05  Le 13.6841 (13.0031)	Time 0.564 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:46:10,066 Epoch: [19][1924/4426]	Eit 86000  lr 5e-05  Le 11.3659 (12.9572)	Time 0.609 (0.000)	Data 0.003 (0.000)	
2021-06-24 04:48:12,501 Epoch: [19][2124/4426]	Eit 86200  lr 5e-05  Le 12.8356 (12.9757)	Time 0.631 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:50:13,092 Epoch: [19][2324/4426]	Eit 86400  lr 5e-05  Le 11.8794 (12.9686)	Time 0.574 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:52:15,376 Epoch: [19][2524/4426]	Eit 86600  lr 5e-05  Le 13.2360 (12.9621)	Time 0.648 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:54:17,307 Epoch: [19][2724/4426]	Eit 86800  lr 5e-05  Le 10.4264 (12.9638)	Time 0.731 (0.000)	Data 0.002 (0.000)	
2021-06-24 04:56:18,828 Epoch: [19][2924/4426]	Eit 87000  lr 5e-05  Le 6.8467 (12.9628)	Time 0.603 (0.000)	Data 0.003 (0.000)	
2021-06-24 04:58:21,497 Epoch: [19][3124/4426]	Eit 87200  lr 5e-05  Le 8.7896 (12.9706)	Time 0.582 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:00:24,512 Epoch: [19][3324/4426]	Eit 87400  lr 5e-05  Le 11.0780 (12.9624)	Time 0.639 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:02:26,705 Epoch: [19][3524/4426]	Eit 87600  lr 5e-05  Le 17.7846 (12.9825)	Time 0.577 (0.000)	Data 0.003 (0.000)	
2021-06-24 05:04:28,207 Epoch: [19][3724/4426]	Eit 87800  lr 5e-05  Le 15.6564 (12.9727)	Time 0.618 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:06:30,788 Epoch: [19][3924/4426]	Eit 88000  lr 5e-05  Le 11.5693 (12.9823)	Time 0.584 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:08:33,318 Epoch: [19][4124/4426]	Eit 88200  lr 5e-05  Le 11.9427 (12.9762)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:10:35,120 Epoch: [19][4324/4426]	Eit 88400  lr 5e-05  Le 13.4925 (12.9715)	Time 0.778 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:11:46,696 Test: [0/40]	Le 59.7403 (59.7402)	Time 8.970 (0.000)	
2021-06-24 05:11:56,792 calculate similarity time: 0.049294471740722656
2021-06-24 05:11:57,290 Image to text: 81.9, 97.8, 99.3, 1.0, 2.1
2021-06-24 05:11:57,602 Text to image: 67.2, 92.7, 97.0, 1.0, 3.7
2021-06-24 05:11:57,602 Current rsum is 535.84
2021-06-24 05:11:59,043 runs/coco_butd_region_bert/log
2021-06-24 05:11:59,043 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 05:11:59,047 image encoder trainable parameters: 20490144
2021-06-24 05:11:59,058 txt encoder trainable parameters: 137319072
2021-06-24 05:13:09,750 Epoch: [20][99/4426]	Eit 88600  lr 5e-05  Le 10.2820 (12.6765)	Time 0.610 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:15:11,185 Epoch: [20][299/4426]	Eit 88800  lr 5e-05  Le 15.0679 (12.6130)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:17:13,543 Epoch: [20][499/4426]	Eit 89000  lr 5e-05  Le 13.0784 (12.6000)	Time 0.652 (0.000)	Data 0.009 (0.000)	
2021-06-24 05:19:14,972 Epoch: [20][699/4426]	Eit 89200  lr 5e-05  Le 16.1749 (12.6151)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:21:17,485 Epoch: [20][899/4426]	Eit 89400  lr 5e-05  Le 14.6067 (12.6517)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:23:20,417 Epoch: [20][1099/4426]	Eit 89600  lr 5e-05  Le 9.4694 (12.6762)	Time 0.618 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:25:22,002 Epoch: [20][1299/4426]	Eit 89800  lr 5e-05  Le 13.6860 (12.6981)	Time 0.753 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:27:24,429 Epoch: [20][1499/4426]	Eit 90000  lr 5e-05  Le 14.0785 (12.6970)	Time 0.632 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:29:25,412 Epoch: [20][1699/4426]	Eit 90200  lr 5e-05  Le 11.8697 (12.6979)	Time 0.624 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:31:28,464 Epoch: [20][1899/4426]	Eit 90400  lr 5e-05  Le 8.5211 (12.6836)	Time 0.606 (0.000)	Data 0.009 (0.000)	
2021-06-24 05:33:31,620 Epoch: [20][2099/4426]	Eit 90600  lr 5e-05  Le 13.8252 (12.6906)	Time 0.637 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:35:33,661 Epoch: [20][2299/4426]	Eit 90800  lr 5e-05  Le 10.9124 (12.7038)	Time 0.591 (0.000)	Data 0.004 (0.000)	
2021-06-24 05:37:36,103 Epoch: [20][2499/4426]	Eit 91000  lr 5e-05  Le 10.1899 (12.7210)	Time 0.589 (0.000)	Data 0.003 (0.000)	
2021-06-24 05:39:38,129 Epoch: [20][2699/4426]	Eit 91200  lr 5e-05  Le 12.3096 (12.7289)	Time 0.613 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:41:42,161 Epoch: [20][2899/4426]	Eit 91400  lr 5e-05  Le 12.2672 (12.7321)	Time 0.601 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:43:43,091 Epoch: [20][3099/4426]	Eit 91600  lr 5e-05  Le 9.4274 (12.7333)	Time 0.649 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:45:44,610 Epoch: [20][3299/4426]	Eit 91800  lr 5e-05  Le 10.6482 (12.7285)	Time 0.623 (0.000)	Data 0.009 (0.000)	
2021-06-24 05:47:49,284 Epoch: [20][3499/4426]	Eit 92000  lr 5e-05  Le 12.6024 (12.7173)	Time 0.783 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:49:52,367 Epoch: [20][3699/4426]	Eit 92200  lr 5e-05  Le 11.9799 (12.7036)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:51:54,233 Epoch: [20][3899/4426]	Eit 92400  lr 5e-05  Le 14.3496 (12.6880)	Time 0.612 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:53:56,172 Epoch: [20][4099/4426]	Eit 92600  lr 5e-05  Le 13.7400 (12.6858)	Time 0.592 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:55:57,365 Epoch: [20][4299/4426]	Eit 92800  lr 5e-05  Le 14.7541 (12.6917)	Time 0.572 (0.000)	Data 0.002 (0.000)	
2021-06-24 05:57:24,084 Test: [0/40]	Le 59.4779 (59.4779)	Time 9.037 (0.000)	
2021-06-24 05:57:34,126 calculate similarity time: 0.04759693145751953
2021-06-24 05:57:34,628 Image to text: 81.5, 97.6, 99.5, 1.0, 2.0
2021-06-24 05:57:34,957 Text to image: 67.2, 92.9, 97.0, 1.0, 3.7
2021-06-24 05:57:34,957 Current rsum is 535.76
2021-06-24 05:57:36,422 runs/coco_butd_region_bert/log
2021-06-24 05:57:36,422 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 05:57:36,424 image encoder trainable parameters: 20490144
2021-06-24 05:57:36,429 txt encoder trainable parameters: 137319072
2021-06-24 05:58:29,985 Epoch: [21][74/4426]	Eit 93000  lr 5e-05  Le 12.6057 (12.5013)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:00:33,188 Epoch: [21][274/4426]	Eit 93200  lr 5e-05  Le 13.0294 (12.5769)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:02:36,580 Epoch: [21][474/4426]	Eit 93400  lr 5e-05  Le 10.7436 (12.4840)	Time 0.588 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:04:37,247 Epoch: [21][674/4426]	Eit 93600  lr 5e-05  Le 11.3815 (12.4613)	Time 0.605 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:06:39,758 Epoch: [21][874/4426]	Eit 93800  lr 5e-05  Le 12.6158 (12.5309)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:08:41,498 Epoch: [21][1074/4426]	Eit 94000  lr 5e-05  Le 13.1449 (12.4708)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:10:42,962 Epoch: [21][1274/4426]	Eit 94200  lr 5e-05  Le 16.0397 (12.4296)	Time 0.544 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:12:45,106 Epoch: [21][1474/4426]	Eit 94400  lr 5e-05  Le 9.5870 (12.4228)	Time 0.595 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:14:46,741 Epoch: [21][1674/4426]	Eit 94600  lr 5e-05  Le 14.5609 (12.4489)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:16:49,656 Epoch: [21][1874/4426]	Eit 94800  lr 5e-05  Le 11.5402 (12.4713)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:18:52,662 Epoch: [21][2074/4426]	Eit 95000  lr 5e-05  Le 16.5997 (12.5066)	Time 0.608 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:20:56,597 Epoch: [21][2274/4426]	Eit 95200  lr 5e-05  Le 11.8259 (12.5137)	Time 0.659 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:22:58,148 Epoch: [21][2474/4426]	Eit 95400  lr 5e-05  Le 15.2708 (12.5241)	Time 0.533 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:25:00,088 Epoch: [21][2674/4426]	Eit 95600  lr 5e-05  Le 10.5025 (12.5318)	Time 0.542 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:27:01,842 Epoch: [21][2874/4426]	Eit 95800  lr 5e-05  Le 12.1690 (12.5373)	Time 0.645 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:29:03,682 Epoch: [21][3074/4426]	Eit 96000  lr 5e-05  Le 13.7624 (12.5485)	Time 0.552 (0.000)	Data 0.009 (0.000)	
2021-06-24 06:31:06,329 Epoch: [21][3274/4426]	Eit 96200  lr 5e-05  Le 14.1804 (12.5406)	Time 0.651 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:33:09,041 Epoch: [21][3474/4426]	Eit 96400  lr 5e-05  Le 12.0969 (12.5459)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:35:10,899 Epoch: [21][3674/4426]	Eit 96600  lr 5e-05  Le 10.0376 (12.5545)	Time 0.686 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:37:14,404 Epoch: [21][3874/4426]	Eit 96800  lr 5e-05  Le 12.0197 (12.5598)	Time 0.649 (0.000)	Data 0.003 (0.000)	
2021-06-24 06:39:16,178 Epoch: [21][4074/4426]	Eit 97000  lr 5e-05  Le 12.7515 (12.5704)	Time 0.546 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:41:18,457 Epoch: [21][4274/4426]	Eit 97200  lr 5e-05  Le 7.4682 (12.5716)	Time 0.573 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:43:00,463 Test: [0/40]	Le 59.7521 (59.7521)	Time 9.381 (0.000)	
2021-06-24 06:43:10,521 calculate similarity time: 0.05637168884277344
2021-06-24 06:43:11,026 Image to text: 81.8, 97.4, 99.5, 1.0, 2.0
2021-06-24 06:43:11,355 Text to image: 67.2, 92.8, 96.8, 1.0, 3.6
2021-06-24 06:43:11,355 Current rsum is 535.5
2021-06-24 06:43:12,801 runs/coco_butd_region_bert/log
2021-06-24 06:43:12,801 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 06:43:12,803 image encoder trainable parameters: 20490144
2021-06-24 06:43:12,808 txt encoder trainable parameters: 137319072
2021-06-24 06:43:52,259 Epoch: [22][49/4426]	Eit 97400  lr 5e-05  Le 11.8146 (12.5269)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:45:56,043 Epoch: [22][249/4426]	Eit 97600  lr 5e-05  Le 12.6281 (12.4405)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:47:56,964 Epoch: [22][449/4426]	Eit 97800  lr 5e-05  Le 18.3882 (12.4251)	Time 0.652 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:49:58,953 Epoch: [22][649/4426]	Eit 98000  lr 5e-05  Le 15.1180 (12.4386)	Time 0.572 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:52:03,163 Epoch: [22][849/4426]	Eit 98200  lr 5e-05  Le 11.9464 (12.4001)	Time 0.672 (0.000)	Data 0.021 (0.000)	
2021-06-24 06:54:04,302 Epoch: [22][1049/4426]	Eit 98400  lr 5e-05  Le 11.1153 (12.4628)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:56:06,418 Epoch: [22][1249/4426]	Eit 98600  lr 5e-05  Le 12.5699 (12.4470)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-24 06:58:09,383 Epoch: [22][1449/4426]	Eit 98800  lr 5e-05  Le 10.6243 (12.5081)	Time 0.578 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:00:11,804 Epoch: [22][1649/4426]	Eit 99000  lr 5e-05  Le 10.4497 (12.5036)	Time 0.540 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:02:14,551 Epoch: [22][1849/4426]	Eit 99200  lr 5e-05  Le 12.0924 (12.4897)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:04:17,657 Epoch: [22][2049/4426]	Eit 99400  lr 5e-05  Le 14.0195 (12.4640)	Time 0.628 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:06:17,720 Epoch: [22][2249/4426]	Eit 99600  lr 5e-05  Le 7.9799 (12.4498)	Time 0.625 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:08:19,706 Epoch: [22][2449/4426]	Eit 99800  lr 5e-05  Le 11.1805 (12.4475)	Time 0.578 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:10:21,366 Epoch: [22][2649/4426]	Eit 100000  lr 5e-05  Le 10.8971 (12.4371)	Time 0.771 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:12:23,552 Epoch: [22][2849/4426]	Eit 100200  lr 5e-05  Le 10.9847 (12.4408)	Time 0.539 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:14:25,396 Epoch: [22][3049/4426]	Eit 100400  lr 5e-05  Le 10.0057 (12.4491)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:16:27,764 Epoch: [22][3249/4426]	Eit 100600  lr 5e-05  Le 13.7336 (12.4540)	Time 0.572 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:18:30,454 Epoch: [22][3449/4426]	Eit 100800  lr 5e-05  Le 16.5561 (12.4555)	Time 0.584 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:20:31,553 Epoch: [22][3649/4426]	Eit 101000  lr 5e-05  Le 11.6874 (12.4636)	Time 0.541 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:22:33,894 Epoch: [22][3849/4426]	Eit 101200  lr 5e-05  Le 10.7419 (12.4566)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:24:35,772 Epoch: [22][4049/4426]	Eit 101400  lr 5e-05  Le 13.9075 (12.4501)	Time 0.541 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:26:38,230 Epoch: [22][4249/4426]	Eit 101600  lr 5e-05  Le 13.4057 (12.4428)	Time 0.627 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:28:35,394 Test: [0/40]	Le 59.4915 (59.4914)	Time 8.881 (0.000)	
2021-06-24 07:28:45,606 calculate similarity time: 0.054451704025268555
2021-06-24 07:28:45,989 Image to text: 81.1, 97.4, 99.3, 1.0, 2.2
2021-06-24 07:28:46,299 Text to image: 67.4, 93.0, 96.9, 1.0, 3.7
2021-06-24 07:28:46,299 Current rsum is 535.08
2021-06-24 07:28:47,710 runs/coco_butd_region_bert/log
2021-06-24 07:28:47,710 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 07:28:47,711 image encoder trainable parameters: 20490144
2021-06-24 07:28:47,716 txt encoder trainable parameters: 137319072
2021-06-24 07:29:11,122 Epoch: [23][24/4426]	Eit 101800  lr 5e-05  Le 13.6822 (12.3458)	Time 0.588 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:31:13,707 Epoch: [23][224/4426]	Eit 102000  lr 5e-05  Le 11.3722 (12.2091)	Time 0.611 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:33:15,368 Epoch: [23][424/4426]	Eit 102200  lr 5e-05  Le 10.3554 (12.2262)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:35:17,007 Epoch: [23][624/4426]	Eit 102400  lr 5e-05  Le 9.6825 (12.1934)	Time 0.579 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:37:18,948 Epoch: [23][824/4426]	Eit 102600  lr 5e-05  Le 6.8908 (12.2402)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:39:21,032 Epoch: [23][1024/4426]	Eit 102800  lr 5e-05  Le 11.1542 (12.2982)	Time 0.539 (0.000)	Data 0.005 (0.000)	
2021-06-24 07:41:22,715 Epoch: [23][1224/4426]	Eit 103000  lr 5e-05  Le 13.4572 (12.3481)	Time 0.572 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:43:24,821 Epoch: [23][1424/4426]	Eit 103200  lr 5e-05  Le 11.4417 (12.3555)	Time 0.636 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:45:26,742 Epoch: [23][1624/4426]	Eit 103400  lr 5e-05  Le 7.9494 (12.3598)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:47:29,005 Epoch: [23][1824/4426]	Eit 103600  lr 5e-05  Le 11.8319 (12.3385)	Time 0.607 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:49:30,644 Epoch: [23][2024/4426]	Eit 103800  lr 5e-05  Le 13.5673 (12.3543)	Time 0.542 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:51:32,445 Epoch: [23][2224/4426]	Eit 104000  lr 5e-05  Le 11.0125 (12.3553)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:53:34,663 Epoch: [23][2424/4426]	Eit 104200  lr 5e-05  Le 14.4598 (12.3584)	Time 0.637 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:55:36,587 Epoch: [23][2624/4426]	Eit 104400  lr 5e-05  Le 7.5150 (12.3548)	Time 0.611 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:57:37,863 Epoch: [23][2824/4426]	Eit 104600  lr 5e-05  Le 13.0040 (12.3688)	Time 0.611 (0.000)	Data 0.002 (0.000)	
2021-06-24 07:59:39,930 Epoch: [23][3024/4426]	Eit 104800  lr 5e-05  Le 12.2378 (12.3802)	Time 0.794 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:01:42,335 Epoch: [23][3224/4426]	Eit 105000  lr 5e-05  Le 12.4228 (12.3667)	Time 0.576 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:03:45,241 Epoch: [23][3424/4426]	Eit 105200  lr 5e-05  Le 14.6708 (12.3520)	Time 0.598 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:05:48,728 Epoch: [23][3624/4426]	Eit 105400  lr 5e-05  Le 17.7463 (12.3488)	Time 0.853 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:07:52,180 Epoch: [23][3824/4426]	Eit 105600  lr 5e-05  Le 11.2024 (12.3550)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:09:55,483 Epoch: [23][4024/4426]	Eit 105800  lr 5e-05  Le 12.5466 (12.3588)	Time 0.600 (0.000)	Data 0.003 (0.000)	
2021-06-24 08:11:57,130 Epoch: [23][4224/4426]	Eit 106000  lr 5e-05  Le 8.8748 (12.3459)	Time 0.598 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:13:58,362 Epoch: [23][4424/4426]	Eit 106200  lr 5e-05  Le 15.0263 (12.3452)	Time 0.588 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:14:08,483 Test: [0/40]	Le 59.6271 (59.6271)	Time 8.766 (0.000)	
2021-06-24 08:14:18,513 calculate similarity time: 0.05624794960021973
2021-06-24 08:14:19,015 Image to text: 81.2, 97.7, 99.3, 1.0, 2.3
2021-06-24 08:14:19,344 Text to image: 67.4, 93.1, 97.0, 1.0, 3.6
2021-06-24 08:14:19,344 Current rsum is 535.7
2021-06-24 08:14:20,740 runs/coco_butd_region_bert/log
2021-06-24 08:14:20,740 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-24 08:14:20,741 image encoder trainable parameters: 20490144
2021-06-24 08:14:20,747 txt encoder trainable parameters: 137319072
2021-06-24 08:16:31,896 Epoch: [24][199/4426]	Eit 106400  lr 5e-05  Le 9.8340 (12.4813)	Time 0.570 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:18:33,085 Epoch: [24][399/4426]	Eit 106600  lr 5e-05  Le 11.9307 (12.3216)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:20:34,627 Epoch: [24][599/4426]	Eit 106800  lr 5e-05  Le 14.4620 (12.4026)	Time 0.592 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:22:36,951 Epoch: [24][799/4426]	Eit 107000  lr 5e-05  Le 13.6850 (12.3414)	Time 0.611 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:24:39,522 Epoch: [24][999/4426]	Eit 107200  lr 5e-05  Le 12.5312 (12.2804)	Time 0.610 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:26:41,567 Epoch: [24][1199/4426]	Eit 107400  lr 5e-05  Le 9.7263 (12.2909)	Time 0.540 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:28:44,066 Epoch: [24][1399/4426]	Eit 107600  lr 5e-05  Le 8.8548 (12.2797)	Time 0.591 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:30:46,132 Epoch: [24][1599/4426]	Eit 107800  lr 5e-05  Le 15.9284 (12.2475)	Time 0.552 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:32:48,108 Epoch: [24][1799/4426]	Eit 108000  lr 5e-05  Le 12.4962 (12.2262)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:34:51,351 Epoch: [24][1999/4426]	Eit 108200  lr 5e-05  Le 12.2764 (12.2121)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:36:52,737 Epoch: [24][2199/4426]	Eit 108400  lr 5e-05  Le 9.0679 (12.2113)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:38:56,329 Epoch: [24][2399/4426]	Eit 108600  lr 5e-05  Le 10.6821 (12.2064)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:40:59,297 Epoch: [24][2599/4426]	Eit 108800  lr 5e-05  Le 7.8719 (12.2175)	Time 0.735 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:43:00,382 Epoch: [24][2799/4426]	Eit 109000  lr 5e-05  Le 13.9196 (12.2205)	Time 0.564 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:45:02,094 Epoch: [24][2999/4426]	Eit 109200  lr 5e-05  Le 8.3246 (12.2378)	Time 0.700 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:47:04,345 Epoch: [24][3199/4426]	Eit 109400  lr 5e-05  Le 12.3700 (12.2571)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:49:06,011 Epoch: [24][3399/4426]	Eit 109600  lr 5e-05  Le 14.2684 (12.2664)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:51:07,856 Epoch: [24][3599/4426]	Eit 109800  lr 5e-05  Le 12.2961 (12.2712)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:53:10,846 Epoch: [24][3799/4426]	Eit 110000  lr 5e-05  Le 12.2767 (12.2628)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:55:15,203 Epoch: [24][3999/4426]	Eit 110200  lr 5e-05  Le 11.4947 (12.2673)	Time 0.584 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:57:16,977 Epoch: [24][4199/4426]	Eit 110400  lr 5e-05  Le 15.9200 (12.2612)	Time 0.595 (0.000)	Data 0.006 (0.000)	
2021-06-24 08:59:18,258 Epoch: [24][4399/4426]	Eit 110600  lr 5e-05  Le 12.5257 (12.2591)	Time 0.596 (0.000)	Data 0.002 (0.000)	
2021-06-24 08:59:43,975 Test: [0/40]	Le 59.6113 (59.6112)	Time 9.170 (0.000)	
2021-06-24 08:59:54,133 calculate similarity time: 0.04734396934509277
2021-06-24 08:59:54,518 Image to text: 82.3, 97.7, 99.4, 1.0, 1.9
2021-06-24 08:59:54,831 Text to image: 66.9, 93.0, 97.0, 1.0, 3.6
2021-06-24 08:59:54,831 Current rsum is 536.28
You have new mail in /var/spool/mail/root
[root@gpu1 vse_infty-master-my-graph-gru-vse++]# CUDA_VISIBLE_DEVICES=0,1 python3 eval.py --dataset coco --data_path ../data/coco
INFO:root:Evaluating runs/coco_butd_region_bert...
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-vse++/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-vse++/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
INFO:lib.evaluation:Test: [0/196]	Le 62.1759 (62.1759)	Time 5.624 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 62.1252 (62.0468)	Time 0.400 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 61.0113 (61.5977)	Time 0.230 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 62.5615 (61.7275)	Time 0.220 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 63.3247 (61.5637)	Time 0.223 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 61.8504 (61.5526)	Time 0.239 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 61.4458 (61.6472)	Time 0.224 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 62.1999 (61.6465)	Time 0.256 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 62.6923 (61.7072)	Time 0.321 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 61.5432 (61.7285)	Time 0.267 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 62.9814 (61.7774)	Time 0.242 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 60.6397 (61.7662)	Time 0.212 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 65.3718 (61.8212)	Time 0.252 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 61.0302 (61.8436)	Time 0.230 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 63.4211 (61.9006)	Time 0.226 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 59.9591 (61.8812)	Time 0.247 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 62.9804 (61.8917)	Time 0.222 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 61.1788 (61.8631)	Time 0.241 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 60.4796 (61.8192)	Time 0.211 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 60.0419 (61.8545)	Time 0.216 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.09354305267333984
INFO:lib.evaluation:Image to text: 81.1, 97.3, 98.7, 1.0, 1.5
INFO:lib.evaluation:Text to image: 66.2, 91.9, 96.1, 1.0, 4.0
INFO:lib.evaluation:rsum: 531.3 ar: 92.4 ari: 84.7
INFO:lib.evaluation:calculate similarity time: 0.09175276756286621
INFO:lib.evaluation:Image to text: 79.6, 96.2, 98.2, 1.0, 1.8
INFO:lib.evaluation:Text to image: 65.4, 90.8, 95.7, 1.0, 4.1
INFO:lib.evaluation:rsum: 525.9 ar: 91.3 ari: 84.0
INFO:lib.evaluation:calculate similarity time: 0.07595491409301758
INFO:lib.evaluation:Image to text: 79.6, 96.5, 98.5, 1.0, 1.7
INFO:lib.evaluation:Text to image: 65.9, 91.8, 96.3, 1.0, 4.0
INFO:lib.evaluation:rsum: 528.6 ar: 91.5 ari: 84.7
INFO:lib.evaluation:calculate similarity time: 0.08583593368530273
INFO:lib.evaluation:Image to text: 78.3, 96.5, 98.7, 1.0, 1.7
INFO:lib.evaluation:Text to image: 63.0, 91.6, 96.6, 1.0, 3.4
INFO:lib.evaluation:rsum: 524.6 ar: 91.2 ari: 83.7
INFO:lib.evaluation:calculate similarity time: 0.06534028053283691
INFO:lib.evaluation:Image to text: 80.0, 96.3, 99.2, 1.0, 1.6
INFO:lib.evaluation:Text to image: 65.8, 92.1, 96.8, 1.0, 3.6
INFO:lib.evaluation:rsum: 530.2 ar: 91.8 ari: 84.9
INFO:lib.evaluation:-----------------------------------
INFO:lib.evaluation:Mean metrics: 
INFO:lib.evaluation:rsum: 528.1
INFO:lib.evaluation:Average i2t Recall: 91.6
INFO:lib.evaluation:Image to text: 79.7 96.6 98.7 1.0 1.7
INFO:lib.evaluation:Average t2i Recall: 84.4
INFO:lib.evaluation:Text to image: 65.3 91.6 96.3 1.0 3.8
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
INFO:lib.evaluation:Test: [0/196]	Le 62.1759 (62.1759)	Time 2.032 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 62.1252 (62.0468)	Time 0.277 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 61.0113 (61.5977)	Time 0.212 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 62.5615 (61.7275)	Time 0.223 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 63.3247 (61.5637)	Time 0.211 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 61.8504 (61.5526)	Time 0.232 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 61.4458 (61.6472)	Time 0.247 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 62.1999 (61.6465)	Time 0.253 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 62.6923 (61.7072)	Time 0.293 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 61.5432 (61.7285)	Time 0.233 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 62.9814 (61.7774)	Time 0.222 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 60.6397 (61.7662)	Time 0.210 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 65.3718 (61.8212)	Time 0.241 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 61.0302 (61.8436)	Time 0.223 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 63.4211 (61.9006)	Time 0.208 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 59.9591 (61.8812)	Time 0.214 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 62.9804 (61.8917)	Time 0.214 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 61.1788 (61.8631)	Time 0.268 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 60.4796 (61.8192)	Time 0.209 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 60.0419 (61.8545)	Time 0.216 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.6811325550079346
INFO:lib.evaluation:rsum: 435.8
INFO:lib.evaluation:Average i2t Recall: 78.7
INFO:lib.evaluation:Image to text: 57.9 85.8 92.3 1.0 4.1
INFO:lib.evaluation:Average t2i Recall: 66.6
INFO:lib.evaluation:Text to image: 43.1 73.3 83.3 2.0 14.9
INFO:root:Evaluating runs/coco_butd_grid_bert...
Traceback (most recent call last):
  File "eval.py", line 58, in <module>
    main()
  File "eval.py", line 46, in main
    evaluation.evalrank(model_path, data_path=opt.data_path, split='testall', fold5=True)
  File "/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-vse++/lib/evaluation.py", line 196, in evalrank
    checkpoint = torch.load(model_path)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 571, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 229, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 210, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'runs/coco_butd_grid_bert/model_best.pth'
[root@gpu1 vse_infty-master-my-graph-gru-vse++]# 

