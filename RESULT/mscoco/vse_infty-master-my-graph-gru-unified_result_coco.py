[root@gpu1 vse_infty-master-my-graph-gru-unified]# sh train_region.sh 
2021-06-15 09:37:09,510 Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=False, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vse_mean_warmup_epochs=1, word_dim=300, workers=10)
2021-06-15 09:37:09,510 Model name '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' not found in model shortcut name list (bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese, bert-base-german-cased, bert-large-uncased-whole-word-masking, bert-large-cased-whole-word-masking, bert-large-uncased-whole-word-masking-finetuned-squad, bert-large-cased-whole-word-masking-finetuned-squad, bert-base-cased-finetuned-mrpc). Assuming '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' is a path or url to a directory containing tokenizer files.
2021-06-15 09:37:09,510 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/added_tokens.json. We won't load it.
2021-06-15 09:37:09,510 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/special_tokens_map.json. We won't load it.
2021-06-15 09:37:09,511 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/tokenizer_config.json. We won't load it.
2021-06-15 09:37:09,511 loading file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/vocab.txt
2021-06-15 09:37:09,511 loading file None
2021-06-15 09:37:09,511 loading file None
2021-06-15 09:37:09,511 loading file None
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
2021-06-15 09:37:40,865 loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
2021-06-15 09:37:40,866 Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

2021-06-15 09:37:40,868 loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
2021-06-15 09:37:48,232 Use adam as the optimizer, with init lr 0.0005
2021-06-15 09:37:48,233 Image encoder is data paralleled now.
2021-06-15 09:37:48,233 runs/coco_butd_region_bert/log
2021-06-15 09:37:48,233 runs/coco_butd_region_bert
2021-06-15 09:37:48,235 image encoder trainable parameters: 20490144
2021-06-15 09:37:48,240 txt encoder trainable parameters: 137319072
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
2021-06-15 09:42:03,898 Epoch: [0][199/4426]	Eit 200  lr 0.0005  Le 10.1191 (10.1394)	Time 0.944 (0.000)	Data 0.002 (0.000)	
2021-06-15 09:45:55,255 Epoch: [0][399/4426]	Eit 400  lr 0.0005  Le 10.0888 (10.1248)	Time 0.768 (0.000)	Data 0.002 (0.000)	
2021-06-15 09:48:34,099 Epoch: [0][599/4426]	Eit 600  lr 0.0005  Le 10.0448 (10.1057)	Time 0.744 (0.000)	Data 0.002 (0.000)	
2021-06-15 09:51:13,846 Epoch: [0][799/4426]	Eit 800  lr 0.0005  Le 10.0393 (10.0896)	Time 0.760 (0.000)	Data 0.002 (0.000)	
2021-06-15 09:56:27,415 Epoch: [0][999/4426]	Eit 1000  lr 0.0005  Le 10.0077 (10.0765)	Time 1.772 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:02:21,166 Epoch: [0][1199/4426]	Eit 1200  lr 0.0005  Le 9.9971 (10.0659)	Time 1.861 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:08:10,616 Epoch: [0][1399/4426]	Eit 1400  lr 0.0005  Le 10.0012 (10.0569)	Time 1.759 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:14:00,258 Epoch: [0][1599/4426]	Eit 1600  lr 0.0005  Le 9.9889 (10.0494)	Time 1.710 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:19:48,786 Epoch: [0][1799/4426]	Eit 1800  lr 0.0005  Le 9.9748 (10.0430)	Time 1.882 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:25:41,834 Epoch: [0][1999/4426]	Eit 2000  lr 0.0005  Le 9.9921 (10.0375)	Time 1.793 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:31:30,156 Epoch: [0][2199/4426]	Eit 2200  lr 0.0005  Le 9.9643 (10.0326)	Time 1.832 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:37:24,598 Epoch: [0][2399/4426]	Eit 2400  lr 0.0005  Le 9.9783 (10.0281)	Time 2.062 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:43:18,022 Epoch: [0][2599/4426]	Eit 2600  lr 0.0005  Le 9.9832 (10.0242)	Time 1.947 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:49:07,373 Epoch: [0][2799/4426]	Eit 2800  lr 0.0005  Le 9.9783 (10.0207)	Time 1.824 (0.000)	Data 0.002 (0.000)	
2021-06-15 10:54:56,015 Epoch: [0][2999/4426]	Eit 3000  lr 0.0005  Le 9.9408 (10.0174)	Time 1.298 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:00:48,903 Epoch: [0][3199/4426]	Eit 3200  lr 0.0005  Le 9.9997 (10.0143)	Time 1.770 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:06:14,486 Epoch: [0][3399/4426]	Eit 3400  lr 0.0005  Le 9.9648 (10.0117)	Time 1.701 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:12:08,148 Epoch: [0][3599/4426]	Eit 3600  lr 0.0005  Le 9.9453 (10.0093)	Time 1.879 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:17:55,817 Epoch: [0][3799/4426]	Eit 3800  lr 0.0005  Le 9.9548 (10.0067)	Time 1.879 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:23:47,357 Epoch: [0][3999/4426]	Eit 4000  lr 0.0005  Le 9.9848 (10.0045)	Time 1.945 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:29:36,131 Epoch: [0][4199/4426]	Eit 4200  lr 0.0005  Le 9.9803 (10.0023)	Time 2.037 (0.000)	Data 0.013 (0.000)	
2021-06-15 11:35:26,661 Epoch: [0][4399/4426]	Eit 4400  lr 0.0005  Le 9.9627 (10.0003)	Time 1.855 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:36:21,566 Test: [0/40]	Le 10.1909 (10.1908)	Time 8.454 (0.000)	
2021-06-15 11:36:50,337 calculate similarity time: 0.07441949844360352
2021-06-15 11:36:50,728 Image to text: 72.4, 94.1, 98.3, 1.0, 2.8
2021-06-15 11:36:51,058 Text to image: 58.4, 88.5, 95.5, 1.0, 4.1
2021-06-15 11:36:51,058 Current rsum is 507.24
2021-06-15 11:36:53,982 runs/coco_butd_region_bert/log
2021-06-15 11:36:53,982 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-15 11:36:53,984 image encoder trainable parameters: 20490144
2021-06-15 11:36:53,989 txt encoder trainable parameters: 137319072
2021-06-15 11:42:12,385 Epoch: [1][174/4426]	Eit 4600  lr 0.0005  Le 9.9197 (9.9494)	Time 1.751 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:48:04,405 Epoch: [1][374/4426]	Eit 4800  lr 0.0005  Le 9.9558 (9.9474)	Time 1.771 (0.000)	Data 0.002 (0.000)	
2021-06-15 11:53:54,424 Epoch: [1][574/4426]	Eit 5000  lr 0.0005  Le 9.9254 (9.9475)	Time 1.831 (0.000)	Data 0.004 (0.000)	
2021-06-15 11:59:46,930 Epoch: [1][774/4426]	Eit 5200  lr 0.0005  Le 9.9563 (9.9475)	Time 1.651 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:05:35,304 Epoch: [1][974/4426]	Eit 5400  lr 0.0005  Le 9.9253 (9.9473)	Time 1.600 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:11:24,850 Epoch: [1][1174/4426]	Eit 5600  lr 0.0005  Le 9.9486 (9.9470)	Time 1.701 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:16:50,944 Epoch: [1][1374/4426]	Eit 5800  lr 0.0005  Le 9.9625 (9.9466)	Time 0.809 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:22:36,102 Epoch: [1][1574/4426]	Eit 6000  lr 0.0005  Le 9.9683 (9.9462)	Time 1.975 (0.000)	Data 0.012 (0.000)	
2021-06-15 12:28:26,870 Epoch: [1][1774/4426]	Eit 6200  lr 0.0005  Le 9.9432 (9.9458)	Time 1.716 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:34:22,066 Epoch: [1][1974/4426]	Eit 6400  lr 0.0005  Le 9.9424 (9.9455)	Time 1.696 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:40:12,004 Epoch: [1][2174/4426]	Eit 6600  lr 0.0005  Le 9.9438 (9.9452)	Time 1.903 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:46:03,027 Epoch: [1][2374/4426]	Eit 6800  lr 0.0005  Le 9.9283 (9.9448)	Time 1.818 (0.000)	Data 0.003 (0.000)	
2021-06-15 12:51:50,450 Epoch: [1][2574/4426]	Eit 7000  lr 0.0005  Le 9.9457 (9.9444)	Time 1.833 (0.000)	Data 0.002 (0.000)	
2021-06-15 12:57:43,146 Epoch: [1][2774/4426]	Eit 7200  lr 0.0005  Le 9.9768 (9.9440)	Time 1.709 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:03:33,993 Epoch: [1][2974/4426]	Eit 7400  lr 0.0005  Le 9.9074 (9.9436)	Time 1.359 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:09:27,371 Epoch: [1][3174/4426]	Eit 7600  lr 0.0005  Le 9.9492 (9.9432)	Time 1.914 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:15:18,579 Epoch: [1][3374/4426]	Eit 7800  lr 0.0005  Le 9.9449 (9.9429)	Time 1.634 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:21:09,430 Epoch: [1][3574/4426]	Eit 8000  lr 0.0005  Le 9.9523 (9.9426)	Time 2.007 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:27:04,827 Epoch: [1][3774/4426]	Eit 8200  lr 0.0005  Le 9.9145 (9.9421)	Time 1.367 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:32:29,434 Epoch: [1][3974/4426]	Eit 8400  lr 0.0005  Le 9.9743 (9.9419)	Time 1.777 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:38:18,028 Epoch: [1][4174/4426]	Eit 8600  lr 0.0005  Le 9.9023 (9.9416)	Time 1.726 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:44:04,875 Epoch: [1][4374/4426]	Eit 8800  lr 0.0005  Le 9.9172 (9.9412)	Time 1.529 (0.000)	Data 0.002 (0.000)	
2021-06-15 13:45:42,127 Test: [0/40]	Le 10.1910 (10.1910)	Time 8.353 (0.000)	
2021-06-15 13:46:10,177 calculate similarity time: 0.08183908462524414
2021-06-15 13:46:10,580 Image to text: 75.8, 95.9, 99.0, 1.0, 2.1
2021-06-15 13:46:10,906 Text to image: 62.5, 90.5, 96.2, 1.0, 3.6
2021-06-15 13:46:10,906 Current rsum is 519.84
2021-06-15 13:46:14,634 runs/coco_butd_region_bert/log
2021-06-15 13:46:14,634 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-15 13:46:14,637 image encoder trainable parameters: 20490144
2021-06-15 13:46:14,645 txt encoder trainable parameters: 137319072
2021-06-15 13:50:43,809 Epoch: [2][149/4426]	Eit 9000  lr 0.0005  Le 9.9244 (9.9244)	Time 1.811 (0.000)	Data 0.003 (0.000)	
2021-06-15 13:56:36,322 Epoch: [2][349/4426]	Eit 9200  lr 0.0005  Le 9.9510 (9.9253)	Time 1.563 (0.000)	Data 0.006 (0.000)	
2021-06-15 14:02:25,065 Epoch: [2][549/4426]	Eit 9400  lr 0.0005  Le 9.9283 (9.9245)	Time 1.876 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:08:14,214 Epoch: [2][749/4426]	Eit 9600  lr 0.0005  Le 9.9274 (9.9246)	Time 1.681 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:14:02,146 Epoch: [2][949/4426]	Eit 9800  lr 0.0005  Le 9.9047 (9.9243)	Time 1.882 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:19:48,405 Epoch: [2][1149/4426]	Eit 10000  lr 0.0005  Le 9.8864 (9.9239)	Time 1.864 (0.000)	Data 0.003 (0.000)	
2021-06-15 14:25:35,197 Epoch: [2][1349/4426]	Eit 10200  lr 0.0005  Le 9.9115 (9.9241)	Time 1.784 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:31:21,691 Epoch: [2][1549/4426]	Eit 10400  lr 0.0005  Le 9.8905 (9.9238)	Time 1.821 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:37:10,951 Epoch: [2][1749/4426]	Eit 10600  lr 0.0005  Le 9.9350 (9.9240)	Time 1.926 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:42:33,681 Epoch: [2][1949/4426]	Eit 10800  lr 0.0005  Le 9.9181 (9.9239)	Time 0.796 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:48:21,964 Epoch: [2][2149/4426]	Eit 11000  lr 0.0005  Le 9.9378 (9.9236)	Time 2.184 (0.000)	Data 0.002 (0.000)	
2021-06-15 14:54:11,810 Epoch: [2][2349/4426]	Eit 11200  lr 0.0005  Le 9.9283 (9.9235)	Time 1.737 (0.000)	Data 0.003 (0.000)	
2021-06-15 15:00:00,671 Epoch: [2][2549/4426]	Eit 11400  lr 0.0005  Le 9.9351 (9.9234)	Time 1.787 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:05:53,366 Epoch: [2][2749/4426]	Eit 11600  lr 0.0005  Le 9.9070 (9.9231)	Time 1.772 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:11:39,082 Epoch: [2][2949/4426]	Eit 11800  lr 0.0005  Le 9.9403 (9.9231)	Time 1.725 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:17:30,056 Epoch: [2][3149/4426]	Eit 12000  lr 0.0005  Le 9.9424 (9.9231)	Time 1.828 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:23:22,091 Epoch: [2][3349/4426]	Eit 12200  lr 0.0005  Le 9.9230 (9.9229)	Time 1.770 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:29:10,439 Epoch: [2][3549/4426]	Eit 12400  lr 0.0005  Le 9.9201 (9.9227)	Time 1.642 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:34:59,167 Epoch: [2][3749/4426]	Eit 12600  lr 0.0005  Le 9.8840 (9.9225)	Time 1.785 (0.000)	Data 0.003 (0.000)	
2021-06-15 15:40:52,307 Epoch: [2][3949/4426]	Eit 12800  lr 0.0005  Le 9.9298 (9.9224)	Time 1.644 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:46:39,428 Epoch: [2][4149/4426]	Eit 13000  lr 0.0005  Le 9.8936 (9.9223)	Time 1.756 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:52:28,046 Epoch: [2][4349/4426]	Eit 13200  lr 0.0005  Le 9.9329 (9.9222)	Time 1.620 (0.000)	Data 0.002 (0.000)	
2021-06-15 15:54:48,855 Test: [0/40]	Le 10.1895 (10.1895)	Time 8.291 (0.000)	
2021-06-15 15:55:08,964 calculate similarity time: 0.056154489517211914
2021-06-15 15:55:09,509 Image to text: 79.3, 96.4, 99.4, 1.0, 2.0
2021-06-15 15:55:09,898 Text to image: 63.7, 91.0, 96.6, 1.0, 3.8
2021-06-15 15:55:09,898 Current rsum is 526.4000000000001
2021-06-15 15:55:13,590 runs/coco_butd_region_bert/log
2021-06-15 15:55:13,590 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-15 15:55:13,593 image encoder trainable parameters: 20490144
2021-06-15 15:55:13,621 txt encoder trainable parameters: 137319072
2021-06-15 15:58:45,980 Epoch: [3][124/4426]	Eit 13400  lr 0.0005  Le 9.9109 (9.9124)	Time 1.645 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:04:36,359 Epoch: [3][324/4426]	Eit 13600  lr 0.0005  Le 9.9066 (9.9105)	Time 1.899 (0.000)	Data 0.003 (0.000)	
2021-06-15 16:10:26,133 Epoch: [3][524/4426]	Eit 13800  lr 0.0005  Le 9.9009 (9.9104)	Time 2.195 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:16:16,109 Epoch: [3][724/4426]	Eit 14000  lr 0.0005  Le 9.8707 (9.9107)	Time 1.784 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:22:01,634 Epoch: [3][924/4426]	Eit 14200  lr 0.0005  Le 9.9176 (9.9110)	Time 1.629 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:27:55,302 Epoch: [3][1124/4426]	Eit 14400  lr 0.0005  Le 9.9261 (9.9107)	Time 1.796 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:33:45,596 Epoch: [3][1324/4426]	Eit 14600  lr 0.0005  Le 9.8872 (9.9108)	Time 1.782 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:39:37,636 Epoch: [3][1524/4426]	Eit 14800  lr 0.0005  Le 9.9352 (9.9106)	Time 1.647 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:45:27,227 Epoch: [3][1724/4426]	Eit 15000  lr 0.0005  Le 9.9354 (9.9105)	Time 1.726 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:51:17,950 Epoch: [3][1924/4426]	Eit 15200  lr 0.0005  Le 9.8786 (9.9104)	Time 1.594 (0.000)	Data 0.002 (0.000)	
2021-06-15 16:57:09,581 Epoch: [3][2124/4426]	Eit 15400  lr 0.0005  Le 9.9144 (9.9105)	Time 1.814 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:03:03,627 Epoch: [3][2324/4426]	Eit 15600  lr 0.0005  Le 9.9122 (9.9104)	Time 1.845 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:08:26,757 Epoch: [3][2524/4426]	Eit 15800  lr 0.0005  Le 9.9156 (9.9102)	Time 0.815 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:14:20,040 Epoch: [3][2724/4426]	Eit 16000  lr 0.0005  Le 9.9125 (9.9102)	Time 1.842 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:20:12,380 Epoch: [3][2924/4426]	Eit 16200  lr 0.0005  Le 9.9007 (9.9101)	Time 2.263 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:26:06,205 Epoch: [3][3124/4426]	Eit 16400  lr 0.0005  Le 9.8922 (9.9102)	Time 1.743 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:31:53,909 Epoch: [3][3324/4426]	Eit 16600  lr 0.0005  Le 9.9230 (9.9101)	Time 1.766 (0.000)	Data 0.010 (0.000)	
2021-06-15 17:37:43,281 Epoch: [3][3524/4426]	Eit 16800  lr 0.0005  Le 9.8877 (9.9103)	Time 1.632 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:43:31,724 Epoch: [3][3724/4426]	Eit 17000  lr 0.0005  Le 9.8860 (9.9102)	Time 1.889 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:49:21,969 Epoch: [3][3924/4426]	Eit 17200  lr 0.0005  Le 9.9172 (9.9101)	Time 1.457 (0.000)	Data 0.002 (0.000)	
2021-06-15 17:55:13,105 Epoch: [3][4124/4426]	Eit 17400  lr 0.0005  Le 9.9117 (9.9100)	Time 1.483 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:01:02,684 Epoch: [3][4324/4426]	Eit 17600  lr 0.0005  Le 9.8682 (9.9100)	Time 1.522 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:04:06,959 Test: [0/40]	Le 10.1882 (10.1882)	Time 8.323 (0.000)	
2021-06-15 18:04:34,969 calculate similarity time: 0.06772804260253906
2021-06-15 18:04:35,465 Image to text: 77.6, 97.4, 99.1, 1.0, 2.5
2021-06-15 18:04:35,834 Text to image: 64.6, 91.6, 96.6, 1.0, 3.7
2021-06-15 18:04:35,834 Current rsum is 526.9
2021-06-15 18:04:39,474 runs/coco_butd_region_bert/log
2021-06-15 18:04:39,474 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-15 18:04:39,477 image encoder trainable parameters: 20490144
2021-06-15 18:04:39,487 txt encoder trainable parameters: 137319072
2021-06-15 18:07:42,584 Epoch: [4][99/4426]	Eit 17800  lr 0.0005  Le 9.8964 (9.9013)	Time 1.768 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:13:32,677 Epoch: [4][299/4426]	Eit 18000  lr 0.0005  Le 9.8938 (9.9011)	Time 1.807 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:19:21,388 Epoch: [4][499/4426]	Eit 18200  lr 0.0005  Le 9.8786 (9.9007)	Time 1.808 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:24:44,722 Epoch: [4][699/4426]	Eit 18400  lr 0.0005  Le 9.8977 (9.9003)	Time 1.806 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:30:37,188 Epoch: [4][899/4426]	Eit 18600  lr 0.0005  Le 9.8941 (9.9006)	Time 1.936 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:36:28,771 Epoch: [4][1099/4426]	Eit 18800  lr 0.0005  Le 9.9125 (9.9007)	Time 1.590 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:42:21,470 Epoch: [4][1299/4426]	Eit 19000  lr 0.0005  Le 9.9185 (9.9009)	Time 1.947 (0.000)	Data 0.003 (0.000)	
2021-06-15 18:48:13,638 Epoch: [4][1499/4426]	Eit 19200  lr 0.0005  Le 9.9016 (9.9009)	Time 1.830 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:54:02,604 Epoch: [4][1699/4426]	Eit 19400  lr 0.0005  Le 9.8773 (9.9010)	Time 1.620 (0.000)	Data 0.002 (0.000)	
2021-06-15 18:59:50,594 Epoch: [4][1899/4426]	Eit 19600  lr 0.0005  Le 9.8893 (9.9007)	Time 1.649 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:05:38,231 Epoch: [4][2099/4426]	Eit 19800  lr 0.0005  Le 9.8810 (9.9004)	Time 1.829 (0.000)	Data 0.004 (0.000)	
2021-06-15 19:11:27,037 Epoch: [4][2299/4426]	Eit 20000  lr 0.0005  Le 9.9256 (9.9004)	Time 1.427 (0.000)	Data 0.003 (0.000)	
2021-06-15 19:17:17,171 Epoch: [4][2499/4426]	Eit 20200  lr 0.0005  Le 9.8777 (9.9007)	Time 1.822 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:23:06,514 Epoch: [4][2699/4426]	Eit 20400  lr 0.0005  Le 9.8912 (9.9005)	Time 1.931 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:28:54,458 Epoch: [4][2899/4426]	Eit 20600  lr 0.0005  Le 9.8724 (9.9005)	Time 1.760 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:34:13,969 Epoch: [4][3099/4426]	Eit 20800  lr 0.0005  Le 9.8885 (9.9006)	Time 2.047 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:40:02,680 Epoch: [4][3299/4426]	Eit 21000  lr 0.0005  Le 9.9159 (9.9005)	Time 1.436 (0.000)	Data 0.003 (0.000)	
2021-06-15 19:45:54,552 Epoch: [4][3499/4426]	Eit 21200  lr 0.0005  Le 9.9271 (9.9005)	Time 1.846 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:51:43,065 Epoch: [4][3699/4426]	Eit 21400  lr 0.0005  Le 9.9038 (9.9006)	Time 1.938 (0.000)	Data 0.002 (0.000)	
2021-06-15 19:57:32,936 Epoch: [4][3899/4426]	Eit 21600  lr 0.0005  Le 9.9223 (9.9006)	Time 1.442 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:03:19,273 Epoch: [4][4099/4426]	Eit 21800  lr 0.0005  Le 9.8917 (9.9005)	Time 1.553 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:09:08,100 Epoch: [4][4299/4426]	Eit 22000  lr 0.0005  Le 9.9076 (9.9004)	Time 1.582 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:12:55,748 Test: [0/40]	Le 10.1913 (10.1913)	Time 8.276 (0.000)	
2021-06-15 20:13:23,341 calculate similarity time: 0.0663290023803711
2021-06-15 20:13:23,897 Image to text: 78.4, 97.6, 99.1, 1.0, 2.1
2021-06-15 20:13:24,220 Text to image: 65.2, 91.9, 96.5, 1.0, 3.8
2021-06-15 20:13:24,220 Current rsum is 528.6999999999999
2021-06-15 20:13:27,922 runs/coco_butd_region_bert/log
2021-06-15 20:13:27,922 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-15 20:13:27,926 image encoder trainable parameters: 20490144
2021-06-15 20:13:27,938 txt encoder trainable parameters: 137319072
2021-06-15 20:15:48,262 Epoch: [5][74/4426]	Eit 22200  lr 0.0005  Le 9.9297 (9.8908)	Time 1.832 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:21:42,023 Epoch: [5][274/4426]	Eit 22400  lr 0.0005  Le 9.8368 (9.8932)	Time 2.120 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:27:32,337 Epoch: [5][474/4426]	Eit 22600  lr 0.0005  Le 9.9127 (9.8934)	Time 1.658 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:33:21,151 Epoch: [5][674/4426]	Eit 22800  lr 0.0005  Le 9.9262 (9.8932)	Time 1.786 (0.000)	Data 0.003 (0.000)	
2021-06-15 20:39:14,410 Epoch: [5][874/4426]	Eit 23000  lr 0.0005  Le 9.8534 (9.8938)	Time 1.500 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:45:08,496 Epoch: [5][1074/4426]	Eit 23200  lr 0.0005  Le 9.8785 (9.8935)	Time 1.670 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:50:35,303 Epoch: [5][1274/4426]	Eit 23400  lr 0.0005  Le 9.9118 (9.8932)	Time 1.578 (0.000)	Data 0.002 (0.000)	
2021-06-15 20:56:24,766 Epoch: [5][1474/4426]	Eit 23600  lr 0.0005  Le 9.8871 (9.8931)	Time 1.679 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:02:14,333 Epoch: [5][1674/4426]	Eit 23800  lr 0.0005  Le 9.9326 (9.8933)	Time 1.998 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:08:05,019 Epoch: [5][1874/4426]	Eit 24000  lr 0.0005  Le 9.8735 (9.8932)	Time 2.080 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:13:51,882 Epoch: [5][2074/4426]	Eit 24200  lr 0.0005  Le 9.8845 (9.8932)	Time 1.840 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:19:41,072 Epoch: [5][2274/4426]	Eit 24400  lr 0.0005  Le 9.8868 (9.8932)	Time 1.425 (0.000)	Data 0.003 (0.000)	
2021-06-15 21:25:26,822 Epoch: [5][2474/4426]	Eit 24600  lr 0.0005  Le 9.8768 (9.8931)	Time 1.671 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:31:17,833 Epoch: [5][2674/4426]	Eit 24800  lr 0.0005  Le 9.8821 (9.8932)	Time 1.821 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:37:04,098 Epoch: [5][2874/4426]	Eit 25000  lr 0.0005  Le 9.9438 (9.8933)	Time 1.616 (0.000)	Data 0.012 (0.000)	
2021-06-15 21:42:53,366 Epoch: [5][3074/4426]	Eit 25200  lr 0.0005  Le 9.8883 (9.8934)	Time 1.817 (0.000)	Data 0.013 (0.000)	
2021-06-15 21:48:38,774 Epoch: [5][3274/4426]	Eit 25400  lr 0.0005  Le 9.8841 (9.8932)	Time 1.732 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:54:28,066 Epoch: [5][3474/4426]	Eit 25600  lr 0.0005  Le 9.8888 (9.8932)	Time 1.920 (0.000)	Data 0.002 (0.000)	
2021-06-15 21:59:55,039 Epoch: [5][3674/4426]	Eit 25800  lr 0.0005  Le 9.8914 (9.8933)	Time 0.783 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:05:42,561 Epoch: [5][3874/4426]	Eit 26000  lr 0.0005  Le 9.8944 (9.8934)	Time 1.429 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:11:31,383 Epoch: [5][4074/4426]	Eit 26200  lr 0.0005  Le 9.8573 (9.8933)	Time 1.755 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:17:20,682 Epoch: [5][4274/4426]	Eit 26400  lr 0.0005  Le 9.8556 (9.8932)	Time 1.816 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:21:52,567 Test: [0/40]	Le 10.1827 (10.1827)	Time 8.410 (0.000)	
2021-06-15 22:22:20,059 calculate similarity time: 0.06817793846130371
2021-06-15 22:22:20,439 Image to text: 79.1, 97.2, 99.2, 1.0, 1.8
2021-06-15 22:22:20,769 Text to image: 65.5, 92.2, 96.9, 1.0, 3.6
2021-06-15 22:22:20,769 Current rsum is 530.04
2021-06-15 22:22:24,405 runs/coco_butd_region_bert/log
2021-06-15 22:22:24,406 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-15 22:22:24,410 image encoder trainable parameters: 20490144
2021-06-15 22:22:24,422 txt encoder trainable parameters: 137319072
2021-06-15 22:23:59,100 Epoch: [6][49/4426]	Eit 26600  lr 0.0005  Le 9.8857 (9.8826)	Time 1.904 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:29:48,543 Epoch: [6][249/4426]	Eit 26800  lr 0.0005  Le 9.8626 (9.8841)	Time 1.778 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:35:34,512 Epoch: [6][449/4426]	Eit 27000  lr 0.0005  Le 9.9109 (9.8843)	Time 1.852 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:41:23,152 Epoch: [6][649/4426]	Eit 27200  lr 0.0005  Le 9.8688 (9.8845)	Time 1.726 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:47:10,069 Epoch: [6][849/4426]	Eit 27400  lr 0.0005  Le 9.9124 (9.8845)	Time 1.736 (0.000)	Data 0.004 (0.000)	
2021-06-15 22:53:01,300 Epoch: [6][1049/4426]	Eit 27600  lr 0.0005  Le 9.8908 (9.8846)	Time 1.861 (0.000)	Data 0.002 (0.000)	
2021-06-15 22:58:52,879 Epoch: [6][1249/4426]	Eit 27800  lr 0.0005  Le 9.8980 (9.8847)	Time 1.611 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:04:39,765 Epoch: [6][1449/4426]	Eit 28000  lr 0.0005  Le 9.8427 (9.8848)	Time 1.505 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:10:29,446 Epoch: [6][1649/4426]	Eit 28200  lr 0.0005  Le 9.8596 (9.8853)	Time 1.893 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:15:51,594 Epoch: [6][1849/4426]	Eit 28400  lr 0.0005  Le 9.8937 (9.8852)	Time 1.809 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:21:40,141 Epoch: [6][2049/4426]	Eit 28600  lr 0.0005  Le 9.8644 (9.8855)	Time 1.698 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:27:30,229 Epoch: [6][2249/4426]	Eit 28800  lr 0.0005  Le 9.9234 (9.8857)	Time 2.186 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:33:21,032 Epoch: [6][2449/4426]	Eit 29000  lr 0.0005  Le 9.8906 (9.8860)	Time 1.820 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:39:08,183 Epoch: [6][2649/4426]	Eit 29200  lr 0.0005  Le 9.9242 (9.8862)	Time 1.698 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:44:58,801 Epoch: [6][2849/4426]	Eit 29400  lr 0.0005  Le 9.8941 (9.8863)	Time 1.721 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:50:48,499 Epoch: [6][3049/4426]	Eit 29600  lr 0.0005  Le 9.8882 (9.8863)	Time 1.918 (0.000)	Data 0.002 (0.000)	
2021-06-15 23:56:36,822 Epoch: [6][3249/4426]	Eit 29800  lr 0.0005  Le 9.8862 (9.8863)	Time 1.877 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:02:25,662 Epoch: [6][3449/4426]	Eit 30000  lr 0.0005  Le 9.8981 (9.8864)	Time 1.814 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:08:17,040 Epoch: [6][3649/4426]	Eit 30200  lr 0.0005  Le 9.8701 (9.8864)	Time 1.819 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:13:59,821 Epoch: [6][3849/4426]	Eit 30400  lr 0.0005  Le 9.8574 (9.8864)	Time 1.706 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:19:50,901 Epoch: [6][4049/4426]	Eit 30600  lr 0.0005  Le 9.9003 (9.8864)	Time 1.762 (0.000)	Data 0.003 (0.000)	
2021-06-16 00:25:36,073 Epoch: [6][4249/4426]	Eit 30800  lr 0.0005  Le 9.9054 (9.8864)	Time 0.939 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:30:32,707 Test: [0/40]	Le 10.1835 (10.1835)	Time 8.484 (0.000)	
2021-06-16 00:31:00,693 calculate similarity time: 0.0797569751739502
2021-06-16 00:31:01,223 Image to text: 81.0, 97.6, 99.3, 1.0, 2.5
2021-06-16 00:31:01,655 Text to image: 66.2, 92.0, 96.8, 1.0, 4.0
2021-06-16 00:31:01,655 Current rsum is 532.9
2021-06-16 00:31:05,452 runs/coco_butd_region_bert/log
2021-06-16 00:31:05,452 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 00:31:05,455 image encoder trainable parameters: 20490144
2021-06-16 00:31:05,462 txt encoder trainable parameters: 137319072
2021-06-16 00:31:57,090 Epoch: [7][24/4426]	Eit 31000  lr 0.0005  Le 9.9155 (9.8756)	Time 1.703 (0.000)	Data 0.003 (0.000)	
2021-06-16 00:37:46,215 Epoch: [7][224/4426]	Eit 31200  lr 0.0005  Le 9.9093 (9.8793)	Time 1.744 (0.000)	Data 0.003 (0.000)	
2021-06-16 00:43:34,979 Epoch: [7][424/4426]	Eit 31400  lr 0.0005  Le 9.8908 (9.8792)	Time 1.776 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:49:27,133 Epoch: [7][624/4426]	Eit 31600  lr 0.0005  Le 9.8665 (9.8795)	Time 1.925 (0.000)	Data 0.002 (0.000)	
2021-06-16 00:55:13,666 Epoch: [7][824/4426]	Eit 31800  lr 0.0005  Le 9.8701 (9.8798)	Time 1.473 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:01:02,243 Epoch: [7][1024/4426]	Eit 32000  lr 0.0005  Le 9.8776 (9.8803)	Time 1.773 (0.000)	Data 0.003 (0.000)	
2021-06-16 01:06:51,109 Epoch: [7][1224/4426]	Eit 32200  lr 0.0005  Le 9.9105 (9.8804)	Time 1.771 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:12:39,774 Epoch: [7][1424/4426]	Eit 32400  lr 0.0005  Le 9.8520 (9.8803)	Time 1.802 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:18:27,682 Epoch: [7][1624/4426]	Eit 32600  lr 0.0005  Le 9.9067 (9.8803)	Time 1.729 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:24:15,300 Epoch: [7][1824/4426]	Eit 32800  lr 0.0005  Le 9.8781 (9.8807)	Time 1.727 (0.000)	Data 0.003 (0.000)	
2021-06-16 01:30:03,905 Epoch: [7][2024/4426]	Eit 33000  lr 0.0005  Le 9.8623 (9.8807)	Time 1.807 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:35:56,265 Epoch: [7][2224/4426]	Eit 33200  lr 0.0005  Le 9.8474 (9.8809)	Time 1.641 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:41:17,179 Epoch: [7][2424/4426]	Eit 33400  lr 0.0005  Le 9.9107 (9.8808)	Time 1.826 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:47:01,325 Epoch: [7][2624/4426]	Eit 33600  lr 0.0005  Le 9.8957 (9.8809)	Time 1.613 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:52:55,208 Epoch: [7][2824/4426]	Eit 33800  lr 0.0005  Le 9.8761 (9.8810)	Time 1.580 (0.000)	Data 0.002 (0.000)	
2021-06-16 01:58:40,819 Epoch: [7][3024/4426]	Eit 34000  lr 0.0005  Le 9.8874 (9.8809)	Time 1.739 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:04:29,397 Epoch: [7][3224/4426]	Eit 34200  lr 0.0005  Le 9.8746 (9.8811)	Time 1.774 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:10:21,920 Epoch: [7][3424/4426]	Eit 34400  lr 0.0005  Le 9.8803 (9.8810)	Time 1.523 (0.000)	Data 0.003 (0.000)	
2021-06-16 02:16:14,332 Epoch: [7][3624/4426]	Eit 34600  lr 0.0005  Le 9.9040 (9.8811)	Time 1.630 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:22:02,975 Epoch: [7][3824/4426]	Eit 34800  lr 0.0005  Le 9.8796 (9.8811)	Time 2.021 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:27:52,261 Epoch: [7][4024/4426]	Eit 35000  lr 0.0005  Le 9.9243 (9.8812)	Time 1.727 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:33:42,559 Epoch: [7][4224/4426]	Eit 35200  lr 0.0005  Le 9.9164 (9.8813)	Time 1.719 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:39:32,948 Epoch: [7][4424/4426]	Eit 35400  lr 0.0005  Le 9.8792 (9.8813)	Time 1.940 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:39:43,228 Test: [0/40]	Le 10.1927 (10.1927)	Time 8.817 (0.000)	
2021-06-16 02:40:10,732 calculate similarity time: 0.07616043090820312
2021-06-16 02:40:11,229 Image to text: 80.7, 97.5, 99.4, 1.0, 2.5
2021-06-16 02:40:11,553 Text to image: 66.9, 92.3, 97.0, 1.0, 3.7
2021-06-16 02:40:11,553 Current rsum is 533.84
2021-06-16 02:40:15,278 runs/coco_butd_region_bert/log
2021-06-16 02:40:15,279 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 02:40:15,282 image encoder trainable parameters: 20490144
2021-06-16 02:40:15,294 txt encoder trainable parameters: 137319072
2021-06-16 02:46:13,014 Epoch: [8][199/4426]	Eit 35600  lr 0.0005  Le 9.8748 (9.8743)	Time 1.713 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:51:47,899 Epoch: [8][399/4426]	Eit 35800  lr 0.0005  Le 9.8742 (9.8754)	Time 0.728 (0.000)	Data 0.002 (0.000)	
2021-06-16 02:57:25,756 Epoch: [8][599/4426]	Eit 36000  lr 0.0005  Le 9.9228 (9.8751)	Time 2.098 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:03:13,639 Epoch: [8][799/4426]	Eit 36200  lr 0.0005  Le 9.8946 (9.8752)	Time 1.961 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:09:03,398 Epoch: [8][999/4426]	Eit 36400  lr 0.0005  Le 9.8840 (9.8750)	Time 1.885 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:14:51,823 Epoch: [8][1199/4426]	Eit 36600  lr 0.0005  Le 9.8646 (9.8753)	Time 1.550 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:20:42,705 Epoch: [8][1399/4426]	Eit 36800  lr 0.0005  Le 9.8721 (9.8751)	Time 1.903 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:26:31,309 Epoch: [8][1599/4426]	Eit 37000  lr 0.0005  Le 9.8767 (9.8753)	Time 1.542 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:32:18,479 Epoch: [8][1799/4426]	Eit 37200  lr 0.0005  Le 9.8639 (9.8753)	Time 1.694 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:38:07,748 Epoch: [8][1999/4426]	Eit 37400  lr 0.0005  Le 9.8538 (9.8752)	Time 1.500 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:43:56,761 Epoch: [8][2199/4426]	Eit 37600  lr 0.0005  Le 9.8661 (9.8752)	Time 1.746 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:49:44,765 Epoch: [8][2399/4426]	Eit 37800  lr 0.0005  Le 9.8674 (9.8754)	Time 1.565 (0.000)	Data 0.002 (0.000)	
2021-06-16 03:55:36,617 Epoch: [8][2599/4426]	Eit 38000  lr 0.0005  Le 9.8828 (9.8756)	Time 2.004 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:01:25,291 Epoch: [8][2799/4426]	Eit 38200  lr 0.0005  Le 9.8477 (9.8756)	Time 2.121 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:06:49,492 Epoch: [8][2999/4426]	Eit 38400  lr 0.0005  Le 9.8913 (9.8758)	Time 1.615 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:12:42,765 Epoch: [8][3199/4426]	Eit 38600  lr 0.0005  Le 9.8648 (9.8759)	Time 2.074 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:18:30,163 Epoch: [8][3399/4426]	Eit 38800  lr 0.0005  Le 9.8666 (9.8760)	Time 2.208 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:24:16,389 Epoch: [8][3599/4426]	Eit 39000  lr 0.0005  Le 9.8801 (9.8761)	Time 1.912 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:30:06,673 Epoch: [8][3799/4426]	Eit 39200  lr 0.0005  Le 9.8452 (9.8761)	Time 1.757 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:35:57,165 Epoch: [8][3999/4426]	Eit 39400  lr 0.0005  Le 9.8733 (9.8761)	Time 2.086 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:41:44,450 Epoch: [8][4199/4426]	Eit 39600  lr 0.0005  Le 9.8797 (9.8761)	Time 1.929 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:47:37,567 Epoch: [8][4399/4426]	Eit 39800  lr 0.0005  Le 9.8930 (9.8762)	Time 1.451 (0.000)	Data 0.002 (0.000)	
2021-06-16 04:48:29,896 Test: [0/40]	Le 10.1914 (10.1914)	Time 8.851 (0.000)	
2021-06-16 04:48:57,921 calculate similarity time: 0.06709742546081543
2021-06-16 04:48:58,378 Image to text: 80.2, 96.9, 99.5, 1.0, 2.3
2021-06-16 04:48:58,775 Text to image: 66.3, 92.2, 96.9, 1.0, 3.5
2021-06-16 04:48:58,775 Current rsum is 532.04
2021-06-16 04:49:00,266 runs/coco_butd_region_bert/log
2021-06-16 04:49:00,266 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 04:49:00,268 image encoder trainable parameters: 20490144
2021-06-16 04:49:00,274 txt encoder trainable parameters: 137319072
2021-06-16 04:54:11,024 Epoch: [9][174/4426]	Eit 40000  lr 0.0005  Le 9.8693 (9.8702)	Time 1.397 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:00:00,257 Epoch: [9][374/4426]	Eit 40200  lr 0.0005  Le 9.8768 (9.8709)	Time 1.865 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:05:48,164 Epoch: [9][574/4426]	Eit 40400  lr 0.0005  Le 9.8768 (9.8706)	Time 1.733 (0.000)	Data 0.005 (0.000)	
2021-06-16 05:11:36,661 Epoch: [9][774/4426]	Eit 40600  lr 0.0005  Le 9.8757 (9.8709)	Time 1.984 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:17:21,022 Epoch: [9][974/4426]	Eit 40800  lr 0.0005  Le 9.8422 (9.8711)	Time 0.784 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:22:55,783 Epoch: [9][1174/4426]	Eit 41000  lr 0.0005  Le 9.8754 (9.8713)	Time 1.665 (0.000)	Data 0.003 (0.000)	
2021-06-16 05:28:45,834 Epoch: [9][1374/4426]	Eit 41200  lr 0.0005  Le 9.8844 (9.8712)	Time 1.636 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:34:37,315 Epoch: [9][1574/4426]	Eit 41400  lr 0.0005  Le 9.8590 (9.8712)	Time 1.630 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:40:26,779 Epoch: [9][1774/4426]	Eit 41600  lr 0.0005  Le 9.8608 (9.8711)	Time 2.081 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:46:18,183 Epoch: [9][1974/4426]	Eit 41800  lr 0.0005  Le 9.8705 (9.8712)	Time 1.688 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:52:07,338 Epoch: [9][2174/4426]	Eit 42000  lr 0.0005  Le 9.8746 (9.8713)	Time 1.812 (0.000)	Data 0.002 (0.000)	
2021-06-16 05:57:58,435 Epoch: [9][2374/4426]	Eit 42200  lr 0.0005  Le 9.8665 (9.8711)	Time 1.628 (0.000)	Data 0.002 (0.000)	
2021-06-16 06:03:48,666 Epoch: [9][2574/4426]	Eit 42400  lr 0.0005  Le 9.8784 (9.8711)	Time 1.553 (0.000)	Data 0.002 (0.000)	
2021-06-16 06:09:40,309 Epoch: [9][2774/4426]	Eit 42600  lr 0.0005  Le 9.8621 (9.8711)	Time 1.567 (0.000)	Data 0.002 (0.000)	
2021-06-16 06:15:30,060 Epoch: [9][2974/4426]	Eit 42800  lr 0.0005  Le 9.8899 (9.8714)	Time 1.515 (0.000)	Data 0.002 (0.000)	
2021-06-16 06:21:18,433 Epoch: [9][3174/4426]	Eit 43000  lr 0.0005  Le 9.8577 (9.8715)	Time 1.990 (0.000)	Data 0.003 (0.000)	
2021-06-16 06:27:02,981 Epoch: [9][3374/4426]	Eit 43200  lr 0.0005  Le 9.8558 (9.8716)	Time 1.931 (0.000)	Data 0.003 (0.000)	
2021-06-16 06:32:28,196 Epoch: [9][3574/4426]	Eit 43400  lr 0.0005  Le 9.9122 (9.8717)	Time 1.868 (0.000)	Data 0.002 (0.000)	
2021-06-16 06:38:19,114 Epoch: [9][3774/4426]	Eit 43600  lr 0.0005  Le 9.8671 (9.8717)	Time 1.758 (0.000)	Data 0.002 (0.000)	
2021-06-16 06:44:10,075 Epoch: [9][3974/4426]	Eit 43800  lr 0.0005  Le 9.8707 (9.8718)	Time 1.741 (0.000)	Data 0.003 (0.000)	
2021-06-16 06:49:59,390 Epoch: [9][4174/4426]	Eit 44000  lr 0.0005  Le 9.8594 (9.8718)	Time 1.879 (0.000)	Data 0.003 (0.000)	
2021-06-16 06:55:49,048 Epoch: [9][4374/4426]	Eit 44200  lr 0.0005  Le 9.8559 (9.8719)	Time 1.858 (0.000)	Data 0.012 (0.000)	
2021-06-16 06:57:25,327 Test: [0/40]	Le 10.1887 (10.1887)	Time 8.442 (0.000)	
2021-06-16 06:57:53,693 calculate similarity time: 0.06110334396362305
2021-06-16 06:57:54,210 Image to text: 81.9, 97.1, 99.4, 1.0, 2.0
2021-06-16 06:57:54,545 Text to image: 67.0, 92.8, 97.1, 1.0, 3.5
2021-06-16 06:57:54,545 Current rsum is 535.26
2021-06-16 06:57:58,285 runs/coco_butd_region_bert/log
2021-06-16 06:57:58,286 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 06:57:58,290 image encoder trainable parameters: 20490144
2021-06-16 06:57:58,302 txt encoder trainable parameters: 137319072
2021-06-16 07:02:28,769 Epoch: [10][149/4426]	Eit 44400  lr 0.0005  Le 9.8757 (9.8679)	Time 1.376 (0.000)	Data 0.003 (0.000)	
2021-06-16 07:08:20,100 Epoch: [10][349/4426]	Eit 44600  lr 0.0005  Le 9.8675 (9.8677)	Time 1.980 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:14:10,999 Epoch: [10][549/4426]	Eit 44800  lr 0.0005  Le 9.8588 (9.8673)	Time 1.690 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:19:58,159 Epoch: [10][749/4426]	Eit 45000  lr 0.0005  Le 9.8877 (9.8671)	Time 2.112 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:25:46,428 Epoch: [10][949/4426]	Eit 45200  lr 0.0005  Le 9.8364 (9.8670)	Time 1.609 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:31:36,008 Epoch: [10][1149/4426]	Eit 45400  lr 0.0005  Le 9.8599 (9.8670)	Time 1.805 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:37:21,330 Epoch: [10][1349/4426]	Eit 45600  lr 0.0005  Le 9.8614 (9.8672)	Time 1.879 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:43:04,413 Epoch: [10][1549/4426]	Eit 45800  lr 0.0005  Le 9.8680 (9.8672)	Time 0.711 (0.000)	Data 0.002 (0.000)	
2021-06-16 07:48:35,640 Epoch: [10][1749/4426]	Eit 46000  lr 0.0005  Le 9.8772 (9.8668)	Time 1.836 (0.000)	Data 0.003 (0.000)	
2021-06-16 07:54:31,512 Epoch: [10][1949/4426]	Eit 46200  lr 0.0005  Le 9.8589 (9.8673)	Time 1.545 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:00:23,093 Epoch: [10][2149/4426]	Eit 46400  lr 0.0005  Le 9.8901 (9.8674)	Time 1.704 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:06:12,877 Epoch: [10][2349/4426]	Eit 46600  lr 0.0005  Le 9.8516 (9.8675)	Time 1.548 (0.000)	Data 0.012 (0.000)	
2021-06-16 08:12:05,243 Epoch: [10][2549/4426]	Eit 46800  lr 0.0005  Le 9.8579 (9.8675)	Time 1.647 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:17:52,888 Epoch: [10][2749/4426]	Eit 47000  lr 0.0005  Le 9.8774 (9.8677)	Time 1.460 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:23:41,223 Epoch: [10][2949/4426]	Eit 47200  lr 0.0005  Le 9.8730 (9.8677)	Time 1.773 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:29:32,166 Epoch: [10][3149/4426]	Eit 47400  lr 0.0005  Le 9.8502 (9.8678)	Time 1.460 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:35:20,519 Epoch: [10][3349/4426]	Eit 47600  lr 0.0005  Le 9.8548 (9.8679)	Time 2.115 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:41:10,238 Epoch: [10][3549/4426]	Eit 47800  lr 0.0005  Le 9.8496 (9.8680)	Time 1.882 (0.000)	Data 0.002 (0.000)	
2021-06-16 08:46:56,653 Epoch: [10][3749/4426]	Eit 48000  lr 0.0005  Le 9.9045 (9.8682)	Time 1.792 (0.000)	Data 0.004 (0.000)	
2021-06-16 08:52:48,059 Epoch: [10][3949/4426]	Eit 48200  lr 0.0005  Le 9.8851 (9.8682)	Time 1.573 (0.000)	Data 0.010 (0.000)	
2021-06-16 08:58:16,294 Epoch: [10][4149/4426]	Eit 48400  lr 0.0005  Le 9.8868 (9.8683)	Time 1.887 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:04:07,394 Epoch: [10][4349/4426]	Eit 48600  lr 0.0005  Le 9.8683 (9.8682)	Time 1.849 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:06:29,671 Test: [0/40]	Le 10.1853 (10.1853)	Time 8.516 (0.000)	
2021-06-16 09:06:57,284 calculate similarity time: 0.06732463836669922
2021-06-16 09:06:57,830 Image to text: 79.7, 97.6, 99.2, 1.0, 1.9
2021-06-16 09:06:58,139 Text to image: 66.8, 92.4, 96.9, 1.0, 3.3
2021-06-16 09:06:58,139 Current rsum is 532.66
2021-06-16 09:06:59,666 runs/coco_butd_region_bert/log
2021-06-16 09:06:59,666 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 09:06:59,667 image encoder trainable parameters: 20490144
2021-06-16 09:06:59,673 txt encoder trainable parameters: 137319072
2021-06-16 09:10:46,061 Epoch: [11][124/4426]	Eit 48800  lr 0.0005  Le 9.8762 (9.8614)	Time 1.797 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:16:36,101 Epoch: [11][324/4426]	Eit 49000  lr 0.0005  Le 9.8789 (9.8619)	Time 1.688 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:22:25,247 Epoch: [11][524/4426]	Eit 49200  lr 0.0005  Le 9.8596 (9.8629)	Time 1.838 (0.000)	Data 0.008 (0.000)	
2021-06-16 09:28:16,694 Epoch: [11][724/4426]	Eit 49400  lr 0.0005  Le 9.8890 (9.8633)	Time 1.534 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:34:03,938 Epoch: [11][924/4426]	Eit 49600  lr 0.0005  Le 9.8896 (9.8630)	Time 1.665 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:39:53,566 Epoch: [11][1124/4426]	Eit 49800  lr 0.0005  Le 9.8706 (9.8629)	Time 1.726 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:45:44,647 Epoch: [11][1324/4426]	Eit 50000  lr 0.0005  Le 9.8634 (9.8633)	Time 2.034 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:51:35,920 Epoch: [11][1524/4426]	Eit 50200  lr 0.0005  Le 9.8191 (9.8633)	Time 1.709 (0.000)	Data 0.002 (0.000)	
2021-06-16 09:57:29,656 Epoch: [11][1724/4426]	Eit 50400  lr 0.0005  Le 9.8688 (9.8631)	Time 1.829 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:03:15,294 Epoch: [11][1924/4426]	Eit 50600  lr 0.0005  Le 9.9217 (9.8633)	Time 1.814 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:08:56,155 Epoch: [11][2124/4426]	Eit 50800  lr 0.0005  Le 9.8411 (9.8635)	Time 1.535 (0.000)	Data 0.003 (0.000)	
2021-06-16 10:14:28,733 Epoch: [11][2324/4426]	Eit 51000  lr 0.0005  Le 9.9030 (9.8637)	Time 1.777 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:20:19,133 Epoch: [11][2524/4426]	Eit 51200  lr 0.0005  Le 9.8739 (9.8638)	Time 1.680 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:26:04,479 Epoch: [11][2724/4426]	Eit 51400  lr 0.0005  Le 9.8562 (9.8636)	Time 1.856 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:31:52,810 Epoch: [11][2924/4426]	Eit 51600  lr 0.0005  Le 9.8689 (9.8639)	Time 1.979 (0.000)	Data 0.003 (0.000)	
2021-06-16 10:37:43,319 Epoch: [11][3124/4426]	Eit 51800  lr 0.0005  Le 9.8958 (9.8640)	Time 1.748 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:43:34,494 Epoch: [11][3324/4426]	Eit 52000  lr 0.0005  Le 9.8734 (9.8639)	Time 1.848 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:49:26,320 Epoch: [11][3524/4426]	Eit 52200  lr 0.0005  Le 9.8651 (9.8640)	Time 1.632 (0.000)	Data 0.002 (0.000)	
2021-06-16 10:55:16,873 Epoch: [11][3724/4426]	Eit 52400  lr 0.0005  Le 9.8676 (9.8641)	Time 1.927 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:01:05,674 Epoch: [11][3924/4426]	Eit 52600  lr 0.0005  Le 9.8317 (9.8643)	Time 1.741 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:06:51,197 Epoch: [11][4124/4426]	Eit 52800  lr 0.0005  Le 9.8744 (9.8643)	Time 1.812 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:12:40,722 Epoch: [11][4324/4426]	Eit 53000  lr 0.0005  Le 9.9006 (9.8644)	Time 1.765 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:15:46,731 Test: [0/40]	Le 10.1897 (10.1897)	Time 8.484 (0.000)	
2021-06-16 11:16:14,979 calculate similarity time: 0.07434606552124023
2021-06-16 11:16:15,532 Image to text: 82.3, 97.7, 99.5, 1.0, 2.1
2021-06-16 11:16:15,844 Text to image: 66.7, 92.7, 97.2, 1.0, 3.7
2021-06-16 11:16:15,844 Current rsum is 536.12
2021-06-16 11:16:19,488 runs/coco_butd_region_bert/log
2021-06-16 11:16:19,489 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 11:16:19,491 image encoder trainable parameters: 20490144
2021-06-16 11:16:19,499 txt encoder trainable parameters: 137319072
2021-06-16 11:19:18,033 Epoch: [12][99/4426]	Eit 53200  lr 0.0005  Le 9.8496 (9.8596)	Time 1.548 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:24:42,642 Epoch: [12][299/4426]	Eit 53400  lr 0.0005  Le 9.8361 (9.8592)	Time 1.517 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:30:30,748 Epoch: [12][499/4426]	Eit 53600  lr 0.0005  Le 9.8648 (9.8600)	Time 1.438 (0.000)	Data 0.003 (0.000)	
2021-06-16 11:36:23,945 Epoch: [12][699/4426]	Eit 53800  lr 0.0005  Le 9.8576 (9.8599)	Time 1.663 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:42:12,251 Epoch: [12][899/4426]	Eit 54000  lr 0.0005  Le 9.8927 (9.8598)	Time 1.980 (0.000)	Data 0.005 (0.000)	
2021-06-16 11:48:05,305 Epoch: [12][1099/4426]	Eit 54200  lr 0.0005  Le 9.8876 (9.8599)	Time 1.593 (0.000)	Data 0.002 (0.000)	
2021-06-16 11:53:57,400 Epoch: [12][1299/4426]	Eit 54400  lr 0.0005  Le 9.8691 (9.8599)	Time 1.582 (0.000)	Data 0.003 (0.000)	
2021-06-16 11:59:46,283 Epoch: [12][1499/4426]	Eit 54600  lr 0.0005  Le 9.8523 (9.8602)	Time 1.876 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:05:35,263 Epoch: [12][1699/4426]	Eit 54800  lr 0.0005  Le 9.8719 (9.8602)	Time 1.757 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:11:26,316 Epoch: [12][1899/4426]	Eit 55000  lr 0.0005  Le 9.8762 (9.8603)	Time 1.676 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:17:15,665 Epoch: [12][2099/4426]	Eit 55200  lr 0.0005  Le 9.8511 (9.8604)	Time 1.610 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:23:04,379 Epoch: [12][2299/4426]	Eit 55400  lr 0.0005  Le 9.8366 (9.8607)	Time 2.182 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:28:56,147 Epoch: [12][2499/4426]	Eit 55600  lr 0.0005  Le 9.8206 (9.8608)	Time 1.918 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:34:37,907 Epoch: [12][2699/4426]	Eit 55800  lr 0.0005  Le 9.8669 (9.8608)	Time 0.802 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:40:10,238 Epoch: [12][2899/4426]	Eit 56000  lr 0.0005  Le 9.8404 (9.8610)	Time 1.463 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:46:00,000 Epoch: [12][3099/4426]	Eit 56200  lr 0.0005  Le 9.8566 (9.8609)	Time 1.774 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:51:48,136 Epoch: [12][3299/4426]	Eit 56400  lr 0.0005  Le 9.8595 (9.8611)	Time 1.790 (0.000)	Data 0.002 (0.000)	
2021-06-16 12:57:35,254 Epoch: [12][3499/4426]	Eit 56600  lr 0.0005  Le 9.8270 (9.8611)	Time 1.865 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:03:25,526 Epoch: [12][3699/4426]	Eit 56800  lr 0.0005  Le 9.8717 (9.8611)	Time 1.749 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:09:16,480 Epoch: [12][3899/4426]	Eit 57000  lr 0.0005  Le 9.8505 (9.8612)	Time 1.851 (0.000)	Data 0.003 (0.000)	
2021-06-16 13:15:03,081 Epoch: [12][4099/4426]	Eit 57200  lr 0.0005  Le 9.8741 (9.8612)	Time 1.830 (0.000)	Data 0.003 (0.000)	
2021-06-16 13:20:50,810 Epoch: [12][4299/4426]	Eit 57400  lr 0.0005  Le 9.8570 (9.8613)	Time 1.807 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:24:40,589 Test: [0/40]	Le 10.1868 (10.1868)	Time 8.227 (0.000)	
2021-06-16 13:25:08,580 calculate similarity time: 0.05715346336364746
2021-06-16 13:25:08,995 Image to text: 82.2, 97.0, 99.4, 1.0, 1.9
2021-06-16 13:25:09,440 Text to image: 67.5, 92.4, 96.9, 1.0, 3.5
2021-06-16 13:25:09,440 Current rsum is 535.4200000000001
2021-06-16 13:25:11,011 runs/coco_butd_region_bert/log
2021-06-16 13:25:11,011 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 13:25:11,013 image encoder trainable parameters: 20490144
2021-06-16 13:25:11,019 txt encoder trainable parameters: 137319072
2021-06-16 13:27:28,527 Epoch: [13][74/4426]	Eit 57600  lr 0.0005  Le 9.8668 (9.8544)	Time 1.945 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:33:17,323 Epoch: [13][274/4426]	Eit 57800  lr 0.0005  Le 9.8914 (9.8556)	Time 1.515 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:39:06,555 Epoch: [13][474/4426]	Eit 58000  lr 0.0005  Le 9.8750 (9.8558)	Time 2.000 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:44:57,519 Epoch: [13][674/4426]	Eit 58200  lr 0.0005  Le 9.8133 (9.8559)	Time 1.432 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:50:24,058 Epoch: [13][874/4426]	Eit 58400  lr 0.0005  Le 9.8699 (9.8562)	Time 1.786 (0.000)	Data 0.002 (0.000)	
2021-06-16 13:56:10,625 Epoch: [13][1074/4426]	Eit 58600  lr 0.0005  Le 9.8343 (9.8568)	Time 1.930 (0.000)	Data 0.003 (0.000)	
2021-06-16 14:01:56,313 Epoch: [13][1274/4426]	Eit 58800  lr 0.0005  Le 9.8599 (9.8573)	Time 1.573 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:07:46,009 Epoch: [13][1474/4426]	Eit 59000  lr 0.0005  Le 9.8526 (9.8571)	Time 1.838 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:13:33,758 Epoch: [13][1674/4426]	Eit 59200  lr 0.0005  Le 9.8469 (9.8571)	Time 1.568 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:19:23,996 Epoch: [13][1874/4426]	Eit 59400  lr 0.0005  Le 9.8808 (9.8570)	Time 1.740 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:25:14,337 Epoch: [13][2074/4426]	Eit 59600  lr 0.0005  Le 9.8750 (9.8571)	Time 1.706 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:31:02,877 Epoch: [13][2274/4426]	Eit 59800  lr 0.0005  Le 9.8895 (9.8573)	Time 1.792 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:36:49,796 Epoch: [13][2474/4426]	Eit 60000  lr 0.0005  Le 9.8333 (9.8573)	Time 2.042 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:42:38,602 Epoch: [13][2674/4426]	Eit 60200  lr 0.0005  Le 9.8670 (9.8576)	Time 1.856 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:48:27,367 Epoch: [13][2874/4426]	Eit 60400  lr 0.0005  Le 9.8542 (9.8577)	Time 1.727 (0.000)	Data 0.002 (0.000)	
2021-06-16 14:54:14,684 Epoch: [13][3074/4426]	Eit 60600  lr 0.0005  Le 9.8630 (9.8579)	Time 1.686 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:00:03,598 Epoch: [13][3274/4426]	Eit 60800  lr 0.0005  Le 9.8621 (9.8581)	Time 1.951 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:05:29,261 Epoch: [13][3474/4426]	Eit 61000  lr 0.0005  Le 9.8371 (9.8582)	Time 1.848 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:11:20,213 Epoch: [13][3674/4426]	Eit 61200  lr 0.0005  Le 9.8792 (9.8583)	Time 1.369 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:17:09,329 Epoch: [13][3874/4426]	Eit 61400  lr 0.0005  Le 9.8831 (9.8584)	Time 1.614 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:22:59,906 Epoch: [13][4074/4426]	Eit 61600  lr 0.0005  Le 9.8633 (9.8584)	Time 1.538 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:28:47,915 Epoch: [13][4274/4426]	Eit 61800  lr 0.0005  Le 9.8556 (9.8585)	Time 2.139 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:33:17,678 Test: [0/40]	Le 10.1937 (10.1937)	Time 8.564 (0.000)	
2021-06-16 15:33:45,374 calculate similarity time: 0.06613874435424805
2021-06-16 15:33:45,889 Image to text: 81.2, 96.7, 99.3, 1.0, 2.4
2021-06-16 15:33:46,228 Text to image: 67.1, 92.6, 96.9, 1.0, 3.8
2021-06-16 15:33:46,228 Current rsum is 533.6999999999999
2021-06-16 15:33:47,713 runs/coco_butd_region_bert/log
2021-06-16 15:33:47,713 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 15:33:47,715 image encoder trainable parameters: 20490144
2021-06-16 15:33:47,721 txt encoder trainable parameters: 137319072
2021-06-16 15:35:21,977 Epoch: [14][49/4426]	Eit 62000  lr 0.0005  Le 9.8542 (9.8513)	Time 1.826 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:41:09,008 Epoch: [14][249/4426]	Eit 62200  lr 0.0005  Le 9.8857 (9.8532)	Time 1.790 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:46:55,185 Epoch: [14][449/4426]	Eit 62400  lr 0.0005  Le 9.8572 (9.8527)	Time 1.523 (0.000)	Data 0.003 (0.000)	
2021-06-16 15:52:46,758 Epoch: [14][649/4426]	Eit 62600  lr 0.0005  Le 9.8350 (9.8518)	Time 1.828 (0.000)	Data 0.002 (0.000)	
2021-06-16 15:58:30,472 Epoch: [14][849/4426]	Eit 62800  lr 0.0005  Le 9.8607 (9.8523)	Time 1.987 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:04:20,164 Epoch: [14][1049/4426]	Eit 63000  lr 0.0005  Le 9.8514 (9.8525)	Time 1.999 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:10:09,142 Epoch: [14][1249/4426]	Eit 63200  lr 0.0005  Le 9.8379 (9.8528)	Time 1.656 (0.000)	Data 0.003 (0.000)	
2021-06-16 16:14:50,385 Epoch: [14][1449/4426]	Eit 63400  lr 0.0005  Le 9.8726 (9.8532)	Time 0.773 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:17:30,547 Epoch: [14][1649/4426]	Eit 63600  lr 0.0005  Le 9.8955 (9.8531)	Time 0.785 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:20:10,617 Epoch: [14][1849/4426]	Eit 63800  lr 0.0005  Le 9.8503 (9.8534)	Time 0.947 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:22:49,567 Epoch: [14][2049/4426]	Eit 64000  lr 0.0005  Le 9.8749 (9.8535)	Time 0.768 (0.000)	Data 0.003 (0.000)	
2021-06-16 16:25:29,672 Epoch: [14][2249/4426]	Eit 64200  lr 0.0005  Le 9.8569 (9.8537)	Time 0.822 (0.000)	Data 0.003 (0.000)	
2021-06-16 16:28:09,781 Epoch: [14][2449/4426]	Eit 64400  lr 0.0005  Le 9.8953 (9.8539)	Time 0.772 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:30:50,179 Epoch: [14][2649/4426]	Eit 64600  lr 0.0005  Le 9.8577 (9.8539)	Time 0.835 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:33:31,871 Epoch: [14][2849/4426]	Eit 64800  lr 0.0005  Le 9.8557 (9.8541)	Time 0.835 (0.000)	Data 0.003 (0.000)	
2021-06-16 16:36:09,887 Epoch: [14][3049/4426]	Eit 65000  lr 0.0005  Le 9.8505 (9.8543)	Time 0.747 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:38:49,998 Epoch: [14][3249/4426]	Eit 65200  lr 0.0005  Le 9.9083 (9.8544)	Time 0.774 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:41:29,692 Epoch: [14][3449/4426]	Eit 65400  lr 0.0005  Le 9.8285 (9.8545)	Time 0.760 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:44:10,914 Epoch: [14][3649/4426]	Eit 65600  lr 0.0005  Le 9.8214 (9.8545)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:46:48,490 Epoch: [14][3849/4426]	Eit 65800  lr 0.0005  Le 9.8787 (9.8547)	Time 0.761 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:49:29,203 Epoch: [14][4049/4426]	Eit 66000  lr 0.0005  Le 9.8563 (9.8548)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:52:09,542 Epoch: [14][4249/4426]	Eit 66200  lr 0.0005  Le 9.8667 (9.8549)	Time 0.870 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:54:37,972 Test: [0/40]	Le 10.1954 (10.1954)	Time 8.456 (0.000)	
2021-06-16 16:54:51,991 calculate similarity time: 0.055200815200805664
2021-06-16 16:54:52,501 Image to text: 81.9, 97.1, 99.6, 1.0, 2.0
2021-06-16 16:54:52,821 Text to image: 67.2, 92.8, 96.9, 1.0, 3.6
2021-06-16 16:54:52,821 Current rsum is 535.46
2021-06-16 16:54:54,248 runs/coco_butd_region_bert/log
2021-06-16 16:54:54,248 runs/coco_butd_region_bert
2021-06-16 16:54:54,248 Current epoch num is 15, decrease all lr by 10
2021-06-16 16:54:54,248 new lr 5e-05
2021-06-16 16:54:54,248 new lr 5e-06
2021-06-16 16:54:54,248 new lr 5e-05
Use VSE++ objective.
2021-06-16 16:54:54,250 image encoder trainable parameters: 20490144
2021-06-16 16:54:54,255 txt encoder trainable parameters: 137319072
2021-06-16 16:55:21,824 Epoch: [15][24/4426]	Eit 66400  lr 5e-05  Le 9.8676 (9.8448)	Time 0.752 (0.000)	Data 0.002 (0.000)	
2021-06-16 16:58:02,305 Epoch: [15][224/4426]	Eit 66600  lr 5e-05  Le 9.8626 (9.8483)	Time 0.737 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:00:42,707 Epoch: [15][424/4426]	Eit 66800  lr 5e-05  Le 9.8708 (9.8470)	Time 0.770 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:03:19,799 Epoch: [15][624/4426]	Eit 67000  lr 5e-05  Le 9.8488 (9.8460)	Time 0.812 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:06:00,777 Epoch: [15][824/4426]	Eit 67200  lr 5e-05  Le 9.8442 (9.8454)	Time 0.808 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:08:40,322 Epoch: [15][1024/4426]	Eit 67400  lr 5e-05  Le 9.8539 (9.8450)	Time 0.801 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:11:18,720 Epoch: [15][1224/4426]	Eit 67600  lr 5e-05  Le 9.8524 (9.8444)	Time 0.794 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:13:58,435 Epoch: [15][1424/4426]	Eit 67800  lr 5e-05  Le 9.8411 (9.8442)	Time 0.811 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:16:39,005 Epoch: [15][1624/4426]	Eit 68000  lr 5e-05  Le 9.8540 (9.8440)	Time 0.780 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:19:19,705 Epoch: [15][1824/4426]	Eit 68200  lr 5e-05  Le 9.8539 (9.8435)	Time 0.764 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:22:00,879 Epoch: [15][2024/4426]	Eit 68400  lr 5e-05  Le 9.8284 (9.8433)	Time 0.924 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:24:40,170 Epoch: [15][2224/4426]	Eit 68600  lr 5e-05  Le 9.8650 (9.8431)	Time 0.720 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:27:21,173 Epoch: [15][2424/4426]	Eit 68800  lr 5e-05  Le 9.8584 (9.8427)	Time 0.774 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:29:59,805 Epoch: [15][2624/4426]	Eit 69000  lr 5e-05  Le 9.8292 (9.8425)	Time 0.785 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:32:39,038 Epoch: [15][2824/4426]	Eit 69200  lr 5e-05  Le 9.8354 (9.8424)	Time 0.820 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:35:18,737 Epoch: [15][3024/4426]	Eit 69400  lr 5e-05  Le 9.8232 (9.8423)	Time 0.813 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:37:57,443 Epoch: [15][3224/4426]	Eit 69600  lr 5e-05  Le 9.8292 (9.8422)	Time 0.752 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:40:39,051 Epoch: [15][3424/4426]	Eit 69800  lr 5e-05  Le 9.8297 (9.8421)	Time 0.839 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:43:19,421 Epoch: [15][3624/4426]	Eit 70000  lr 5e-05  Le 9.8281 (9.8419)	Time 0.773 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:45:59,773 Epoch: [15][3824/4426]	Eit 70200  lr 5e-05  Le 9.8524 (9.8417)	Time 0.719 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:48:38,372 Epoch: [15][4024/4426]	Eit 70400  lr 5e-05  Le 9.8352 (9.8417)	Time 0.795 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:51:19,205 Epoch: [15][4224/4426]	Eit 70600  lr 5e-05  Le 9.8531 (9.8415)	Time 0.861 (0.000)	Data 0.014 (0.000)	
2021-06-16 17:54:00,756 Epoch: [15][4424/4426]	Eit 70800  lr 5e-05  Le 9.8446 (9.8414)	Time 0.751 (0.000)	Data 0.002 (0.000)	
2021-06-16 17:54:10,804 Test: [0/40]	Le 10.1952 (10.1952)	Time 8.766 (0.000)	
2021-06-16 17:54:24,389 calculate similarity time: 0.05027318000793457
2021-06-16 17:54:24,780 Image to text: 82.8, 98.2, 99.6, 1.0, 1.9
2021-06-16 17:54:25,092 Text to image: 68.5, 93.0, 97.0, 1.0, 3.5
2021-06-16 17:54:25,093 Current rsum is 539.02
2021-06-16 17:54:28,643 runs/coco_butd_region_bert/log
2021-06-16 17:54:28,643 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 17:54:28,647 image encoder trainable parameters: 20490144
2021-06-16 17:54:28,659 txt encoder trainable parameters: 137319072
2021-06-16 17:57:17,799 Epoch: [16][199/4426]	Eit 71000  lr 5e-05  Le 9.8711 (9.8387)	Time 0.843 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:00:00,633 Epoch: [16][399/4426]	Eit 71200  lr 5e-05  Le 9.8331 (9.8387)	Time 0.811 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:02:38,742 Epoch: [16][599/4426]	Eit 71400  lr 5e-05  Le 9.8515 (9.8380)	Time 0.719 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:05:17,811 Epoch: [16][799/4426]	Eit 71600  lr 5e-05  Le 9.8518 (9.8376)	Time 0.757 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:07:57,116 Epoch: [16][999/4426]	Eit 71800  lr 5e-05  Le 9.8394 (9.8375)	Time 0.884 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:10:36,383 Epoch: [16][1199/4426]	Eit 72000  lr 5e-05  Le 9.8344 (9.8373)	Time 0.744 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:13:16,630 Epoch: [16][1399/4426]	Eit 72200  lr 5e-05  Le 9.8198 (9.8369)	Time 0.778 (0.000)	Data 0.003 (0.000)	
2021-06-16 18:15:57,137 Epoch: [16][1599/4426]	Eit 72400  lr 5e-05  Le 9.8701 (9.8369)	Time 0.813 (0.000)	Data 0.003 (0.000)	
2021-06-16 18:18:35,830 Epoch: [16][1799/4426]	Eit 72600  lr 5e-05  Le 9.8358 (9.8369)	Time 0.754 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:21:16,040 Epoch: [16][1999/4426]	Eit 72800  lr 5e-05  Le 9.8096 (9.8369)	Time 0.780 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:23:55,087 Epoch: [16][2199/4426]	Eit 73000  lr 5e-05  Le 9.8512 (9.8370)	Time 0.790 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:26:34,985 Epoch: [16][2399/4426]	Eit 73200  lr 5e-05  Le 9.8463 (9.8369)	Time 0.813 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:29:14,959 Epoch: [16][2599/4426]	Eit 73400  lr 5e-05  Le 9.8713 (9.8367)	Time 0.818 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:31:54,569 Epoch: [16][2799/4426]	Eit 73600  lr 5e-05  Le 9.8490 (9.8366)	Time 0.763 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:34:35,704 Epoch: [16][2999/4426]	Eit 73800  lr 5e-05  Le 9.8210 (9.8366)	Time 0.756 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:37:15,071 Epoch: [16][3199/4426]	Eit 74000  lr 5e-05  Le 9.8523 (9.8367)	Time 0.901 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:39:54,615 Epoch: [16][3399/4426]	Eit 74200  lr 5e-05  Le 9.8358 (9.8366)	Time 0.764 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:42:35,599 Epoch: [16][3599/4426]	Eit 74400  lr 5e-05  Le 9.8340 (9.8366)	Time 0.796 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:45:16,788 Epoch: [16][3799/4426]	Eit 74600  lr 5e-05  Le 9.8115 (9.8365)	Time 0.771 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:47:56,610 Epoch: [16][3999/4426]	Eit 74800  lr 5e-05  Le 9.8343 (9.8364)	Time 0.753 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:50:36,728 Epoch: [16][4199/4426]	Eit 75000  lr 5e-05  Le 9.8345 (9.8364)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:53:17,670 Epoch: [16][4399/4426]	Eit 75200  lr 5e-05  Le 9.8232 (9.8364)	Time 0.764 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:53:47,889 Test: [0/40]	Le 10.1941 (10.1941)	Time 9.328 (0.000)	
2021-06-16 18:54:01,718 calculate similarity time: 0.04847359657287598
2021-06-16 18:54:02,230 Image to text: 82.7, 97.8, 99.5, 1.0, 1.9
2021-06-16 18:54:02,569 Text to image: 68.6, 93.1, 96.9, 1.0, 3.6
2021-06-16 18:54:02,569 Current rsum is 538.58
2021-06-16 18:54:04,034 runs/coco_butd_region_bert/log
2021-06-16 18:54:04,034 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 18:54:04,036 image encoder trainable parameters: 20490144
2021-06-16 18:54:04,041 txt encoder trainable parameters: 137319072
2021-06-16 18:56:32,371 Epoch: [17][174/4426]	Eit 75400  lr 5e-05  Le 9.8681 (9.8346)	Time 0.750 (0.000)	Data 0.002 (0.000)	
2021-06-16 18:59:11,962 Epoch: [17][374/4426]	Eit 75600  lr 5e-05  Le 9.8586 (9.8339)	Time 0.815 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:01:50,920 Epoch: [17][574/4426]	Eit 75800  lr 5e-05  Le 9.8545 (9.8346)	Time 0.784 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:04:30,724 Epoch: [17][774/4426]	Eit 76000  lr 5e-05  Le 9.8502 (9.8338)	Time 0.763 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:07:09,820 Epoch: [17][974/4426]	Eit 76200  lr 5e-05  Le 9.8437 (9.8339)	Time 0.749 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:09:49,373 Epoch: [17][1174/4426]	Eit 76400  lr 5e-05  Le 9.8615 (9.8338)	Time 0.748 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:12:28,044 Epoch: [17][1374/4426]	Eit 76600  lr 5e-05  Le 9.8627 (9.8339)	Time 0.756 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:15:07,181 Epoch: [17][1574/4426]	Eit 76800  lr 5e-05  Le 9.8640 (9.8340)	Time 0.776 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:17:49,474 Epoch: [17][1774/4426]	Eit 77000  lr 5e-05  Le 9.8158 (9.8341)	Time 0.805 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:20:29,791 Epoch: [17][1974/4426]	Eit 77200  lr 5e-05  Le 9.8499 (9.8341)	Time 0.775 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:23:10,108 Epoch: [17][2174/4426]	Eit 77400  lr 5e-05  Le 9.8464 (9.8340)	Time 0.723 (0.000)	Data 0.003 (0.000)	
2021-06-16 19:25:49,601 Epoch: [17][2374/4426]	Eit 77600  lr 5e-05  Le 9.8328 (9.8339)	Time 0.785 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:28:31,267 Epoch: [17][2574/4426]	Eit 77800  lr 5e-05  Le 9.8258 (9.8340)	Time 0.741 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:31:12,161 Epoch: [17][2774/4426]	Eit 78000  lr 5e-05  Le 9.8155 (9.8340)	Time 0.833 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:33:52,193 Epoch: [17][2974/4426]	Eit 78200  lr 5e-05  Le 9.8293 (9.8340)	Time 0.838 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:36:31,680 Epoch: [17][3174/4426]	Eit 78400  lr 5e-05  Le 9.8440 (9.8341)	Time 0.714 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:39:10,560 Epoch: [17][3374/4426]	Eit 78600  lr 5e-05  Le 9.8501 (9.8340)	Time 0.815 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:41:50,100 Epoch: [17][3574/4426]	Eit 78800  lr 5e-05  Le 9.8296 (9.8341)	Time 0.822 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:44:31,372 Epoch: [17][3774/4426]	Eit 79000  lr 5e-05  Le 9.8508 (9.8341)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:47:11,946 Epoch: [17][3974/4426]	Eit 79200  lr 5e-05  Le 9.8280 (9.8340)	Time 0.764 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:49:52,145 Epoch: [17][4174/4426]	Eit 79400  lr 5e-05  Le 9.8230 (9.8340)	Time 0.811 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:52:31,732 Epoch: [17][4374/4426]	Eit 79600  lr 5e-05  Le 9.8095 (9.8339)	Time 0.755 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:53:23,071 Test: [0/40]	Le 10.1939 (10.1939)	Time 8.895 (0.000)	
2021-06-16 19:53:36,961 calculate similarity time: 0.07541298866271973
2021-06-16 19:53:37,489 Image to text: 83.1, 98.0, 99.5, 1.0, 2.1
2021-06-16 19:53:37,924 Text to image: 68.9, 92.9, 97.0, 1.0, 3.7
2021-06-16 19:53:37,924 Current rsum is 539.36
2021-06-16 19:53:41,535 runs/coco_butd_region_bert/log
2021-06-16 19:53:41,535 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 19:53:41,539 image encoder trainable parameters: 20490144
2021-06-16 19:53:41,551 txt encoder trainable parameters: 137319072
2021-06-16 19:55:49,241 Epoch: [18][149/4426]	Eit 79800  lr 5e-05  Le 9.8262 (9.8321)	Time 0.831 (0.000)	Data 0.002 (0.000)	
2021-06-16 19:58:28,983 Epoch: [18][349/4426]	Eit 80000  lr 5e-05  Le 9.8106 (9.8314)	Time 0.741 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:01:09,606 Epoch: [18][549/4426]	Eit 80200  lr 5e-05  Le 9.8331 (9.8321)	Time 0.783 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:03:50,388 Epoch: [18][749/4426]	Eit 80400  lr 5e-05  Le 9.8429 (9.8330)	Time 0.847 (0.000)	Data 0.003 (0.000)	
2021-06-16 20:06:30,144 Epoch: [18][949/4426]	Eit 80600  lr 5e-05  Le 9.8279 (9.8334)	Time 0.728 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:09:09,816 Epoch: [18][1149/4426]	Eit 80800  lr 5e-05  Le 9.8193 (9.8329)	Time 0.787 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:11:48,827 Epoch: [18][1349/4426]	Eit 81000  lr 5e-05  Le 9.8162 (9.8325)	Time 0.764 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:14:27,795 Epoch: [18][1549/4426]	Eit 81200  lr 5e-05  Le 9.8156 (9.8324)	Time 1.058 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:17:08,514 Epoch: [18][1749/4426]	Eit 81400  lr 5e-05  Le 9.8346 (9.8323)	Time 0.877 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:19:49,593 Epoch: [18][1949/4426]	Eit 81600  lr 5e-05  Le 9.8677 (9.8324)	Time 0.762 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:22:29,686 Epoch: [18][2149/4426]	Eit 81800  lr 5e-05  Le 9.8178 (9.8324)	Time 0.791 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:25:09,846 Epoch: [18][2349/4426]	Eit 82000  lr 5e-05  Le 9.8153 (9.8324)	Time 0.767 (0.000)	Data 0.003 (0.000)	
2021-06-16 20:27:47,898 Epoch: [18][2549/4426]	Eit 82200  lr 5e-05  Le 9.7895 (9.8323)	Time 0.776 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:30:26,247 Epoch: [18][2749/4426]	Eit 82400  lr 5e-05  Le 9.8131 (9.8324)	Time 0.760 (0.000)	Data 0.011 (0.000)	
2021-06-16 20:33:07,010 Epoch: [18][2949/4426]	Eit 82600  lr 5e-05  Le 9.8491 (9.8322)	Time 0.881 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:35:46,490 Epoch: [18][3149/4426]	Eit 82800  lr 5e-05  Le 9.8150 (9.8321)	Time 0.807 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:38:27,812 Epoch: [18][3349/4426]	Eit 83000  lr 5e-05  Le 9.8236 (9.8321)	Time 0.826 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:41:07,413 Epoch: [18][3549/4426]	Eit 83200  lr 5e-05  Le 9.8223 (9.8322)	Time 0.793 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:43:46,316 Epoch: [18][3749/4426]	Eit 83400  lr 5e-05  Le 9.8400 (9.8321)	Time 0.788 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:46:24,542 Epoch: [18][3949/4426]	Eit 83600  lr 5e-05  Le 9.8448 (9.8321)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:49:04,164 Epoch: [18][4149/4426]	Eit 83800  lr 5e-05  Le 9.8302 (9.8321)	Time 0.728 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:51:42,242 Epoch: [18][4349/4426]	Eit 84000  lr 5e-05  Le 9.8445 (9.8322)	Time 0.753 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:52:52,078 Test: [0/40]	Le 10.1957 (10.1957)	Time 8.595 (0.000)	
2021-06-16 20:53:05,853 calculate similarity time: 0.04763221740722656
2021-06-16 20:53:06,351 Image to text: 83.0, 98.1, 99.6, 1.0, 2.1
2021-06-16 20:53:06,668 Text to image: 69.0, 93.1, 96.8, 1.0, 3.6
2021-06-16 20:53:06,668 Current rsum is 539.64
2021-06-16 20:53:10,291 runs/coco_butd_region_bert/log
2021-06-16 20:53:10,291 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 20:53:10,295 image encoder trainable parameters: 20490144
2021-06-16 20:53:10,308 txt encoder trainable parameters: 137319072
2021-06-16 20:54:57,209 Epoch: [19][124/4426]	Eit 84200  lr 5e-05  Le 9.8296 (9.8287)	Time 0.765 (0.000)	Data 0.002 (0.000)	
2021-06-16 20:57:36,532 Epoch: [19][324/4426]	Eit 84400  lr 5e-05  Le 9.8216 (9.8290)	Time 0.834 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:00:18,069 Epoch: [19][524/4426]	Eit 84600  lr 5e-05  Le 9.8664 (9.8299)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:02:58,832 Epoch: [19][724/4426]	Eit 84800  lr 5e-05  Le 9.8539 (9.8306)	Time 0.848 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:05:40,649 Epoch: [19][924/4426]	Eit 85000  lr 5e-05  Le 9.8457 (9.8304)	Time 0.812 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:08:21,345 Epoch: [19][1124/4426]	Eit 85200  lr 5e-05  Le 9.8548 (9.8302)	Time 0.766 (0.000)	Data 0.003 (0.000)	
2021-06-16 21:11:02,780 Epoch: [19][1324/4426]	Eit 85400  lr 5e-05  Le 9.8556 (9.8304)	Time 0.983 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:13:42,757 Epoch: [19][1524/4426]	Eit 85600  lr 5e-05  Le 9.8094 (9.8305)	Time 0.875 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:16:22,356 Epoch: [19][1724/4426]	Eit 85800  lr 5e-05  Le 9.8245 (9.8304)	Time 0.844 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:19:01,640 Epoch: [19][1924/4426]	Eit 86000  lr 5e-05  Le 9.8183 (9.8308)	Time 0.784 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:21:41,644 Epoch: [19][2124/4426]	Eit 86200  lr 5e-05  Le 9.8215 (9.8308)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:24:21,911 Epoch: [19][2324/4426]	Eit 86400  lr 5e-05  Le 9.8438 (9.8308)	Time 0.760 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:27:00,449 Epoch: [19][2524/4426]	Eit 86600  lr 5e-05  Le 9.8095 (9.8309)	Time 0.909 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:29:40,661 Epoch: [19][2724/4426]	Eit 86800  lr 5e-05  Le 9.8304 (9.8307)	Time 0.802 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:32:18,782 Epoch: [19][2924/4426]	Eit 87000  lr 5e-05  Le 9.8420 (9.8307)	Time 0.772 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:34:56,894 Epoch: [19][3124/4426]	Eit 87200  lr 5e-05  Le 9.7926 (9.8307)	Time 0.879 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:37:36,033 Epoch: [19][3324/4426]	Eit 87400  lr 5e-05  Le 9.8203 (9.8307)	Time 0.723 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:40:14,135 Epoch: [19][3524/4426]	Eit 87600  lr 5e-05  Le 9.8451 (9.8307)	Time 0.836 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:42:52,766 Epoch: [19][3724/4426]	Eit 87800  lr 5e-05  Le 9.8430 (9.8307)	Time 0.815 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:45:31,545 Epoch: [19][3924/4426]	Eit 88000  lr 5e-05  Le 9.8365 (9.8306)	Time 0.775 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:48:11,734 Epoch: [19][4124/4426]	Eit 88200  lr 5e-05  Le 9.8187 (9.8306)	Time 0.796 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:50:52,367 Epoch: [19][4324/4426]	Eit 88400  lr 5e-05  Le 9.8448 (9.8306)	Time 0.785 (0.000)	Data 0.008 (0.000)	
2021-06-16 21:52:22,367 Test: [0/40]	Le 10.1946 (10.1945)	Time 8.875 (0.000)	
2021-06-16 21:52:36,571 calculate similarity time: 0.05433392524719238
2021-06-16 21:52:36,973 Image to text: 82.4, 98.2, 99.4, 1.0, 2.1
2021-06-16 21:52:37,291 Text to image: 68.8, 92.9, 96.9, 1.0, 3.7
2021-06-16 21:52:37,291 Current rsum is 538.58
2021-06-16 21:52:38,899 runs/coco_butd_region_bert/log
2021-06-16 21:52:38,899 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 21:52:38,900 image encoder trainable parameters: 20490144
2021-06-16 21:52:38,906 txt encoder trainable parameters: 137319072
2021-06-16 21:54:06,649 Epoch: [20][99/4426]	Eit 88600  lr 5e-05  Le 9.8304 (9.8332)	Time 0.766 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:56:48,170 Epoch: [20][299/4426]	Eit 88800  lr 5e-05  Le 9.8572 (9.8299)	Time 0.772 (0.000)	Data 0.002 (0.000)	
2021-06-16 21:59:24,642 Epoch: [20][499/4426]	Eit 89000  lr 5e-05  Le 9.8457 (9.8292)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:02:06,038 Epoch: [20][699/4426]	Eit 89200  lr 5e-05  Le 9.8440 (9.8295)	Time 0.831 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:04:45,045 Epoch: [20][899/4426]	Eit 89400  lr 5e-05  Le 9.8384 (9.8295)	Time 0.726 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:07:24,183 Epoch: [20][1099/4426]	Eit 89600  lr 5e-05  Le 9.8454 (9.8291)	Time 0.769 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:10:04,817 Epoch: [20][1299/4426]	Eit 89800  lr 5e-05  Le 9.8386 (9.8289)	Time 0.767 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:12:44,503 Epoch: [20][1499/4426]	Eit 90000  lr 5e-05  Le 9.8394 (9.8290)	Time 0.822 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:15:23,720 Epoch: [20][1699/4426]	Eit 90200  lr 5e-05  Le 9.8186 (9.8291)	Time 0.831 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:18:03,060 Epoch: [20][1899/4426]	Eit 90400  lr 5e-05  Le 9.8529 (9.8292)	Time 0.852 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:20:42,947 Epoch: [20][2099/4426]	Eit 90600  lr 5e-05  Le 9.8309 (9.8292)	Time 0.782 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:23:22,418 Epoch: [20][2299/4426]	Eit 90800  lr 5e-05  Le 9.8378 (9.8292)	Time 0.815 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:26:02,069 Epoch: [20][2499/4426]	Eit 91000  lr 5e-05  Le 9.8259 (9.8293)	Time 0.783 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:28:43,945 Epoch: [20][2699/4426]	Eit 91200  lr 5e-05  Le 9.8079 (9.8292)	Time 0.831 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:31:24,736 Epoch: [20][2899/4426]	Eit 91400  lr 5e-05  Le 9.7933 (9.8292)	Time 0.798 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:34:05,414 Epoch: [20][3099/4426]	Eit 91600  lr 5e-05  Le 9.8141 (9.8290)	Time 0.749 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:36:44,622 Epoch: [20][3299/4426]	Eit 91800  lr 5e-05  Le 9.8638 (9.8291)	Time 0.742 (0.000)	Data 0.003 (0.000)	
2021-06-16 22:39:24,901 Epoch: [20][3499/4426]	Eit 92000  lr 5e-05  Le 9.8364 (9.8291)	Time 0.764 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:42:03,570 Epoch: [20][3699/4426]	Eit 92200  lr 5e-05  Le 9.8414 (9.8291)	Time 0.834 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:44:44,589 Epoch: [20][3899/4426]	Eit 92400  lr 5e-05  Le 9.8159 (9.8291)	Time 0.753 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:47:25,578 Epoch: [20][4099/4426]	Eit 92600  lr 5e-05  Le 9.8358 (9.8292)	Time 0.834 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:50:05,365 Epoch: [20][4299/4426]	Eit 92800  lr 5e-05  Le 9.8460 (9.8293)	Time 0.838 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:51:54,361 Test: [0/40]	Le 10.1961 (10.1961)	Time 8.899 (0.000)	
2021-06-16 22:52:08,297 calculate similarity time: 0.04955434799194336
2021-06-16 22:52:08,807 Image to text: 82.7, 98.1, 99.5, 1.0, 2.1
2021-06-16 22:52:09,124 Text to image: 69.0, 93.0, 96.9, 1.0, 3.7
2021-06-16 22:52:09,124 Current rsum is 539.24
2021-06-16 22:52:10,776 runs/coco_butd_region_bert/log
2021-06-16 22:52:10,776 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 22:52:10,778 image encoder trainable parameters: 20490144
2021-06-16 22:52:10,785 txt encoder trainable parameters: 137319072
2021-06-16 22:53:18,958 Epoch: [21][74/4426]	Eit 93000  lr 5e-05  Le 9.8518 (9.8310)	Time 0.811 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:56:00,109 Epoch: [21][274/4426]	Eit 93200  lr 5e-05  Le 9.8241 (9.8299)	Time 0.807 (0.000)	Data 0.002 (0.000)	
2021-06-16 22:58:39,939 Epoch: [21][474/4426]	Eit 93400  lr 5e-05  Le 9.8537 (9.8289)	Time 0.787 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:01:19,625 Epoch: [21][674/4426]	Eit 93600  lr 5e-05  Le 9.8580 (9.8282)	Time 0.818 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:04:00,576 Epoch: [21][874/4426]	Eit 93800  lr 5e-05  Le 9.8120 (9.8288)	Time 0.797 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:06:41,193 Epoch: [21][1074/4426]	Eit 94000  lr 5e-05  Le 9.8225 (9.8289)	Time 0.762 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:09:21,955 Epoch: [21][1274/4426]	Eit 94200  lr 5e-05  Le 9.8417 (9.8290)	Time 0.812 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:12:03,624 Epoch: [21][1474/4426]	Eit 94400  lr 5e-05  Le 9.8199 (9.8291)	Time 0.824 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:14:43,173 Epoch: [21][1674/4426]	Eit 94600  lr 5e-05  Le 9.8173 (9.8290)	Time 0.805 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:17:21,743 Epoch: [21][1874/4426]	Eit 94800  lr 5e-05  Le 9.8184 (9.8289)	Time 0.739 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:20:00,669 Epoch: [21][2074/4426]	Eit 95000  lr 5e-05  Le 9.8199 (9.8290)	Time 0.836 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:22:42,270 Epoch: [21][2274/4426]	Eit 95200  lr 5e-05  Le 9.8365 (9.8290)	Time 0.754 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:25:24,668 Epoch: [21][2474/4426]	Eit 95400  lr 5e-05  Le 9.8325 (9.8288)	Time 0.727 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:28:03,604 Epoch: [21][2674/4426]	Eit 95600  lr 5e-05  Le 9.8268 (9.8288)	Time 0.806 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:30:42,113 Epoch: [21][2874/4426]	Eit 95800  lr 5e-05  Le 9.8128 (9.8287)	Time 0.725 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:33:22,645 Epoch: [21][3074/4426]	Eit 96000  lr 5e-05  Le 9.8179 (9.8286)	Time 0.801 (0.000)	Data 0.003 (0.000)	
2021-06-16 23:36:03,028 Epoch: [21][3274/4426]	Eit 96200  lr 5e-05  Le 9.8411 (9.8286)	Time 0.726 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:38:43,869 Epoch: [21][3474/4426]	Eit 96400  lr 5e-05  Le 9.7956 (9.8285)	Time 0.811 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:41:26,869 Epoch: [21][3674/4426]	Eit 96600  lr 5e-05  Le 9.8291 (9.8284)	Time 0.797 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:44:06,746 Epoch: [21][3874/4426]	Eit 96800  lr 5e-05  Le 9.8108 (9.8283)	Time 0.755 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:46:45,780 Epoch: [21][4074/4426]	Eit 97000  lr 5e-05  Le 9.8052 (9.8283)	Time 0.909 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:49:26,860 Epoch: [21][4274/4426]	Eit 97200  lr 5e-05  Le 9.8164 (9.8283)	Time 0.778 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:51:38,527 Test: [0/40]	Le 10.1962 (10.1962)	Time 9.440 (0.000)	
2021-06-16 23:51:52,319 calculate similarity time: 0.04755663871765137
2021-06-16 23:51:52,826 Image to text: 82.1, 98.1, 99.4, 1.0, 2.2
2021-06-16 23:51:53,156 Text to image: 68.7, 92.8, 96.8, 1.0, 3.6
2021-06-16 23:51:53,156 Current rsum is 537.88
2021-06-16 23:51:54,621 runs/coco_butd_region_bert/log
2021-06-16 23:51:54,621 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-16 23:51:54,622 image encoder trainable parameters: 20490144
2021-06-16 23:51:54,627 txt encoder trainable parameters: 137319072
2021-06-16 23:52:43,739 Epoch: [22][49/4426]	Eit 97400  lr 5e-05  Le 9.8289 (9.8247)	Time 0.741 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:55:25,813 Epoch: [22][249/4426]	Eit 97600  lr 5e-05  Le 9.7968 (9.8255)	Time 0.858 (0.000)	Data 0.002 (0.000)	
2021-06-16 23:58:06,571 Epoch: [22][449/4426]	Eit 97800  lr 5e-05  Le 9.8170 (9.8259)	Time 0.787 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:00:47,297 Epoch: [22][649/4426]	Eit 98000  lr 5e-05  Le 9.8196 (9.8260)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:03:27,287 Epoch: [22][849/4426]	Eit 98200  lr 5e-05  Le 9.8133 (9.8262)	Time 0.800 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:06:07,751 Epoch: [22][1049/4426]	Eit 98400  lr 5e-05  Le 9.8163 (9.8264)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:08:49,454 Epoch: [22][1249/4426]	Eit 98600  lr 5e-05  Le 9.8295 (9.8264)	Time 0.762 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:11:29,879 Epoch: [22][1449/4426]	Eit 98800  lr 5e-05  Le 9.8221 (9.8265)	Time 0.761 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:14:08,869 Epoch: [22][1649/4426]	Eit 99000  lr 5e-05  Le 9.7979 (9.8263)	Time 0.788 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:16:48,348 Epoch: [22][1849/4426]	Eit 99200  lr 5e-05  Le 9.8193 (9.8262)	Time 0.906 (0.000)	Data 0.003 (0.000)	
2021-06-17 00:19:27,243 Epoch: [22][2049/4426]	Eit 99400  lr 5e-05  Le 9.8411 (9.8261)	Time 0.779 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:22:07,180 Epoch: [22][2249/4426]	Eit 99600  lr 5e-05  Le 9.8469 (9.8263)	Time 0.790 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:24:44,858 Epoch: [22][2449/4426]	Eit 99800  lr 5e-05  Le 9.8270 (9.8264)	Time 0.770 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:27:27,495 Epoch: [22][2649/4426]	Eit 100000  lr 5e-05  Le 9.8281 (9.8265)	Time 0.850 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:30:07,186 Epoch: [22][2849/4426]	Eit 100200  lr 5e-05  Le 9.8169 (9.8265)	Time 0.790 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:32:47,024 Epoch: [22][3049/4426]	Eit 100400  lr 5e-05  Le 9.8418 (9.8267)	Time 0.791 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:35:27,777 Epoch: [22][3249/4426]	Eit 100600  lr 5e-05  Le 9.8426 (9.8268)	Time 0.796 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:38:08,918 Epoch: [22][3449/4426]	Eit 100800  lr 5e-05  Le 9.8338 (9.8269)	Time 0.824 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:40:48,035 Epoch: [22][3649/4426]	Eit 101000  lr 5e-05  Le 9.8322 (9.8269)	Time 0.810 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:43:27,504 Epoch: [22][3849/4426]	Eit 101200  lr 5e-05  Le 9.8064 (9.8270)	Time 0.783 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:46:08,117 Epoch: [22][4049/4426]	Eit 101400  lr 5e-05  Le 9.8417 (9.8270)	Time 0.785 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:48:47,989 Epoch: [22][4249/4426]	Eit 101600  lr 5e-05  Le 9.8143 (9.8270)	Time 0.779 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:51:17,841 Test: [0/40]	Le 10.1950 (10.1949)	Time 9.932 (0.000)	
2021-06-17 00:51:31,675 calculate similarity time: 0.04789590835571289
2021-06-17 00:51:32,177 Image to text: 82.7, 98.0, 99.4, 1.0, 2.5
2021-06-17 00:51:32,508 Text to image: 68.7, 92.7, 97.0, 1.0, 3.7
2021-06-17 00:51:32,508 Current rsum is 538.48
2021-06-17 00:51:34,130 runs/coco_butd_region_bert/log
2021-06-17 00:51:34,130 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-17 00:51:34,131 image encoder trainable parameters: 20490144
2021-06-17 00:51:34,136 txt encoder trainable parameters: 137319072
2021-06-17 00:52:03,548 Epoch: [23][24/4426]	Eit 101800  lr 5e-05  Le 9.8029 (9.8222)	Time 0.908 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:54:43,275 Epoch: [23][224/4426]	Eit 102000  lr 5e-05  Le 9.8249 (9.8252)	Time 0.847 (0.000)	Data 0.002 (0.000)	
2021-06-17 00:57:24,954 Epoch: [23][424/4426]	Eit 102200  lr 5e-05  Le 9.8075 (9.8260)	Time 0.818 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:00:03,848 Epoch: [23][624/4426]	Eit 102400  lr 5e-05  Le 9.8156 (9.8259)	Time 0.818 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:02:42,852 Epoch: [23][824/4426]	Eit 102600  lr 5e-05  Le 9.8304 (9.8259)	Time 0.721 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:05:22,240 Epoch: [23][1024/4426]	Eit 102800  lr 5e-05  Le 9.8165 (9.8261)	Time 0.731 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:08:02,100 Epoch: [23][1224/4426]	Eit 103000  lr 5e-05  Le 9.8043 (9.8260)	Time 0.807 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:10:41,618 Epoch: [23][1424/4426]	Eit 103200  lr 5e-05  Le 9.8424 (9.8261)	Time 0.854 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:13:19,931 Epoch: [23][1624/4426]	Eit 103400  lr 5e-05  Le 9.8240 (9.8259)	Time 0.877 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:15:57,654 Epoch: [23][1824/4426]	Eit 103600  lr 5e-05  Le 9.8174 (9.8261)	Time 0.835 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:18:37,094 Epoch: [23][2024/4426]	Eit 103800  lr 5e-05  Le 9.8562 (9.8259)	Time 0.810 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:21:16,070 Epoch: [23][2224/4426]	Eit 104000  lr 5e-05  Le 9.8237 (9.8260)	Time 0.798 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:23:55,440 Epoch: [23][2424/4426]	Eit 104200  lr 5e-05  Le 9.8083 (9.8261)	Time 0.729 (0.000)	Data 0.004 (0.000)	
2021-06-17 01:26:34,089 Epoch: [23][2624/4426]	Eit 104400  lr 5e-05  Le 9.8186 (9.8260)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:29:13,716 Epoch: [23][2824/4426]	Eit 104600  lr 5e-05  Le 9.8418 (9.8260)	Time 0.719 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:31:53,112 Epoch: [23][3024/4426]	Eit 104800  lr 5e-05  Le 9.8034 (9.8260)	Time 0.810 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:34:30,596 Epoch: [23][3224/4426]	Eit 105000  lr 5e-05  Le 9.8270 (9.8261)	Time 0.808 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:37:08,645 Epoch: [23][3424/4426]	Eit 105200  lr 5e-05  Le 9.8140 (9.8261)	Time 0.812 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:39:46,367 Epoch: [23][3624/4426]	Eit 105400  lr 5e-05  Le 9.8308 (9.8261)	Time 0.799 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:42:26,175 Epoch: [23][3824/4426]	Eit 105600  lr 5e-05  Le 9.8330 (9.8262)	Time 0.780 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:45:04,445 Epoch: [23][4024/4426]	Eit 105800  lr 5e-05  Le 9.8398 (9.8261)	Time 0.836 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:47:42,828 Epoch: [23][4224/4426]	Eit 106000  lr 5e-05  Le 9.8086 (9.8261)	Time 0.773 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:50:20,602 Epoch: [23][4424/4426]	Eit 106200  lr 5e-05  Le 9.8201 (9.8261)	Time 0.745 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:50:31,263 Test: [0/40]	Le 10.1959 (10.1959)	Time 9.326 (0.000)	
2021-06-17 01:50:45,408 calculate similarity time: 0.04839301109313965
2021-06-17 01:50:45,792 Image to text: 82.2, 98.0, 99.4, 1.0, 2.2
2021-06-17 01:50:46,104 Text to image: 68.7, 93.0, 96.8, 1.0, 3.6
2021-06-17 01:50:46,105 Current rsum is 538.1
2021-06-17 01:50:47,583 runs/coco_butd_region_bert/log
2021-06-17 01:50:47,583 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-17 01:50:47,585 image encoder trainable parameters: 20490144
2021-06-17 01:50:47,590 txt encoder trainable parameters: 137319072
2021-06-17 01:53:35,328 Epoch: [24][199/4426]	Eit 106400  lr 5e-05  Le 9.8692 (9.8242)	Time 0.940 (0.000)	Data 0.002 (0.000)	
2021-06-17 01:56:15,448 Epoch: [24][399/4426]	Eit 106600  lr 5e-05  Le 9.8360 (9.8253)	Time 0.774 (0.000)	Data 0.003 (0.000)	
2021-06-17 01:58:54,050 Epoch: [24][599/4426]	Eit 106800  lr 5e-05  Le 9.8337 (9.8248)	Time 0.846 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:01:33,668 Epoch: [24][799/4426]	Eit 107000  lr 5e-05  Le 9.8135 (9.8244)	Time 0.794 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:04:14,680 Epoch: [24][999/4426]	Eit 107200  lr 5e-05  Le 9.8254 (9.8242)	Time 0.807 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:06:53,762 Epoch: [24][1199/4426]	Eit 107400  lr 5e-05  Le 9.8162 (9.8244)	Time 0.735 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:09:34,038 Epoch: [24][1399/4426]	Eit 107600  lr 5e-05  Le 9.8238 (9.8250)	Time 0.874 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:12:13,948 Epoch: [24][1599/4426]	Eit 107800  lr 5e-05  Le 9.8250 (9.8251)	Time 0.759 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:14:53,819 Epoch: [24][1799/4426]	Eit 108000  lr 5e-05  Le 9.8159 (9.8252)	Time 0.794 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:17:32,433 Epoch: [24][1999/4426]	Eit 108200  lr 5e-05  Le 9.8394 (9.8253)	Time 0.749 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:20:10,780 Epoch: [24][2199/4426]	Eit 108400  lr 5e-05  Le 9.8050 (9.8254)	Time 0.766 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:22:50,882 Epoch: [24][2399/4426]	Eit 108600  lr 5e-05  Le 9.8307 (9.8254)	Time 0.884 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:25:32,160 Epoch: [24][2599/4426]	Eit 108800  lr 5e-05  Le 9.8008 (9.8254)	Time 0.910 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:28:12,875 Epoch: [24][2799/4426]	Eit 109000  lr 5e-05  Le 9.8090 (9.8254)	Time 0.863 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:30:52,227 Epoch: [24][2999/4426]	Eit 109200  lr 5e-05  Le 9.8503 (9.8255)	Time 0.832 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:33:31,172 Epoch: [24][3199/4426]	Eit 109400  lr 5e-05  Le 9.8450 (9.8255)	Time 0.762 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:36:11,558 Epoch: [24][3399/4426]	Eit 109600  lr 5e-05  Le 9.8251 (9.8255)	Time 0.774 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:38:50,970 Epoch: [24][3599/4426]	Eit 109800  lr 5e-05  Le 9.8119 (9.8254)	Time 0.754 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:41:30,948 Epoch: [24][3799/4426]	Eit 110000  lr 5e-05  Le 9.8432 (9.8254)	Time 0.817 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:44:09,357 Epoch: [24][3999/4426]	Eit 110200  lr 5e-05  Le 9.8199 (9.8254)	Time 0.801 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:46:50,050 Epoch: [24][4199/4426]	Eit 110400  lr 5e-05  Le 9.8130 (9.8254)	Time 0.726 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:49:29,884 Epoch: [24][4399/4426]	Eit 110600  lr 5e-05  Le 9.8481 (9.8254)	Time 0.872 (0.000)	Data 0.002 (0.000)	
2021-06-17 02:50:00,333 Test: [0/40]	Le 10.1974 (10.1974)	Time 9.690 (0.000)	
2021-06-17 02:50:14,228 calculate similarity time: 0.04757261276245117
2021-06-17 02:50:14,733 Image to text: 82.9, 98.0, 99.3, 1.0, 2.3
2021-06-17 02:50:15,073 Text to image: 68.5, 92.9, 96.9, 1.0, 3.7
2021-06-17 02:50:15,073 Current rsum is 538.5
You have new mail in /var/spool/mail/root
[root@gpu1 vse_infty-master-my-graph-gru-unified]# CUDA_VISIBLE_DEVICES=0,1 python3 eval.py --dataset coco --data_path ../data/coco
INFO:root:Evaluating runs/coco_butd_region_bert...
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
INFO:lib.evaluation:Test: [0/196]	Le 10.2092 (10.2092)	Time 5.833 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2084 (10.2092)	Time 0.436 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2104 (10.2066)	Time 0.316 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2088 (10.2074)	Time 0.320 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2201 (10.2062)	Time 0.325 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2113 (10.2062)	Time 0.357 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2027 (10.2067)	Time 0.332 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2127 (10.2062)	Time 0.329 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2117 (10.2065)	Time 0.417 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2090 (10.2067)	Time 0.330 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2195 (10.2069)	Time 0.328 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.1943 (10.2068)	Time 0.331 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2357 (10.2071)	Time 0.362 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2032 (10.2072)	Time 0.327 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2250 (10.2076)	Time 0.309 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.1921 (10.2075)	Time 0.321 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2162 (10.2077)	Time 0.314 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2031 (10.2076)	Time 0.342 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.1997 (10.2072)	Time 0.345 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1994 (10.2076)	Time 0.308 (0.000)	
Traceback (most recent call last):
  File "eval.py", line 58, in <module>
    main()
  File "eval.py", line 46, in main
    evaluation.evalrank(model_path, data_path=opt.data_path, split='testall', fold5=True)
  File "/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/evaluation.py", line 230, in evalrank
    print("##########################",np.array(img_embs).shape())
TypeError: 'tuple' object is not callable
You have new mail in /var/spool/mail/root
[root@gpu1 vse_infty-master-my-graph-gru-unified]# CUDA_VISIBLE_DEVICES=0,1 python3 eval.py --dataset coco --data_path ../data/coco
INFO:root:Evaluating runs/coco_butd_region_bert...
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
INFO:lib.evaluation:Test: [0/196]	Le 10.2092 (10.2092)	Time 6.272 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2084 (10.2092)	Time 0.478 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2104 (10.2066)	Time 0.315 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2088 (10.2074)	Time 0.317 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2201 (10.2062)	Time 0.316 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2113 (10.2062)	Time 0.334 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2027 (10.2067)	Time 0.320 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2127 (10.2062)	Time 0.317 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2117 (10.2065)	Time 0.425 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2090 (10.2067)	Time 0.350 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2195 (10.2069)	Time 0.326 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.1943 (10.2068)	Time 0.318 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2357 (10.2071)	Time 0.344 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2032 (10.2072)	Time 0.323 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2250 (10.2076)	Time 0.311 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.1921 (10.2075)	Time 0.316 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2162 (10.2077)	Time 0.315 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2031 (10.2076)	Time 0.346 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.1997 (10.2072)	Time 0.312 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1994 (10.2076)	Time 0.304 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.10043931007385254
INFO:lib.evaluation:Image to text: 82.4, 97.3, 98.9, 1.0, 1.5
INFO:lib.evaluation:Text to image: 67.2, 92.5, 96.4, 1.0, 4.0
INFO:lib.evaluation:rsum: 534.6 ar: 92.9 ari: 85.3
INFO:lib.evaluation:calculate similarity time: 0.07601261138916016
INFO:lib.evaluation:Image to text: 81.2, 96.5, 98.7, 1.0, 1.6
INFO:lib.evaluation:Text to image: 66.0, 90.8, 96.0, 1.0, 3.7
INFO:lib.evaluation:rsum: 529.2 ar: 92.1 ari: 84.3
INFO:lib.evaluation:calculate similarity time: 0.07890152931213379
INFO:lib.evaluation:Image to text: 80.8, 96.6, 99.0, 1.0, 1.6
INFO:lib.evaluation:Text to image: 67.2, 91.4, 96.5, 1.0, 4.1
INFO:lib.evaluation:rsum: 531.5 ar: 92.1 ari: 85.0
INFO:lib.evaluation:calculate similarity time: 0.07030200958251953
INFO:lib.evaluation:Image to text: 78.8, 97.2, 98.8, 1.0, 1.6
INFO:lib.evaluation:Text to image: 64.1, 92.0, 96.6, 1.0, 3.4
INFO:lib.evaluation:rsum: 527.6 ar: 91.6 ari: 84.3
INFO:lib.evaluation:calculate similarity time: 0.07225894927978516
INFO:lib.evaluation:Image to text: 81.4, 96.8, 98.9, 1.0, 1.6
INFO:lib.evaluation:Text to image: 67.1, 92.4, 97.0, 1.0, 3.5
INFO:lib.evaluation:rsum: 533.6 ar: 92.4 ari: 85.5
INFO:lib.evaluation:-----------------------------------
INFO:lib.evaluation:Mean metrics: 
INFO:lib.evaluation:rsum: 531.3
INFO:lib.evaluation:Average i2t Recall: 92.2
INFO:lib.evaluation:Image to text: 80.9 96.9 98.9 1.0 1.6
INFO:lib.evaluation:Average t2i Recall: 84.9
INFO:lib.evaluation:Text to image: 66.3 91.8 96.5 1.0 3.7
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
INFO:lib.evaluation:Test: [0/196]	Le 10.2092 (10.2092)	Time 1.810 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2084 (10.2092)	Time 0.377 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2104 (10.2066)	Time 0.319 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2088 (10.2074)	Time 0.336 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2201 (10.2062)	Time 0.310 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2113 (10.2062)	Time 0.322 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2027 (10.2067)	Time 0.328 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2127 (10.2062)	Time 0.347 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2117 (10.2065)	Time 0.403 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2090 (10.2067)	Time 0.335 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2195 (10.2069)	Time 0.350 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.1943 (10.2068)	Time 0.317 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2357 (10.2071)	Time 0.343 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2032 (10.2072)	Time 0.323 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2250 (10.2076)	Time 0.319 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.1921 (10.2075)	Time 0.333 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2162 (10.2077)	Time 0.317 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2031 (10.2076)	Time 0.340 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.1997 (10.2072)	Time 0.327 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1994 (10.2076)	Time 0.304 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.6441640853881836
INFO:lib.evaluation:rsum: 442.2
INFO:lib.evaluation:Average i2t Recall: 80.0
INFO:lib.evaluation:Image to text: 60.3 86.5 93.1 1.0 3.7
INFO:lib.evaluation:Average t2i Recall: 67.4
INFO:lib.evaluation:Text to image: 44.0 74.2 84.1 2.0 14.5
INFO:root:Evaluating runs/coco_butd_grid_bert...
Traceback (most recent call last):
  File "eval.py", line 58, in <module>
    main()
  File "eval.py", line 46, in main
    evaluation.evalrank(model_path, data_path=opt.data_path, split='testall', fold5=True)
  File "/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified/lib/evaluation.py", line 196, in evalrank
    checkpoint = torch.load(model_path)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 571, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 229, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 210, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'runs/coco_butd_grid_bert/model_best.pth'
[root@gpu1 vse_infty-master-my-graph-gru-unified]# 
