[root@gpu1 vse_infty-master-my-graph-gru-unified-meanpooling]# sh train_region.sh 

2021-06-19 16:20:11,704 Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=False, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vse_mean_warmup_epochs=1, word_dim=300, workers=10)
2021-06-19 16:20:11,705 Model name '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' not found in model shortcut name list (bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese, bert-base-german-cased, bert-large-uncased-whole-word-masking, bert-large-cased-whole-word-masking, bert-large-uncased-whole-word-masking-finetuned-squad, bert-large-cased-whole-word-masking-finetuned-squad, bert-base-cased-finetuned-mrpc). Assuming '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' is a path or url to a directory containing tokenizer files.
2021-06-19 16:20:11,705 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/added_tokens.json. We won't load it.
2021-06-19 16:20:11,705 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/special_tokens_map.json. We won't load it.
2021-06-19 16:20:11,705 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/tokenizer_config.json. We won't load it.
2021-06-19 16:20:11,705 loading file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/vocab.txt
2021-06-19 16:20:11,705 loading file None
2021-06-19 16:20:11,705 loading file None
2021-06-19 16:20:11,705 loading file None
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified-meanpooling/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified-meanpooling/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
2021-06-19 16:20:39,527 loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
2021-06-19 16:20:39,528 Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

2021-06-19 16:20:39,529 loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
2021-06-19 16:20:46,427 Use adam as the optimizer, with init lr 0.0005
2021-06-19 16:20:46,429 Image encoder is data paralleled now.
2021-06-19 16:20:46,429 runs/coco_butd_region_bert/log
2021-06-19 16:20:46,429 runs/coco_butd_region_bert
2021-06-19 16:20:46,431 image encoder trainable parameters: 20490144
2021-06-19 16:20:46,441 txt encoder trainable parameters: 137319072
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
2021-06-19 16:23:29,120 Epoch: [0][199/4426]	Eit 200  lr 0.0005  Le 10.1208 (10.1388)	Time 0.672 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:26:12,370 Epoch: [0][399/4426]	Eit 400  lr 0.0005  Le 10.0963 (10.1264)	Time 1.143 (0.000)	Data 0.004 (0.000)	
2021-06-19 16:30:07,936 Epoch: [0][599/4426]	Eit 600  lr 0.0005  Le 10.0812 (10.1156)	Time 1.143 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:34:03,923 Epoch: [0][799/4426]	Eit 800  lr 0.0005  Le 10.0805 (10.1054)	Time 1.040 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:37:59,912 Epoch: [0][999/4426]	Eit 1000  lr 0.0005  Le 10.0664 (10.0962)	Time 1.128 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:41:59,669 Epoch: [0][1199/4426]	Eit 1200  lr 0.0005  Le 10.0413 (10.0886)	Time 1.269 (0.000)	Data 0.005 (0.000)	
2021-06-19 16:45:59,142 Epoch: [0][1399/4426]	Eit 1400  lr 0.0005  Le 10.0574 (10.0820)	Time 1.269 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:49:53,382 Epoch: [0][1599/4426]	Eit 1600  lr 0.0005  Le 9.9940 (10.0761)	Time 1.518 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:53:52,251 Epoch: [0][1799/4426]	Eit 1800  lr 0.0005  Le 10.0290 (10.0708)	Time 1.469 (0.000)	Data 0.002 (0.000)	
2021-06-19 16:57:48,358 Epoch: [0][1999/4426]	Eit 2000  lr 0.0005  Le 9.9824 (10.0660)	Time 1.132 (0.000)	Data 0.003 (0.000)	
2021-06-19 17:01:45,520 Epoch: [0][2199/4426]	Eit 2200  lr 0.0005  Le 10.0364 (10.0618)	Time 1.159 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:05:42,957 Epoch: [0][2399/4426]	Eit 2400  lr 0.0005  Le 10.0157 (10.0578)	Time 1.271 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:09:40,124 Epoch: [0][2599/4426]	Eit 2600  lr 0.0005  Le 9.9853 (10.0543)	Time 1.151 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:13:36,034 Epoch: [0][2799/4426]	Eit 2800  lr 0.0005  Le 9.9894 (10.0509)	Time 1.152 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:17:34,056 Epoch: [0][2999/4426]	Eit 3000  lr 0.0005  Le 9.9756 (10.0477)	Time 1.114 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:21:33,142 Epoch: [0][3199/4426]	Eit 3200  lr 0.0005  Le 10.0093 (10.0447)	Time 1.179 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:25:28,071 Epoch: [0][3399/4426]	Eit 3400  lr 0.0005  Le 9.9875 (10.0419)	Time 1.199 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:29:25,115 Epoch: [0][3599/4426]	Eit 3600  lr 0.0005  Le 9.9970 (10.0393)	Time 1.201 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:33:22,933 Epoch: [0][3799/4426]	Eit 3800  lr 0.0005  Le 10.0165 (10.0369)	Time 1.073 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:37:17,405 Epoch: [0][3999/4426]	Eit 4000  lr 0.0005  Le 9.9819 (10.0347)	Time 1.089 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:41:11,796 Epoch: [0][4199/4426]	Eit 4200  lr 0.0005  Le 10.0070 (10.0326)	Time 1.182 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:45:09,257 Epoch: [0][4399/4426]	Eit 4400  lr 0.0005  Le 9.9989 (10.0306)	Time 1.208 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:45:49,289 Test: [0/40]	Le 10.1859 (10.1859)	Time 7.934 (0.000)	
2021-06-19 17:46:10,080 calculate similarity time: 0.12636423110961914
2021-06-19 17:46:10,609 Image to text: 65.8, 90.4, 96.7, 1.0, 3.7
2021-06-19 17:46:10,943 Text to image: 52.2, 85.3, 93.3, 1.0, 4.3
2021-06-19 17:46:10,943 Current rsum is 483.72
2021-06-19 17:46:13,969 runs/coco_butd_region_bert/log
2021-06-19 17:46:13,970 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-19 17:46:13,971 image encoder trainable parameters: 20490144
2021-06-19 17:46:13,976 txt encoder trainable parameters: 137319072
2021-06-19 17:49:34,906 Epoch: [1][174/4426]	Eit 4600  lr 0.0005  Le 10.0095 (9.9779)	Time 0.674 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:53:28,320 Epoch: [1][374/4426]	Eit 4800  lr 0.0005  Le 9.9759 (9.9775)	Time 1.185 (0.000)	Data 0.002 (0.000)	
2021-06-19 17:57:29,002 Epoch: [1][574/4426]	Eit 5000  lr 0.0005  Le 9.9632 (9.9757)	Time 1.281 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:01:25,314 Epoch: [1][774/4426]	Eit 5200  lr 0.0005  Le 9.9836 (9.9749)	Time 1.065 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:05:22,971 Epoch: [1][974/4426]	Eit 5400  lr 0.0005  Le 9.9477 (9.9747)	Time 1.223 (0.000)	Data 0.011 (0.000)	
2021-06-19 18:09:17,520 Epoch: [1][1174/4426]	Eit 5600  lr 0.0005  Le 9.9898 (9.9745)	Time 1.152 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:13:15,732 Epoch: [1][1374/4426]	Eit 5800  lr 0.0005  Le 9.9499 (9.9738)	Time 1.129 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:17:12,666 Epoch: [1][1574/4426]	Eit 6000  lr 0.0005  Le 9.9968 (9.9736)	Time 1.109 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:21:07,985 Epoch: [1][1774/4426]	Eit 6200  lr 0.0005  Le 9.9771 (9.9733)	Time 1.165 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:25:05,752 Epoch: [1][1974/4426]	Eit 6400  lr 0.0005  Le 9.9424 (9.9727)	Time 1.079 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:29:06,854 Epoch: [1][2174/4426]	Eit 6600  lr 0.0005  Le 9.9884 (9.9718)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:33:03,651 Epoch: [1][2374/4426]	Eit 6800  lr 0.0005  Le 9.9905 (9.9712)	Time 1.127 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:36:59,042 Epoch: [1][2574/4426]	Eit 7000  lr 0.0005  Le 9.9364 (9.9706)	Time 1.097 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:40:59,572 Epoch: [1][2774/4426]	Eit 7200  lr 0.0005  Le 9.9860 (9.9701)	Time 1.345 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:44:58,194 Epoch: [1][2974/4426]	Eit 7400  lr 0.0005  Le 9.9627 (9.9696)	Time 1.186 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:48:54,304 Epoch: [1][3174/4426]	Eit 7600  lr 0.0005  Le 9.9531 (9.9692)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-19 18:52:51,495 Epoch: [1][3374/4426]	Eit 7800  lr 0.0005  Le 9.9399 (9.9687)	Time 1.144 (0.000)	Data 0.003 (0.000)	
2021-06-19 18:56:48,245 Epoch: [1][3574/4426]	Eit 8000  lr 0.0005  Le 9.9525 (9.9682)	Time 1.165 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:00:44,996 Epoch: [1][3774/4426]	Eit 8200  lr 0.0005  Le 9.8990 (9.9676)	Time 1.166 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:04:43,324 Epoch: [1][3974/4426]	Eit 8400  lr 0.0005  Le 9.9857 (9.9671)	Time 1.053 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:08:40,873 Epoch: [1][4174/4426]	Eit 8600  lr 0.0005  Le 9.9580 (9.9666)	Time 1.116 (0.000)	Data 0.004 (0.000)	
2021-06-19 19:12:38,053 Epoch: [1][4374/4426]	Eit 8800  lr 0.0005  Le 9.9544 (9.9661)	Time 1.271 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:13:41,193 Test: [0/40]	Le 10.1846 (10.1846)	Time 7.804 (0.000)	
2021-06-19 19:13:55,961 calculate similarity time: 0.06374001502990723
2021-06-19 19:13:56,408 Image to text: 68.3, 93.7, 97.6, 1.0, 3.6
2021-06-19 19:13:56,736 Text to image: 56.3, 87.8, 94.8, 1.0, 4.3
2021-06-19 19:13:56,736 Current rsum is 498.46
2021-06-19 19:14:00,425 runs/coco_butd_region_bert/log
2021-06-19 19:14:00,425 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-19 19:14:00,428 image encoder trainable parameters: 20490144
2021-06-19 19:14:00,438 txt encoder trainable parameters: 137319072
2021-06-19 19:17:03,209 Epoch: [2][149/4426]	Eit 9000  lr 0.0005  Le 9.9304 (9.9459)	Time 1.186 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:21:02,126 Epoch: [2][349/4426]	Eit 9200  lr 0.0005  Le 9.9305 (9.9472)	Time 1.169 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:25:00,191 Epoch: [2][549/4426]	Eit 9400  lr 0.0005  Le 9.9467 (9.9482)	Time 1.182 (0.000)	Data 0.003 (0.000)	
2021-06-19 19:28:56,941 Epoch: [2][749/4426]	Eit 9600  lr 0.0005  Le 9.9528 (9.9478)	Time 1.292 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:32:51,414 Epoch: [2][949/4426]	Eit 9800  lr 0.0005  Le 9.9218 (9.9478)	Time 1.257 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:36:49,433 Epoch: [2][1149/4426]	Eit 10000  lr 0.0005  Le 9.9478 (9.9472)	Time 1.564 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:40:45,518 Epoch: [2][1349/4426]	Eit 10200  lr 0.0005  Le 9.9865 (9.9469)	Time 1.411 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:44:44,013 Epoch: [2][1549/4426]	Eit 10400  lr 0.0005  Le 9.9310 (9.9463)	Time 1.147 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:48:41,844 Epoch: [2][1749/4426]	Eit 10600  lr 0.0005  Le 9.9219 (9.9462)	Time 1.148 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:52:40,134 Epoch: [2][1949/4426]	Eit 10800  lr 0.0005  Le 9.9499 (9.9460)	Time 1.217 (0.000)	Data 0.002 (0.000)	
2021-06-19 19:56:36,162 Epoch: [2][2149/4426]	Eit 11000  lr 0.0005  Le 9.9497 (9.9456)	Time 1.170 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:00:30,399 Epoch: [2][2349/4426]	Eit 11200  lr 0.0005  Le 9.9289 (9.9454)	Time 1.085 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:04:26,375 Epoch: [2][2549/4426]	Eit 11400  lr 0.0005  Le 9.9166 (9.9453)	Time 1.073 (0.000)	Data 0.010 (0.000)	
2021-06-19 20:08:23,559 Epoch: [2][2749/4426]	Eit 11600  lr 0.0005  Le 9.9485 (9.9452)	Time 1.105 (0.000)	Data 0.009 (0.000)	
2021-06-19 20:12:18,619 Epoch: [2][2949/4426]	Eit 11800  lr 0.0005  Le 9.9407 (9.9450)	Time 1.240 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:16:16,938 Epoch: [2][3149/4426]	Eit 12000  lr 0.0005  Le 9.9177 (9.9448)	Time 1.261 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:20:17,608 Epoch: [2][3349/4426]	Eit 12200  lr 0.0005  Le 9.9383 (9.9445)	Time 1.041 (0.000)	Data 0.003 (0.000)	
2021-06-19 20:24:14,282 Epoch: [2][3549/4426]	Eit 12400  lr 0.0005  Le 9.9411 (9.9443)	Time 1.179 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:28:11,026 Epoch: [2][3749/4426]	Eit 12600  lr 0.0005  Le 9.9189 (9.9440)	Time 1.170 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:32:07,385 Epoch: [2][3949/4426]	Eit 12800  lr 0.0005  Le 9.9367 (9.9437)	Time 1.106 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:36:03,600 Epoch: [2][4149/4426]	Eit 13000  lr 0.0005  Le 9.9636 (9.9435)	Time 1.174 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:39:52,563 Epoch: [2][4349/4426]	Eit 13200  lr 0.0005  Le 9.9728 (9.9433)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:41:32,632 Test: [0/40]	Le 10.1857 (10.1857)	Time 7.976 (0.000)	
2021-06-19 20:41:52,218 calculate similarity time: 0.06097412109375
2021-06-19 20:41:52,714 Image to text: 71.3, 94.6, 98.5, 1.0, 2.7
2021-06-19 20:41:53,073 Text to image: 57.9, 88.5, 95.6, 1.0, 4.0
2021-06-19 20:41:53,073 Current rsum is 506.44
2021-06-19 20:41:56,934 runs/coco_butd_region_bert/log
2021-06-19 20:41:56,934 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-19 20:41:56,937 image encoder trainable parameters: 20490144
2021-06-19 20:41:56,951 txt encoder trainable parameters: 137319072
2021-06-19 20:44:29,990 Epoch: [3][124/4426]	Eit 13400  lr 0.0005  Le 9.9288 (9.9298)	Time 1.100 (0.000)	Data 0.004 (0.000)	
2021-06-19 20:48:31,294 Epoch: [3][324/4426]	Eit 13600  lr 0.0005  Le 9.9400 (9.9295)	Time 1.230 (0.000)	Data 0.012 (0.000)	
2021-06-19 20:52:26,536 Epoch: [3][524/4426]	Eit 13800  lr 0.0005  Le 9.9571 (9.9298)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-19 20:56:21,235 Epoch: [3][724/4426]	Eit 14000  lr 0.0005  Le 9.9053 (9.9300)	Time 1.110 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:00:21,809 Epoch: [3][924/4426]	Eit 14200  lr 0.0005  Le 9.9065 (9.9300)	Time 1.148 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:04:23,478 Epoch: [3][1124/4426]	Eit 14400  lr 0.0005  Le 9.9436 (9.9299)	Time 1.179 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:08:20,885 Epoch: [3][1324/4426]	Eit 14600  lr 0.0005  Le 9.9464 (9.9300)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:12:15,462 Epoch: [3][1524/4426]	Eit 14800  lr 0.0005  Le 9.9378 (9.9298)	Time 1.096 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:16:15,232 Epoch: [3][1724/4426]	Eit 15000  lr 0.0005  Le 9.9792 (9.9297)	Time 1.070 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:20:14,426 Epoch: [3][1924/4426]	Eit 15200  lr 0.0005  Le 9.9454 (9.9297)	Time 1.217 (0.000)	Data 0.003 (0.000)	
2021-06-19 21:24:14,214 Epoch: [3][2124/4426]	Eit 15400  lr 0.0005  Le 9.9136 (9.9296)	Time 1.535 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:28:12,811 Epoch: [3][2324/4426]	Eit 15600  lr 0.0005  Le 9.9582 (9.9294)	Time 1.278 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:32:11,622 Epoch: [3][2524/4426]	Eit 15800  lr 0.0005  Le 9.9189 (9.9291)	Time 1.279 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:36:09,894 Epoch: [3][2724/4426]	Eit 16000  lr 0.0005  Le 9.9556 (9.9290)	Time 1.150 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:40:06,829 Epoch: [3][2924/4426]	Eit 16200  lr 0.0005  Le 9.9592 (9.9289)	Time 1.187 (0.000)	Data 0.003 (0.000)	
2021-06-19 21:44:07,248 Epoch: [3][3124/4426]	Eit 16400  lr 0.0005  Le 9.9608 (9.9288)	Time 1.223 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:48:06,287 Epoch: [3][3324/4426]	Eit 16600  lr 0.0005  Le 9.9730 (9.9289)	Time 1.130 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:52:06,087 Epoch: [3][3524/4426]	Eit 16800  lr 0.0005  Le 9.9055 (9.9288)	Time 1.125 (0.000)	Data 0.002 (0.000)	
2021-06-19 21:56:05,450 Epoch: [3][3724/4426]	Eit 17000  lr 0.0005  Le 9.9219 (9.9286)	Time 1.414 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:00:02,411 Epoch: [3][3924/4426]	Eit 17200  lr 0.0005  Le 9.9169 (9.9286)	Time 1.164 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:03:44,596 Epoch: [3][4124/4426]	Eit 17400  lr 0.0005  Le 9.9221 (9.9285)	Time 1.242 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:07:45,071 Epoch: [3][4324/4426]	Eit 17600  lr 0.0005  Le 9.9253 (9.9285)	Time 1.301 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:09:53,699 Test: [0/40]	Le 10.1862 (10.1862)	Time 7.750 (0.000)	
2021-06-19 22:10:14,209 calculate similarity time: 0.05794262886047363
2021-06-19 22:10:14,751 Image to text: 74.5, 95.7, 98.5, 1.0, 3.2
2021-06-19 22:10:15,183 Text to image: 59.9, 89.3, 95.8, 1.0, 4.1
2021-06-19 22:10:15,183 Current rsum is 513.68
2021-06-19 22:10:18,769 runs/coco_butd_region_bert/log
2021-06-19 22:10:18,769 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-19 22:10:18,772 image encoder trainable parameters: 20490144
2021-06-19 22:10:18,785 txt encoder trainable parameters: 137319072
2021-06-19 22:12:23,160 Epoch: [4][99/4426]	Eit 17800  lr 0.0005  Le 9.9327 (9.9167)	Time 1.159 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:16:21,974 Epoch: [4][299/4426]	Eit 18000  lr 0.0005  Le 9.8842 (9.9170)	Time 1.057 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:20:18,096 Epoch: [4][499/4426]	Eit 18200  lr 0.0005  Le 9.9467 (9.9179)	Time 1.079 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:24:20,224 Epoch: [4][699/4426]	Eit 18400  lr 0.0005  Le 9.9310 (9.9174)	Time 1.299 (0.000)	Data 0.003 (0.000)	
2021-06-19 22:28:19,312 Epoch: [4][899/4426]	Eit 18600  lr 0.0005  Le 9.9034 (9.9176)	Time 1.460 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:32:17,028 Epoch: [4][1099/4426]	Eit 18800  lr 0.0005  Le 9.9104 (9.9178)	Time 1.132 (0.000)	Data 0.003 (0.000)	
2021-06-19 22:36:12,899 Epoch: [4][1299/4426]	Eit 19000  lr 0.0005  Le 9.9039 (9.9177)	Time 1.235 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:40:12,290 Epoch: [4][1499/4426]	Eit 19200  lr 0.0005  Le 9.9182 (9.9178)	Time 1.122 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:44:12,141 Epoch: [4][1699/4426]	Eit 19400  lr 0.0005  Le 9.9157 (9.9180)	Time 1.147 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:48:11,222 Epoch: [4][1899/4426]	Eit 19600  lr 0.0005  Le 9.9235 (9.9180)	Time 1.164 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:52:08,527 Epoch: [4][2099/4426]	Eit 19800  lr 0.0005  Le 9.9275 (9.9181)	Time 1.332 (0.000)	Data 0.002 (0.000)	
2021-06-19 22:56:04,967 Epoch: [4][2299/4426]	Eit 20000  lr 0.0005  Le 9.9175 (9.9179)	Time 1.341 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:00:04,616 Epoch: [4][2499/4426]	Eit 20200  lr 0.0005  Le 9.9273 (9.9178)	Time 1.182 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:04:01,929 Epoch: [4][2699/4426]	Eit 20400  lr 0.0005  Le 9.8680 (9.9177)	Time 1.095 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:08:03,691 Epoch: [4][2899/4426]	Eit 20600  lr 0.0005  Le 9.9194 (9.9176)	Time 1.114 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:12:00,739 Epoch: [4][3099/4426]	Eit 20800  lr 0.0005  Le 9.9511 (9.9176)	Time 1.159 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:15:59,788 Epoch: [4][3299/4426]	Eit 21000  lr 0.0005  Le 9.9175 (9.9175)	Time 1.118 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:19:58,320 Epoch: [4][3499/4426]	Eit 21200  lr 0.0005  Le 9.9091 (9.9174)	Time 1.109 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:23:57,820 Epoch: [4][3699/4426]	Eit 21400  lr 0.0005  Le 9.9139 (9.9173)	Time 1.108 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:27:44,045 Epoch: [4][3899/4426]	Eit 21600  lr 0.0005  Le 9.9117 (9.9173)	Time 1.020 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:31:42,693 Epoch: [4][4099/4426]	Eit 21800  lr 0.0005  Le 9.9187 (9.9174)	Time 1.047 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:35:42,452 Epoch: [4][4299/4426]	Eit 22000  lr 0.0005  Le 9.8957 (9.9173)	Time 1.180 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:38:18,831 Test: [0/40]	Le 10.1911 (10.1911)	Time 7.727 (0.000)	
2021-06-19 23:38:39,598 calculate similarity time: 0.07318377494812012
2021-06-19 23:38:40,049 Image to text: 73.6, 95.0, 98.0, 1.0, 2.9
2021-06-19 23:38:40,363 Text to image: 59.5, 90.3, 96.0, 1.0, 3.8
2021-06-19 23:38:40,363 Current rsum is 512.34
2021-06-19 23:38:41,812 runs/coco_butd_region_bert/log
2021-06-19 23:38:41,812 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-19 23:38:41,814 image encoder trainable parameters: 20490144
2021-06-19 23:38:41,819 txt encoder trainable parameters: 137319072
2021-06-19 23:40:17,478 Epoch: [5][74/4426]	Eit 22200  lr 0.0005  Le 9.9166 (9.9104)	Time 1.129 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:44:14,345 Epoch: [5][274/4426]	Eit 22400  lr 0.0005  Le 9.8866 (9.9088)	Time 1.079 (0.000)	Data 0.009 (0.000)	
2021-06-19 23:48:14,519 Epoch: [5][474/4426]	Eit 22600  lr 0.0005  Le 9.9285 (9.9082)	Time 1.132 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:52:13,963 Epoch: [5][674/4426]	Eit 22800  lr 0.0005  Le 9.9290 (9.9081)	Time 1.107 (0.000)	Data 0.002 (0.000)	
2021-06-19 23:56:16,062 Epoch: [5][874/4426]	Eit 23000  lr 0.0005  Le 9.8534 (9.9084)	Time 1.399 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:00:15,566 Epoch: [5][1074/4426]	Eit 23200  lr 0.0005  Le 9.9190 (9.9084)	Time 1.396 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:04:14,040 Epoch: [5][1274/4426]	Eit 23400  lr 0.0005  Le 9.9032 (9.9084)	Time 1.181 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:08:10,045 Epoch: [5][1474/4426]	Eit 23600  lr 0.0005  Le 9.9303 (9.9084)	Time 1.296 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:12:04,395 Epoch: [5][1674/4426]	Eit 23800  lr 0.0005  Le 9.8778 (9.9084)	Time 1.159 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:16:00,639 Epoch: [5][1874/4426]	Eit 24000  lr 0.0005  Le 9.9188 (9.9084)	Time 1.134 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:19:59,531 Epoch: [5][2074/4426]	Eit 24200  lr 0.0005  Le 9.8734 (9.9086)	Time 1.149 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:23:55,767 Epoch: [5][2274/4426]	Eit 24400  lr 0.0005  Le 9.9545 (9.9083)	Time 1.224 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:27:52,914 Epoch: [5][2474/4426]	Eit 24600  lr 0.0005  Le 9.8730 (9.9083)	Time 1.180 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:31:51,128 Epoch: [5][2674/4426]	Eit 24800  lr 0.0005  Le 9.9102 (9.9084)	Time 1.045 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:35:49,612 Epoch: [5][2874/4426]	Eit 25000  lr 0.0005  Le 9.9385 (9.9084)	Time 1.203 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:39:51,277 Epoch: [5][3074/4426]	Eit 25200  lr 0.0005  Le 9.9319 (9.9085)	Time 1.155 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:43:50,807 Epoch: [5][3274/4426]	Eit 25400  lr 0.0005  Le 9.9014 (9.9083)	Time 1.478 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:47:49,031 Epoch: [5][3474/4426]	Eit 25600  lr 0.0005  Le 9.9225 (9.9085)	Time 1.323 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:51:33,611 Epoch: [5][3674/4426]	Eit 25800  lr 0.0005  Le 9.9045 (9.9085)	Time 1.118 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:55:33,304 Epoch: [5][3874/4426]	Eit 26000  lr 0.0005  Le 9.8874 (9.9085)	Time 1.176 (0.000)	Data 0.002 (0.000)	
2021-06-20 00:59:29,825 Epoch: [5][4074/4426]	Eit 26200  lr 0.0005  Le 9.8709 (9.9085)	Time 1.146 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:03:27,062 Epoch: [5][4274/4426]	Eit 26400  lr 0.0005  Le 9.9210 (9.9085)	Time 1.169 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:06:34,775 Test: [0/40]	Le 10.1894 (10.1894)	Time 7.743 (0.000)	
2021-06-20 01:06:55,659 calculate similarity time: 0.061779022216796875
2021-06-20 01:06:56,211 Image to text: 74.3, 95.8, 98.8, 1.0, 2.6
2021-06-20 01:06:56,530 Text to image: 60.9, 89.8, 96.0, 1.0, 4.0
2021-06-20 01:06:56,530 Current rsum is 515.62
2021-06-20 01:07:00,191 runs/coco_butd_region_bert/log
2021-06-20 01:07:00,191 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 01:07:00,194 image encoder trainable parameters: 20490144
2021-06-20 01:07:00,204 txt encoder trainable parameters: 137319072
2021-06-20 01:08:06,151 Epoch: [6][49/4426]	Eit 26600  lr 0.0005  Le 9.8944 (9.9001)	Time 1.145 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:12:02,961 Epoch: [6][249/4426]	Eit 26800  lr 0.0005  Le 9.9255 (9.8995)	Time 1.235 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:16:03,003 Epoch: [6][449/4426]	Eit 27000  lr 0.0005  Le 9.8969 (9.8998)	Time 1.111 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:20:02,113 Epoch: [6][649/4426]	Eit 27200  lr 0.0005  Le 9.9062 (9.9000)	Time 1.131 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:24:01,014 Epoch: [6][849/4426]	Eit 27400  lr 0.0005  Le 9.9547 (9.9004)	Time 1.059 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:27:59,607 Epoch: [6][1049/4426]	Eit 27600  lr 0.0005  Le 9.9172 (9.9002)	Time 1.170 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:31:58,757 Epoch: [6][1249/4426]	Eit 27800  lr 0.0005  Le 9.8765 (9.9002)	Time 1.143 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:36:00,437 Epoch: [6][1449/4426]	Eit 28000  lr 0.0005  Le 9.8846 (9.9004)	Time 1.226 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:39:59,834 Epoch: [6][1649/4426]	Eit 28200  lr 0.0005  Le 9.9158 (9.9005)	Time 1.114 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:43:56,835 Epoch: [6][1849/4426]	Eit 28400  lr 0.0005  Le 9.9199 (9.9007)	Time 1.140 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:47:58,278 Epoch: [6][2049/4426]	Eit 28600  lr 0.0005  Le 9.8785 (9.9005)	Time 1.168 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:51:55,686 Epoch: [6][2249/4426]	Eit 28800  lr 0.0005  Le 9.8873 (9.9005)	Time 1.265 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:55:53,174 Epoch: [6][2449/4426]	Eit 29000  lr 0.0005  Le 9.9104 (9.9005)	Time 1.152 (0.000)	Data 0.002 (0.000)	
2021-06-20 01:59:49,239 Epoch: [6][2649/4426]	Eit 29200  lr 0.0005  Le 9.9138 (9.9005)	Time 1.085 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:03:46,517 Epoch: [6][2849/4426]	Eit 29400  lr 0.0005  Le 9.8922 (9.9005)	Time 1.148 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:07:44,954 Epoch: [6][3049/4426]	Eit 29600  lr 0.0005  Le 9.8953 (9.9005)	Time 1.367 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:11:45,401 Epoch: [6][3249/4426]	Eit 29800  lr 0.0005  Le 9.8822 (9.9005)	Time 1.332 (0.000)	Data 0.003 (0.000)	
2021-06-20 02:15:31,489 Epoch: [6][3449/4426]	Eit 30000  lr 0.0005  Le 9.9022 (9.9006)	Time 1.122 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:19:29,072 Epoch: [6][3649/4426]	Eit 30200  lr 0.0005  Le 9.8863 (9.9004)	Time 1.074 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:23:28,810 Epoch: [6][3849/4426]	Eit 30400  lr 0.0005  Le 9.8862 (9.9005)	Time 1.080 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:27:25,983 Epoch: [6][4049/4426]	Eit 30600  lr 0.0005  Le 9.8936 (9.9007)	Time 1.097 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:31:24,348 Epoch: [6][4249/4426]	Eit 30800  lr 0.0005  Le 9.9125 (9.9007)	Time 1.555 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:35:02,678 Test: [0/40]	Le 10.1871 (10.1870)	Time 7.793 (0.000)	
2021-06-20 02:35:22,716 calculate similarity time: 0.05811309814453125
2021-06-20 02:35:23,262 Image to text: 74.1, 95.6, 99.2, 1.0, 3.8
2021-06-20 02:35:23,575 Text to image: 61.3, 90.5, 96.0, 1.0, 3.9
2021-06-20 02:35:23,575 Current rsum is 516.5799999999999
2021-06-20 02:35:27,232 runs/coco_butd_region_bert/log
2021-06-20 02:35:27,232 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 02:35:27,235 image encoder trainable parameters: 20490144
2021-06-20 02:35:27,247 txt encoder trainable parameters: 137319072
2021-06-20 02:36:03,401 Epoch: [7][24/4426]	Eit 31000  lr 0.0005  Le 9.8932 (9.8891)	Time 1.370 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:40:04,403 Epoch: [7][224/4426]	Eit 31200  lr 0.0005  Le 9.9142 (9.8921)	Time 1.205 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:44:05,112 Epoch: [7][424/4426]	Eit 31400  lr 0.0005  Le 9.9031 (9.8920)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:48:06,286 Epoch: [7][624/4426]	Eit 31600  lr 0.0005  Le 9.8710 (9.8922)	Time 1.396 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:52:04,791 Epoch: [7][824/4426]	Eit 31800  lr 0.0005  Le 9.8719 (9.8929)	Time 1.292 (0.000)	Data 0.002 (0.000)	
2021-06-20 02:56:02,349 Epoch: [7][1024/4426]	Eit 32000  lr 0.0005  Le 9.9069 (9.8929)	Time 1.116 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:00:01,349 Epoch: [7][1224/4426]	Eit 32200  lr 0.0005  Le 9.8872 (9.8931)	Time 1.290 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:03:57,658 Epoch: [7][1424/4426]	Eit 32400  lr 0.0005  Le 9.9066 (9.8929)	Time 1.371 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:07:55,884 Epoch: [7][1624/4426]	Eit 32600  lr 0.0005  Le 9.8869 (9.8933)	Time 1.148 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:11:54,357 Epoch: [7][1824/4426]	Eit 32800  lr 0.0005  Le 9.8879 (9.8933)	Time 1.131 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:15:55,142 Epoch: [7][2024/4426]	Eit 33000  lr 0.0005  Le 9.8841 (9.8934)	Time 1.128 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:19:53,690 Epoch: [7][2224/4426]	Eit 33200  lr 0.0005  Le 9.8749 (9.8935)	Time 1.461 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:23:52,053 Epoch: [7][2424/4426]	Eit 33400  lr 0.0005  Le 9.8682 (9.8936)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:27:48,961 Epoch: [7][2624/4426]	Eit 33600  lr 0.0005  Le 9.9167 (9.8938)	Time 1.128 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:31:46,781 Epoch: [7][2824/4426]	Eit 33800  lr 0.0005  Le 9.8839 (9.8940)	Time 1.313 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:35:43,791 Epoch: [7][3024/4426]	Eit 34000  lr 0.0005  Le 9.8693 (9.8940)	Time 1.178 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:39:30,047 Epoch: [7][3224/4426]	Eit 34200  lr 0.0005  Le 9.9097 (9.8942)	Time 1.144 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:43:30,706 Epoch: [7][3424/4426]	Eit 34400  lr 0.0005  Le 9.8665 (9.8941)	Time 1.136 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:47:30,666 Epoch: [7][3624/4426]	Eit 34600  lr 0.0005  Le 9.9040 (9.8940)	Time 1.136 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:51:32,179 Epoch: [7][3824/4426]	Eit 34800  lr 0.0005  Le 9.8955 (9.8940)	Time 1.046 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:55:31,970 Epoch: [7][4024/4426]	Eit 35000  lr 0.0005  Le 9.9014 (9.8938)	Time 1.424 (0.000)	Data 0.002 (0.000)	
2021-06-20 03:59:33,048 Epoch: [7][4224/4426]	Eit 35200  lr 0.0005  Le 9.8859 (9.8938)	Time 1.130 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:03:33,485 Epoch: [7][4424/4426]	Eit 35400  lr 0.0005  Le 9.9050 (9.8938)	Time 1.166 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:03:42,589 Test: [0/40]	Le 10.1918 (10.1918)	Time 7.779 (0.000)	
2021-06-20 04:04:03,564 calculate similarity time: 0.07617712020874023
2021-06-20 04:04:04,118 Image to text: 74.7, 95.6, 98.7, 1.0, 1.9
2021-06-20 04:04:04,556 Text to image: 60.6, 91.0, 96.1, 1.0, 4.0
2021-06-20 04:04:04,557 Current rsum is 516.62
2021-06-20 04:04:08,213 runs/coco_butd_region_bert/log
2021-06-20 04:04:08,213 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 04:04:08,216 image encoder trainable parameters: 20490144
2021-06-20 04:04:08,228 txt encoder trainable parameters: 137319072
2021-06-20 04:08:08,268 Epoch: [8][199/4426]	Eit 35600  lr 0.0005  Le 9.8925 (9.8864)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:12:04,661 Epoch: [8][399/4426]	Eit 35800  lr 0.0005  Le 9.8813 (9.8853)	Time 1.050 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:16:03,846 Epoch: [8][599/4426]	Eit 36000  lr 0.0005  Le 9.8715 (9.8856)	Time 1.083 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:19:59,666 Epoch: [8][799/4426]	Eit 36200  lr 0.0005  Le 9.9210 (9.8857)	Time 1.096 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:23:58,356 Epoch: [8][999/4426]	Eit 36400  lr 0.0005  Le 9.8881 (9.8860)	Time 1.144 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:27:58,901 Epoch: [8][1199/4426]	Eit 36600  lr 0.0005  Le 9.8821 (9.8861)	Time 1.144 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:31:55,731 Epoch: [8][1399/4426]	Eit 36800  lr 0.0005  Le 9.8879 (9.8862)	Time 1.152 (0.000)	Data 0.003 (0.000)	
2021-06-20 04:35:54,500 Epoch: [8][1599/4426]	Eit 37000  lr 0.0005  Le 9.8705 (9.8865)	Time 1.233 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:39:54,024 Epoch: [8][1799/4426]	Eit 37200  lr 0.0005  Le 9.8735 (9.8866)	Time 1.184 (0.000)	Data 0.009 (0.000)	
2021-06-20 04:43:49,367 Epoch: [8][1999/4426]	Eit 37400  lr 0.0005  Le 9.8947 (9.8867)	Time 1.321 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:47:48,176 Epoch: [8][2199/4426]	Eit 37600  lr 0.0005  Le 9.9208 (9.8869)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:51:46,708 Epoch: [8][2399/4426]	Eit 37800  lr 0.0005  Le 9.8914 (9.8869)	Time 1.081 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:55:45,539 Epoch: [8][2599/4426]	Eit 38000  lr 0.0005  Le 9.9156 (9.8868)	Time 1.236 (0.000)	Data 0.002 (0.000)	
2021-06-20 04:59:46,396 Epoch: [8][2799/4426]	Eit 38200  lr 0.0005  Le 9.8972 (9.8870)	Time 1.081 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:03:34,952 Epoch: [8][2999/4426]	Eit 38400  lr 0.0005  Le 9.9238 (9.8871)	Time 1.333 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:07:36,173 Epoch: [8][3199/4426]	Eit 38600  lr 0.0005  Le 9.8761 (9.8873)	Time 1.168 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:11:33,530 Epoch: [8][3399/4426]	Eit 38800  lr 0.0005  Le 9.8704 (9.8873)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:15:31,856 Epoch: [8][3599/4426]	Eit 39000  lr 0.0005  Le 9.9055 (9.8876)	Time 1.124 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:19:28,304 Epoch: [8][3799/4426]	Eit 39200  lr 0.0005  Le 9.8646 (9.8876)	Time 1.231 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:23:24,373 Epoch: [8][3999/4426]	Eit 39400  lr 0.0005  Le 9.8701 (9.8878)	Time 1.190 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:27:25,152 Epoch: [8][4199/4426]	Eit 39600  lr 0.0005  Le 9.8741 (9.8878)	Time 1.114 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:31:25,895 Epoch: [8][4399/4426]	Eit 39800  lr 0.0005  Le 9.8859 (9.8879)	Time 1.093 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:32:05,185 Test: [0/40]	Le 10.1946 (10.1946)	Time 8.095 (0.000)	
2021-06-20 05:32:25,337 calculate similarity time: 0.06844496726989746
2021-06-20 05:32:25,763 Image to text: 74.8, 95.8, 98.9, 1.0, 3.8
2021-06-20 05:32:26,089 Text to image: 61.0, 90.6, 96.1, 1.0, 4.2
2021-06-20 05:32:26,089 Current rsum is 517.22
2021-06-20 05:32:29,798 runs/coco_butd_region_bert/log
2021-06-20 05:32:29,799 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 05:32:29,802 image encoder trainable parameters: 20490144
2021-06-20 05:32:29,813 txt encoder trainable parameters: 137319072
2021-06-20 05:36:01,713 Epoch: [9][174/4426]	Eit 40000  lr 0.0005  Le 9.8931 (9.8786)	Time 1.125 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:40:00,797 Epoch: [9][374/4426]	Eit 40200  lr 0.0005  Le 9.8944 (9.8795)	Time 1.124 (0.000)	Data 0.003 (0.000)	
2021-06-20 05:43:57,143 Epoch: [9][574/4426]	Eit 40400  lr 0.0005  Le 9.8867 (9.8797)	Time 1.245 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:47:58,272 Epoch: [9][774/4426]	Eit 40600  lr 0.0005  Le 9.8658 (9.8799)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:51:53,330 Epoch: [9][974/4426]	Eit 40800  lr 0.0005  Le 9.8818 (9.8803)	Time 1.175 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:55:50,482 Epoch: [9][1174/4426]	Eit 41000  lr 0.0005  Le 9.9021 (9.8806)	Time 1.115 (0.000)	Data 0.002 (0.000)	
2021-06-20 05:59:47,343 Epoch: [9][1374/4426]	Eit 41200  lr 0.0005  Le 9.8523 (9.8810)	Time 1.125 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:03:45,755 Epoch: [9][1574/4426]	Eit 41400  lr 0.0005  Le 9.8717 (9.8809)	Time 1.429 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:07:44,032 Epoch: [9][1774/4426]	Eit 41600  lr 0.0005  Le 9.8738 (9.8810)	Time 1.008 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:11:40,458 Epoch: [9][1974/4426]	Eit 41800  lr 0.0005  Le 9.8679 (9.8814)	Time 1.245 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:15:40,417 Epoch: [9][2174/4426]	Eit 42000  lr 0.0005  Le 9.8489 (9.8815)	Time 1.092 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:19:36,600 Epoch: [9][2374/4426]	Eit 42200  lr 0.0005  Le 9.8825 (9.8816)	Time 1.168 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:23:37,366 Epoch: [9][2574/4426]	Eit 42400  lr 0.0005  Le 9.8801 (9.8818)	Time 1.200 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:27:20,486 Epoch: [9][2774/4426]	Eit 42600  lr 0.0005  Le 9.8509 (9.8819)	Time 1.245 (0.000)	Data 0.004 (0.000)	
2021-06-20 06:31:18,241 Epoch: [9][2974/4426]	Eit 42800  lr 0.0005  Le 9.8809 (9.8822)	Time 1.156 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:35:15,978 Epoch: [9][3174/4426]	Eit 43000  lr 0.0005  Le 9.8233 (9.8823)	Time 1.133 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:39:14,368 Epoch: [9][3374/4426]	Eit 43200  lr 0.0005  Le 9.8973 (9.8824)	Time 1.224 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:43:11,768 Epoch: [9][3574/4426]	Eit 43400  lr 0.0005  Le 9.8906 (9.8823)	Time 1.199 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:47:14,080 Epoch: [9][3774/4426]	Eit 43600  lr 0.0005  Le 9.8950 (9.8823)	Time 1.768 (0.000)	Data 0.003 (0.000)	
2021-06-20 06:51:11,406 Epoch: [9][3974/4426]	Eit 43800  lr 0.0005  Le 9.8821 (9.8823)	Time 1.171 (0.000)	Data 0.003 (0.000)	
2021-06-20 06:55:08,671 Epoch: [9][4174/4426]	Eit 44000  lr 0.0005  Le 9.8857 (9.8823)	Time 1.142 (0.000)	Data 0.002 (0.000)	
2021-06-20 06:59:08,344 Epoch: [9][4374/4426]	Eit 44200  lr 0.0005  Le 9.8885 (9.8823)	Time 1.102 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:00:16,978 Test: [0/40]	Le 10.1892 (10.1892)	Time 7.947 (0.000)	
2021-06-20 07:00:38,226 calculate similarity time: 0.07955121994018555
2021-06-20 07:00:38,747 Image to text: 77.6, 96.4, 99.0, 1.0, 3.9
2021-06-20 07:00:39,126 Text to image: 61.4, 90.6, 95.8, 1.0, 4.2
2021-06-20 07:00:39,126 Current rsum is 520.74
2021-06-20 07:00:42,833 runs/coco_butd_region_bert/log
2021-06-20 07:00:42,833 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 07:00:42,837 image encoder trainable parameters: 20490144
2021-06-20 07:00:42,847 txt encoder trainable parameters: 137319072
2021-06-20 07:03:45,165 Epoch: [10][149/4426]	Eit 44400  lr 0.0005  Le 9.8899 (9.8743)	Time 1.329 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:07:41,910 Epoch: [10][349/4426]	Eit 44600  lr 0.0005  Le 9.9020 (9.8760)	Time 1.096 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:11:40,228 Epoch: [10][549/4426]	Eit 44800  lr 0.0005  Le 9.8718 (9.8757)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:15:35,892 Epoch: [10][749/4426]	Eit 45000  lr 0.0005  Le 9.8570 (9.8759)	Time 1.271 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:19:33,618 Epoch: [10][949/4426]	Eit 45200  lr 0.0005  Le 9.8587 (9.8760)	Time 1.078 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:23:29,787 Epoch: [10][1149/4426]	Eit 45400  lr 0.0005  Le 9.8706 (9.8763)	Time 1.105 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:27:27,128 Epoch: [10][1349/4426]	Eit 45600  lr 0.0005  Le 9.9096 (9.8767)	Time 1.124 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:31:23,901 Epoch: [10][1549/4426]	Eit 45800  lr 0.0005  Le 9.9068 (9.8767)	Time 1.108 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:35:21,468 Epoch: [10][1749/4426]	Eit 46000  lr 0.0005  Le 9.8944 (9.8767)	Time 1.125 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:39:19,469 Epoch: [10][1949/4426]	Eit 46200  lr 0.0005  Le 9.8597 (9.8769)	Time 1.086 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:43:17,646 Epoch: [10][2149/4426]	Eit 46400  lr 0.0005  Le 9.8450 (9.8768)	Time 1.137 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:47:15,147 Epoch: [10][2349/4426]	Eit 46600  lr 0.0005  Le 9.8509 (9.8769)	Time 1.214 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:50:58,965 Epoch: [10][2549/4426]	Eit 46800  lr 0.0005  Le 9.8918 (9.8770)	Time 1.433 (0.000)	Data 0.002 (0.000)	
2021-06-20 07:54:57,404 Epoch: [10][2749/4426]	Eit 47000  lr 0.0005  Le 9.8710 (9.8771)	Time 1.082 (0.000)	Data 0.003 (0.000)	
2021-06-20 07:58:54,270 Epoch: [10][2949/4426]	Eit 47200  lr 0.0005  Le 9.8674 (9.8772)	Time 1.364 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:02:51,868 Epoch: [10][3149/4426]	Eit 47400  lr 0.0005  Le 9.8685 (9.8772)	Time 1.324 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:06:48,307 Epoch: [10][3349/4426]	Eit 47600  lr 0.0005  Le 9.8666 (9.8773)	Time 1.121 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:10:46,782 Epoch: [10][3549/4426]	Eit 47800  lr 0.0005  Le 9.8823 (9.8773)	Time 1.123 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:14:44,304 Epoch: [10][3749/4426]	Eit 48000  lr 0.0005  Le 9.8590 (9.8773)	Time 1.178 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:18:41,379 Epoch: [10][3949/4426]	Eit 48200  lr 0.0005  Le 9.8888 (9.8772)	Time 1.067 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:22:40,824 Epoch: [10][4149/4426]	Eit 48400  lr 0.0005  Le 9.8637 (9.8773)	Time 1.271 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:26:39,777 Epoch: [10][4349/4426]	Eit 48600  lr 0.0005  Le 9.8823 (9.8773)	Time 1.081 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:28:17,707 Test: [0/40]	Le 10.1946 (10.1946)	Time 7.695 (0.000)	
2021-06-20 08:28:37,252 calculate similarity time: 0.06441521644592285
2021-06-20 08:28:37,813 Image to text: 77.1, 95.8, 99.1, 1.0, 2.3
2021-06-20 08:28:38,142 Text to image: 61.9, 91.0, 96.3, 1.0, 4.2
2021-06-20 08:28:38,142 Current rsum is 521.1800000000001
2021-06-20 08:28:41,810 runs/coco_butd_region_bert/log
2021-06-20 08:28:41,810 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 08:28:41,814 image encoder trainable parameters: 20490144
2021-06-20 08:28:41,826 txt encoder trainable parameters: 137319072
2021-06-20 08:31:16,706 Epoch: [11][124/4426]	Eit 48800  lr 0.0005  Le 9.8956 (9.8709)	Time 1.305 (0.000)	Data 0.003 (0.000)	
2021-06-20 08:35:12,678 Epoch: [11][324/4426]	Eit 49000  lr 0.0005  Le 9.8505 (9.8703)	Time 1.115 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:39:10,709 Epoch: [11][524/4426]	Eit 49200  lr 0.0005  Le 9.8769 (9.8718)	Time 1.103 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:43:07,071 Epoch: [11][724/4426]	Eit 49400  lr 0.0005  Le 9.8742 (9.8717)	Time 1.102 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:47:05,258 Epoch: [11][924/4426]	Eit 49600  lr 0.0005  Le 9.8572 (9.8714)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:51:03,060 Epoch: [11][1124/4426]	Eit 49800  lr 0.0005  Le 9.8677 (9.8715)	Time 1.159 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:55:01,883 Epoch: [11][1324/4426]	Eit 50000  lr 0.0005  Le 9.8572 (9.8715)	Time 1.120 (0.000)	Data 0.002 (0.000)	
2021-06-20 08:58:58,034 Epoch: [11][1524/4426]	Eit 50200  lr 0.0005  Le 9.9033 (9.8718)	Time 1.117 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:02:54,570 Epoch: [11][1724/4426]	Eit 50400  lr 0.0005  Le 9.8749 (9.8719)	Time 1.129 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:06:53,031 Epoch: [11][1924/4426]	Eit 50600  lr 0.0005  Le 9.8659 (9.8721)	Time 1.061 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:10:50,044 Epoch: [11][2124/4426]	Eit 50800  lr 0.0005  Le 9.8622 (9.8721)	Time 1.396 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:14:38,455 Epoch: [11][2324/4426]	Eit 51000  lr 0.0005  Le 9.8782 (9.8724)	Time 1.355 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:18:35,744 Epoch: [11][2524/4426]	Eit 51200  lr 0.0005  Le 9.9147 (9.8725)	Time 1.068 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:22:34,440 Epoch: [11][2724/4426]	Eit 51400  lr 0.0005  Le 9.8454 (9.8725)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:26:32,689 Epoch: [11][2924/4426]	Eit 51600  lr 0.0005  Le 9.8787 (9.8727)	Time 1.110 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:30:31,151 Epoch: [11][3124/4426]	Eit 51800  lr 0.0005  Le 9.8400 (9.8728)	Time 1.086 (0.000)	Data 0.003 (0.000)	
2021-06-20 09:34:26,798 Epoch: [11][3324/4426]	Eit 52000  lr 0.0005  Le 9.9045 (9.8728)	Time 1.127 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:38:24,904 Epoch: [11][3524/4426]	Eit 52200  lr 0.0005  Le 9.8986 (9.8729)	Time 1.337 (0.000)	Data 0.003 (0.000)	
2021-06-20 09:42:21,743 Epoch: [11][3724/4426]	Eit 52400  lr 0.0005  Le 9.8701 (9.8729)	Time 1.125 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:46:20,178 Epoch: [11][3924/4426]	Eit 52600  lr 0.0005  Le 9.8924 (9.8730)	Time 1.144 (0.000)	Data 0.003 (0.000)	
2021-06-20 09:50:16,785 Epoch: [11][4124/4426]	Eit 52800  lr 0.0005  Le 9.9001 (9.8730)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:54:14,565 Epoch: [11][4324/4426]	Eit 53000  lr 0.0005  Le 9.8281 (9.8730)	Time 1.347 (0.000)	Data 0.002 (0.000)	
2021-06-20 09:56:19,603 Test: [0/40]	Le 10.1995 (10.1995)	Time 7.746 (0.000)	
2021-06-20 09:56:39,089 calculate similarity time: 0.08941507339477539
2021-06-20 09:56:39,511 Image to text: 75.1, 95.9, 99.0, 1.0, 3.1
2021-06-20 09:56:39,838 Text to image: 62.4, 90.7, 96.1, 1.0, 4.6
2021-06-20 09:56:39,838 Current rsum is 519.16
2021-06-20 09:56:41,324 runs/coco_butd_region_bert/log
2021-06-20 09:56:41,324 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 09:56:41,325 image encoder trainable parameters: 20490144
2021-06-20 09:56:41,330 txt encoder trainable parameters: 137319072
2021-06-20 09:58:47,103 Epoch: [12][99/4426]	Eit 53200  lr 0.0005  Le 9.8349 (9.8660)	Time 1.114 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:02:46,226 Epoch: [12][299/4426]	Eit 53400  lr 0.0005  Le 9.8472 (9.8671)	Time 1.095 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:06:42,154 Epoch: [12][499/4426]	Eit 53600  lr 0.0005  Le 9.8728 (9.8672)	Time 1.137 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:10:40,941 Epoch: [12][699/4426]	Eit 53800  lr 0.0005  Le 9.8617 (9.8675)	Time 1.224 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:14:40,258 Epoch: [12][899/4426]	Eit 54000  lr 0.0005  Le 9.8860 (9.8675)	Time 1.209 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:18:38,330 Epoch: [12][1099/4426]	Eit 54200  lr 0.0005  Le 9.8605 (9.8674)	Time 1.132 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:22:33,637 Epoch: [12][1299/4426]	Eit 54400  lr 0.0005  Le 9.8504 (9.8677)	Time 1.304 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:26:31,568 Epoch: [12][1499/4426]	Eit 54600  lr 0.0005  Le 9.8749 (9.8676)	Time 1.152 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:30:29,167 Epoch: [12][1699/4426]	Eit 54800  lr 0.0005  Le 9.8737 (9.8675)	Time 1.158 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:34:27,858 Epoch: [12][1899/4426]	Eit 55000  lr 0.0005  Le 9.8844 (9.8681)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:38:12,369 Epoch: [12][2099/4426]	Eit 55200  lr 0.0005  Le 9.8894 (9.8682)	Time 1.059 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:42:12,640 Epoch: [12][2299/4426]	Eit 55400  lr 0.0005  Le 9.8693 (9.8681)	Time 1.144 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:46:09,407 Epoch: [12][2499/4426]	Eit 55600  lr 0.0005  Le 9.8680 (9.8680)	Time 1.160 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:50:09,695 Epoch: [12][2699/4426]	Eit 55800  lr 0.0005  Le 9.8626 (9.8683)	Time 1.135 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:54:10,134 Epoch: [12][2899/4426]	Eit 56000  lr 0.0005  Le 9.8912 (9.8684)	Time 1.148 (0.000)	Data 0.002 (0.000)	
2021-06-20 10:58:07,513 Epoch: [12][3099/4426]	Eit 56200  lr 0.0005  Le 9.9046 (9.8687)	Time 1.143 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:02:08,199 Epoch: [12][3299/4426]	Eit 56400  lr 0.0005  Le 9.8773 (9.8687)	Time 1.058 (0.000)	Data 0.003 (0.000)	
2021-06-20 11:06:05,636 Epoch: [12][3499/4426]	Eit 56600  lr 0.0005  Le 9.8842 (9.8688)	Time 1.119 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:10:03,885 Epoch: [12][3699/4426]	Eit 56800  lr 0.0005  Le 9.8656 (9.8688)	Time 1.138 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:14:02,480 Epoch: [12][3899/4426]	Eit 57000  lr 0.0005  Le 9.9027 (9.8689)	Time 1.128 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:18:00,903 Epoch: [12][4099/4426]	Eit 57200  lr 0.0005  Le 9.8584 (9.8690)	Time 1.271 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:21:58,782 Epoch: [12][4299/4426]	Eit 57400  lr 0.0005  Le 9.8493 (9.8692)	Time 1.315 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:24:38,794 Test: [0/40]	Le 10.1937 (10.1937)	Time 7.913 (0.000)	
2021-06-20 11:24:59,734 calculate similarity time: 0.07213830947875977
2021-06-20 11:25:00,310 Image to text: 74.9, 96.1, 98.9, 1.0, 2.4
2021-06-20 11:25:00,669 Text to image: 62.5, 90.5, 96.1, 1.0, 4.5
2021-06-20 11:25:00,670 Current rsum is 518.9599999999999
2021-06-20 11:25:02,112 runs/coco_butd_region_bert/log
2021-06-20 11:25:02,112 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 11:25:02,114 image encoder trainable parameters: 20490144
2021-06-20 11:25:02,119 txt encoder trainable parameters: 137319072
2021-06-20 11:26:36,298 Epoch: [13][74/4426]	Eit 57600  lr 0.0005  Le 9.8855 (9.8628)	Time 1.096 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:30:35,803 Epoch: [13][274/4426]	Eit 57800  lr 0.0005  Le 9.8638 (9.8644)	Time 1.167 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:34:33,362 Epoch: [13][474/4426]	Eit 58000  lr 0.0005  Le 9.9171 (9.8639)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:38:30,872 Epoch: [13][674/4426]	Eit 58200  lr 0.0005  Le 9.8523 (9.8629)	Time 1.141 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:42:26,141 Epoch: [13][874/4426]	Eit 58400  lr 0.0005  Le 9.8697 (9.8632)	Time 1.123 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:46:26,944 Epoch: [13][1074/4426]	Eit 58600  lr 0.0005  Le 9.8376 (9.8630)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:50:23,784 Epoch: [13][1274/4426]	Eit 58800  lr 0.0005  Le 9.8444 (9.8630)	Time 1.206 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:54:20,335 Epoch: [13][1474/4426]	Eit 59000  lr 0.0005  Le 9.8560 (9.8631)	Time 1.415 (0.000)	Data 0.002 (0.000)	
2021-06-20 11:58:18,673 Epoch: [13][1674/4426]	Eit 59200  lr 0.0005  Le 9.8827 (9.8634)	Time 1.354 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:02:05,666 Epoch: [13][1874/4426]	Eit 59400  lr 0.0005  Le 9.8611 (9.8634)	Time 1.135 (0.000)	Data 0.003 (0.000)	
2021-06-20 12:06:03,405 Epoch: [13][2074/4426]	Eit 59600  lr 0.0005  Le 9.8574 (9.8634)	Time 1.038 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:10:00,517 Epoch: [13][2274/4426]	Eit 59800  lr 0.0005  Le 9.8220 (9.8635)	Time 1.164 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:14:01,533 Epoch: [13][2474/4426]	Eit 60000  lr 0.0005  Le 9.9235 (9.8638)	Time 1.391 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:18:02,314 Epoch: [13][2674/4426]	Eit 60200  lr 0.0005  Le 9.9045 (9.8640)	Time 1.328 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:22:00,696 Epoch: [13][2874/4426]	Eit 60400  lr 0.0005  Le 9.8784 (9.8643)	Time 1.206 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:26:00,144 Epoch: [13][3074/4426]	Eit 60600  lr 0.0005  Le 9.8513 (9.8643)	Time 1.202 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:30:00,082 Epoch: [13][3274/4426]	Eit 60800  lr 0.0005  Le 9.8312 (9.8643)	Time 1.424 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:33:57,017 Epoch: [13][3474/4426]	Eit 61000  lr 0.0005  Le 9.8494 (9.8643)	Time 1.378 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:37:56,244 Epoch: [13][3674/4426]	Eit 61200  lr 0.0005  Le 9.8261 (9.8644)	Time 1.307 (0.000)	Data 0.003 (0.000)	
2021-06-20 12:41:53,088 Epoch: [13][3874/4426]	Eit 61400  lr 0.0005  Le 9.8788 (9.8642)	Time 1.337 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:45:51,195 Epoch: [13][4074/4426]	Eit 61600  lr 0.0005  Le 9.8768 (9.8644)	Time 1.294 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:49:49,004 Epoch: [13][4274/4426]	Eit 61800  lr 0.0005  Le 9.8666 (9.8645)	Time 1.073 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:52:57,608 Test: [0/40]	Le 10.1905 (10.1905)	Time 7.856 (0.000)	
2021-06-20 12:53:17,900 calculate similarity time: 0.06976962089538574
2021-06-20 12:53:18,399 Image to text: 76.3, 94.9, 98.6, 1.0, 2.5
2021-06-20 12:53:18,750 Text to image: 62.7, 91.0, 96.1, 1.0, 4.2
2021-06-20 12:53:18,750 Current rsum is 519.6199999999999
2021-06-20 12:53:20,198 runs/coco_butd_region_bert/log
2021-06-20 12:53:20,198 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 12:53:20,200 image encoder trainable parameters: 20490144
2021-06-20 12:53:20,205 txt encoder trainable parameters: 137319072
2021-06-20 12:54:26,600 Epoch: [14][49/4426]	Eit 62000  lr 0.0005  Le 9.8604 (9.8565)	Time 1.373 (0.000)	Data 0.002 (0.000)	
2021-06-20 12:58:23,371 Epoch: [14][249/4426]	Eit 62200  lr 0.0005  Le 9.8443 (9.8590)	Time 1.125 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:02:22,141 Epoch: [14][449/4426]	Eit 62400  lr 0.0005  Le 9.8620 (9.8583)	Time 1.157 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:06:19,844 Epoch: [14][649/4426]	Eit 62600  lr 0.0005  Le 9.8496 (9.8581)	Time 1.185 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:10:17,447 Epoch: [14][849/4426]	Eit 62800  lr 0.0005  Le 9.8727 (9.8580)	Time 1.349 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:14:19,038 Epoch: [14][1049/4426]	Eit 63000  lr 0.0005  Le 9.8477 (9.8583)	Time 1.197 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:18:18,163 Epoch: [14][1249/4426]	Eit 63200  lr 0.0005  Le 9.9020 (9.8587)	Time 1.231 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:22:17,878 Epoch: [14][1449/4426]	Eit 63400  lr 0.0005  Le 9.8558 (9.8589)	Time 1.148 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:26:04,032 Epoch: [14][1649/4426]	Eit 63600  lr 0.0005  Le 9.8186 (9.8589)	Time 1.100 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:30:03,835 Epoch: [14][1849/4426]	Eit 63800  lr 0.0005  Le 9.8593 (9.8592)	Time 1.288 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:34:00,655 Epoch: [14][2049/4426]	Eit 64000  lr 0.0005  Le 9.8531 (9.8593)	Time 1.205 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:37:59,702 Epoch: [14][2249/4426]	Eit 64200  lr 0.0005  Le 9.8425 (9.8593)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:41:58,206 Epoch: [14][2449/4426]	Eit 64400  lr 0.0005  Le 9.8231 (9.8595)	Time 1.187 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:45:57,423 Epoch: [14][2649/4426]	Eit 64600  lr 0.0005  Le 9.8169 (9.8597)	Time 1.127 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:49:54,580 Epoch: [14][2849/4426]	Eit 64800  lr 0.0005  Le 9.8390 (9.8597)	Time 1.030 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:53:57,518 Epoch: [14][3049/4426]	Eit 65000  lr 0.0005  Le 9.8757 (9.8599)	Time 1.297 (0.000)	Data 0.002 (0.000)	
2021-06-20 13:57:57,053 Epoch: [14][3249/4426]	Eit 65200  lr 0.0005  Le 9.8710 (9.8602)	Time 1.137 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:01:53,018 Epoch: [14][3449/4426]	Eit 65400  lr 0.0005  Le 9.8481 (9.8602)	Time 1.154 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:05:51,119 Epoch: [14][3649/4426]	Eit 65600  lr 0.0005  Le 9.8804 (9.8602)	Time 1.059 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:09:51,402 Epoch: [14][3849/4426]	Eit 65800  lr 0.0005  Le 9.8401 (9.8603)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:13:48,647 Epoch: [14][4049/4426]	Eit 66000  lr 0.0005  Le 9.8457 (9.8602)	Time 1.147 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:17:47,297 Epoch: [14][4249/4426]	Eit 66200  lr 0.0005  Le 9.8752 (9.8601)	Time 1.189 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:21:24,662 Test: [0/40]	Le 10.1898 (10.1898)	Time 7.862 (0.000)	
2021-06-20 14:21:45,812 calculate similarity time: 0.0701894760131836
2021-06-20 14:21:46,367 Image to text: 74.1, 95.7, 99.0, 1.0, 2.7
2021-06-20 14:21:46,707 Text to image: 63.0, 91.0, 96.4, 1.0, 4.5
2021-06-20 14:21:46,707 Current rsum is 519.26
2021-06-20 14:21:48,189 runs/coco_butd_region_bert/log
2021-06-20 14:21:48,189 runs/coco_butd_region_bert
2021-06-20 14:21:48,189 Current epoch num is 15, decrease all lr by 10
2021-06-20 14:21:48,189 new lr 5e-05
2021-06-20 14:21:48,189 new lr 5e-06
2021-06-20 14:21:48,189 new lr 5e-05
Use VSE++ objective.
2021-06-20 14:21:48,191 image encoder trainable parameters: 20490144
2021-06-20 14:21:48,197 txt encoder trainable parameters: 137319072
2021-06-20 14:22:25,362 Epoch: [15][24/4426]	Eit 66400  lr 5e-05  Le 9.8521 (9.8512)	Time 1.179 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:26:20,207 Epoch: [15][224/4426]	Eit 66600  lr 5e-05  Le 9.8416 (9.8503)	Time 1.141 (0.000)	Data 0.003 (0.000)	
2021-06-20 14:30:17,809 Epoch: [15][424/4426]	Eit 66800  lr 5e-05  Le 9.8450 (9.8490)	Time 1.399 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:34:15,811 Epoch: [15][624/4426]	Eit 67000  lr 5e-05  Le 9.8632 (9.8482)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:38:12,446 Epoch: [15][824/4426]	Eit 67200  lr 5e-05  Le 9.8364 (9.8474)	Time 1.110 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:42:12,732 Epoch: [15][1024/4426]	Eit 67400  lr 5e-05  Le 9.8350 (9.8466)	Time 1.120 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:46:10,146 Epoch: [15][1224/4426]	Eit 67600  lr 5e-05  Le 9.8435 (9.8465)	Time 1.084 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:49:57,848 Epoch: [15][1424/4426]	Eit 67800  lr 5e-05  Le 9.8621 (9.8461)	Time 1.277 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:53:57,839 Epoch: [15][1624/4426]	Eit 68000  lr 5e-05  Le 9.8504 (9.8458)	Time 1.160 (0.000)	Data 0.002 (0.000)	
2021-06-20 14:57:57,933 Epoch: [15][1824/4426]	Eit 68200  lr 5e-05  Le 9.8690 (9.8452)	Time 1.236 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:01:56,029 Epoch: [15][2024/4426]	Eit 68400  lr 5e-05  Le 9.8250 (9.8450)	Time 1.314 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:05:55,191 Epoch: [15][2224/4426]	Eit 68600  lr 5e-05  Le 9.8488 (9.8448)	Time 1.187 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:09:52,143 Epoch: [15][2424/4426]	Eit 68800  lr 5e-05  Le 9.7982 (9.8445)	Time 1.337 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:13:55,429 Epoch: [15][2624/4426]	Eit 69000  lr 5e-05  Le 9.8303 (9.8443)	Time 1.166 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:17:55,237 Epoch: [15][2824/4426]	Eit 69200  lr 5e-05  Le 9.8593 (9.8441)	Time 1.076 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:21:51,342 Epoch: [15][3024/4426]	Eit 69400  lr 5e-05  Le 9.8502 (9.8437)	Time 1.140 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:25:48,448 Epoch: [15][3224/4426]	Eit 69600  lr 5e-05  Le 9.8199 (9.8435)	Time 1.294 (0.000)	Data 0.003 (0.000)	
2021-06-20 15:29:45,129 Epoch: [15][3424/4426]	Eit 69800  lr 5e-05  Le 9.8445 (9.8434)	Time 1.142 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:33:44,846 Epoch: [15][3624/4426]	Eit 70000  lr 5e-05  Le 9.8161 (9.8431)	Time 1.283 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:37:42,135 Epoch: [15][3824/4426]	Eit 70200  lr 5e-05  Le 9.8334 (9.8428)	Time 1.111 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:41:39,456 Epoch: [15][4024/4426]	Eit 70400  lr 5e-05  Le 9.8909 (9.8427)	Time 1.048 (0.000)	Data 0.003 (0.000)	
2021-06-20 15:45:39,237 Epoch: [15][4224/4426]	Eit 70600  lr 5e-05  Le 9.8046 (9.8426)	Time 1.382 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:49:37,226 Epoch: [15][4424/4426]	Eit 70800  lr 5e-05  Le 9.8696 (9.8424)	Time 1.525 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:49:46,104 Test: [0/40]	Le 10.1918 (10.1918)	Time 7.640 (0.000)	
2021-06-20 15:50:06,228 calculate similarity time: 0.09954023361206055
2021-06-20 15:50:06,754 Image to text: 75.8, 96.5, 99.0, 1.0, 2.7
2021-06-20 15:50:07,075 Text to image: 64.3, 92.0, 96.5, 1.0, 4.4
2021-06-20 15:50:07,075 Current rsum is 524.0
2021-06-20 15:50:10,741 runs/coco_butd_region_bert/log
2021-06-20 15:50:10,741 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 15:50:10,744 image encoder trainable parameters: 20490144
2021-06-20 15:50:10,754 txt encoder trainable parameters: 137319072
2021-06-20 15:54:15,839 Epoch: [16][199/4426]	Eit 71000  lr 5e-05  Le 9.8311 (9.8394)	Time 1.421 (0.000)	Data 0.002 (0.000)	
2021-06-20 15:58:13,335 Epoch: [16][399/4426]	Eit 71200  lr 5e-05  Le 9.8497 (9.8388)	Time 1.136 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:02:08,632 Epoch: [16][599/4426]	Eit 71400  lr 5e-05  Le 9.8069 (9.8376)	Time 1.051 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:06:05,727 Epoch: [16][799/4426]	Eit 71600  lr 5e-05  Le 9.8534 (9.8375)	Time 1.086 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:10:03,252 Epoch: [16][999/4426]	Eit 71800  lr 5e-05  Le 9.8200 (9.8376)	Time 1.189 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:13:47,608 Epoch: [16][1199/4426]	Eit 72000  lr 5e-05  Le 9.8562 (9.8374)	Time 1.090 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:17:46,175 Epoch: [16][1399/4426]	Eit 72200  lr 5e-05  Le 9.8368 (9.8375)	Time 1.170 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:21:43,944 Epoch: [16][1599/4426]	Eit 72400  lr 5e-05  Le 9.8570 (9.8376)	Time 1.153 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:25:42,513 Epoch: [16][1799/4426]	Eit 72600  lr 5e-05  Le 9.8473 (9.8372)	Time 1.234 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:29:40,815 Epoch: [16][1999/4426]	Eit 72800  lr 5e-05  Le 9.8350 (9.8372)	Time 1.253 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:33:38,425 Epoch: [16][2199/4426]	Eit 73000  lr 5e-05  Le 9.8310 (9.8375)	Time 1.103 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:37:36,210 Epoch: [16][2399/4426]	Eit 73200  lr 5e-05  Le 9.8522 (9.8374)	Time 1.169 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:41:35,555 Epoch: [16][2599/4426]	Eit 73400  lr 5e-05  Le 9.8664 (9.8373)	Time 1.233 (0.000)	Data 0.008 (0.000)	
2021-06-20 16:45:34,224 Epoch: [16][2799/4426]	Eit 73600  lr 5e-05  Le 9.8263 (9.8372)	Time 1.100 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:49:30,406 Epoch: [16][2999/4426]	Eit 73800  lr 5e-05  Le 9.8277 (9.8371)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:53:28,343 Epoch: [16][3199/4426]	Eit 74000  lr 5e-05  Le 9.8354 (9.8369)	Time 1.131 (0.000)	Data 0.002 (0.000)	
2021-06-20 16:57:27,975 Epoch: [16][3399/4426]	Eit 74200  lr 5e-05  Le 9.8003 (9.8368)	Time 1.160 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:01:25,504 Epoch: [16][3599/4426]	Eit 74400  lr 5e-05  Le 9.8543 (9.8367)	Time 1.684 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:05:22,937 Epoch: [16][3799/4426]	Eit 74600  lr 5e-05  Le 9.8493 (9.8367)	Time 1.235 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:09:22,190 Epoch: [16][3999/4426]	Eit 74800  lr 5e-05  Le 9.8714 (9.8366)	Time 1.178 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:13:22,769 Epoch: [16][4199/4426]	Eit 75000  lr 5e-05  Le 9.8288 (9.8365)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:17:18,719 Epoch: [16][4399/4426]	Eit 75200  lr 5e-05  Le 9.8227 (9.8364)	Time 1.172 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:17:57,193 Test: [0/40]	Le 10.1932 (10.1932)	Time 7.965 (0.000)	
2021-06-20 17:18:18,064 calculate similarity time: 0.06184864044189453
2021-06-20 17:18:18,492 Image to text: 75.9, 96.6, 99.3, 1.0, 4.2
2021-06-20 17:18:18,804 Text to image: 65.0, 91.6, 96.1, 1.0, 5.0
2021-06-20 17:18:18,805 Current rsum is 524.48
2021-06-20 17:18:22,426 runs/coco_butd_region_bert/log
2021-06-20 17:18:22,426 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 17:18:22,428 image encoder trainable parameters: 20490144
2021-06-20 17:18:22,438 txt encoder trainable parameters: 137319072
2021-06-20 17:21:52,284 Epoch: [17][174/4426]	Eit 75400  lr 5e-05  Le 9.8636 (9.8345)	Time 1.130 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:25:49,585 Epoch: [17][374/4426]	Eit 75600  lr 5e-05  Le 9.8213 (9.8353)	Time 1.599 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:29:49,506 Epoch: [17][574/4426]	Eit 75800  lr 5e-05  Le 9.8417 (9.8352)	Time 1.173 (0.000)	Data 0.003 (0.000)	
2021-06-20 17:33:47,942 Epoch: [17][774/4426]	Eit 76000  lr 5e-05  Le 9.8162 (9.8348)	Time 1.176 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:37:32,973 Epoch: [17][974/4426]	Eit 76200  lr 5e-05  Le 9.8579 (9.8345)	Time 1.168 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:41:34,184 Epoch: [17][1174/4426]	Eit 76400  lr 5e-05  Le 9.8510 (9.8343)	Time 1.573 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:45:32,515 Epoch: [17][1374/4426]	Eit 76600  lr 5e-05  Le 9.8472 (9.8347)	Time 1.320 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:49:29,537 Epoch: [17][1574/4426]	Eit 76800  lr 5e-05  Le 9.8444 (9.8347)	Time 1.102 (0.000)	Data 0.002 (0.000)	
2021-06-20 17:53:27,087 Epoch: [17][1774/4426]	Eit 77000  lr 5e-05  Le 9.8185 (9.8344)	Time 1.202 (0.000)	Data 0.015 (0.000)	
2021-06-20 17:57:27,981 Epoch: [17][1974/4426]	Eit 77200  lr 5e-05  Le 9.8413 (9.8344)	Time 1.146 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:01:27,553 Epoch: [17][2174/4426]	Eit 77400  lr 5e-05  Le 9.8113 (9.8343)	Time 1.259 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:05:25,862 Epoch: [17][2374/4426]	Eit 77600  lr 5e-05  Le 9.8346 (9.8341)	Time 1.149 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:09:22,852 Epoch: [17][2574/4426]	Eit 77800  lr 5e-05  Le 9.8394 (9.8340)	Time 1.270 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:13:20,729 Epoch: [17][2774/4426]	Eit 78000  lr 5e-05  Le 9.7958 (9.8339)	Time 1.393 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:17:17,986 Epoch: [17][2974/4426]	Eit 78200  lr 5e-05  Le 9.8354 (9.8339)	Time 1.050 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:21:16,552 Epoch: [17][3174/4426]	Eit 78400  lr 5e-05  Le 9.8439 (9.8341)	Time 1.154 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:25:14,389 Epoch: [17][3374/4426]	Eit 78600  lr 5e-05  Le 9.7944 (9.8341)	Time 1.340 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:29:12,252 Epoch: [17][3574/4426]	Eit 78800  lr 5e-05  Le 9.8387 (9.8341)	Time 1.249 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:33:09,337 Epoch: [17][3774/4426]	Eit 79000  lr 5e-05  Le 9.8314 (9.8340)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:37:07,624 Epoch: [17][3974/4426]	Eit 79200  lr 5e-05  Le 9.8159 (9.8339)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:41:06,820 Epoch: [17][4174/4426]	Eit 79400  lr 5e-05  Le 9.8540 (9.8339)	Time 1.152 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:45:05,323 Epoch: [17][4374/4426]	Eit 79600  lr 5e-05  Le 9.8142 (9.8338)	Time 1.034 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:46:15,444 Test: [0/40]	Le 10.1936 (10.1936)	Time 7.756 (0.000)	
2021-06-20 18:46:36,719 calculate similarity time: 0.06824636459350586
2021-06-20 18:46:37,166 Image to text: 76.1, 96.5, 99.4, 1.0, 2.4
2021-06-20 18:46:37,504 Text to image: 65.0, 92.1, 96.5, 1.0, 4.4
2021-06-20 18:46:37,504 Current rsum is 525.54
2021-06-20 18:46:41,090 runs/coco_butd_region_bert/log
2021-06-20 18:46:41,090 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 18:46:41,094 image encoder trainable parameters: 20490144
2021-06-20 18:46:41,107 txt encoder trainable parameters: 137319072
2021-06-20 18:49:47,174 Epoch: [18][149/4426]	Eit 79800  lr 5e-05  Le 9.8528 (9.8324)	Time 1.312 (0.000)	Data 0.003 (0.000)	
2021-06-20 18:53:43,612 Epoch: [18][349/4426]	Eit 80000  lr 5e-05  Le 9.8800 (9.8310)	Time 1.091 (0.000)	Data 0.002 (0.000)	
2021-06-20 18:57:40,417 Epoch: [18][549/4426]	Eit 80200  lr 5e-05  Le 9.8545 (9.8309)	Time 1.179 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:01:22,884 Epoch: [18][749/4426]	Eit 80400  lr 5e-05  Le 9.8115 (9.8308)	Time 1.134 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:05:22,125 Epoch: [18][949/4426]	Eit 80600  lr 5e-05  Le 9.8097 (9.8310)	Time 1.316 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:09:21,007 Epoch: [18][1149/4426]	Eit 80800  lr 5e-05  Le 9.8400 (9.8310)	Time 1.139 (0.000)	Data 0.003 (0.000)	
2021-06-20 19:13:17,667 Epoch: [18][1349/4426]	Eit 81000  lr 5e-05  Le 9.8219 (9.8309)	Time 1.219 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:17:19,887 Epoch: [18][1549/4426]	Eit 81200  lr 5e-05  Le 9.8098 (9.8311)	Time 1.255 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:21:20,383 Epoch: [18][1749/4426]	Eit 81400  lr 5e-05  Le 9.8486 (9.8313)	Time 1.180 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:25:17,721 Epoch: [18][1949/4426]	Eit 81600  lr 5e-05  Le 9.8239 (9.8312)	Time 1.244 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:29:18,025 Epoch: [18][2149/4426]	Eit 81800  lr 5e-05  Le 9.8510 (9.8314)	Time 1.351 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:33:16,089 Epoch: [18][2349/4426]	Eit 82000  lr 5e-05  Le 9.8535 (9.8314)	Time 1.143 (0.000)	Data 0.003 (0.000)	
2021-06-20 19:37:14,482 Epoch: [18][2549/4426]	Eit 82200  lr 5e-05  Le 9.8050 (9.8314)	Time 1.130 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:41:11,723 Epoch: [18][2749/4426]	Eit 82400  lr 5e-05  Le 9.8188 (9.8315)	Time 1.090 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:45:08,706 Epoch: [18][2949/4426]	Eit 82600  lr 5e-05  Le 9.8327 (9.8312)	Time 1.284 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:49:09,939 Epoch: [18][3149/4426]	Eit 82800  lr 5e-05  Le 9.8013 (9.8313)	Time 1.272 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:53:09,374 Epoch: [18][3349/4426]	Eit 83000  lr 5e-05  Le 9.8534 (9.8312)	Time 1.348 (0.000)	Data 0.002 (0.000)	
2021-06-20 19:57:08,309 Epoch: [18][3549/4426]	Eit 83200  lr 5e-05  Le 9.8627 (9.8314)	Time 1.202 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:01:04,062 Epoch: [18][3749/4426]	Eit 83400  lr 5e-05  Le 9.8442 (9.8314)	Time 1.138 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:05:02,610 Epoch: [18][3949/4426]	Eit 83600  lr 5e-05  Le 9.8458 (9.8313)	Time 1.196 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:09:03,423 Epoch: [18][4149/4426]	Eit 83800  lr 5e-05  Le 9.8711 (9.8314)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:13:00,901 Epoch: [18][4349/4426]	Eit 84000  lr 5e-05  Le 9.8801 (9.8314)	Time 1.202 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:14:39,672 Test: [0/40]	Le 10.1939 (10.1939)	Time 7.788 (0.000)	
2021-06-20 20:14:59,988 calculate similarity time: 0.06833076477050781
2021-06-20 20:15:00,435 Image to text: 74.8, 96.5, 99.1, 1.0, 3.0
2021-06-20 20:15:00,750 Text to image: 64.7, 91.7, 96.3, 1.0, 4.5
2021-06-20 20:15:00,750 Current rsum is 523.02
2021-06-20 20:15:02,215 runs/coco_butd_region_bert/log
2021-06-20 20:15:02,215 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 20:15:02,216 image encoder trainable parameters: 20490144
2021-06-20 20:15:02,222 txt encoder trainable parameters: 137319072
2021-06-20 20:17:37,024 Epoch: [19][124/4426]	Eit 84200  lr 5e-05  Le 9.8221 (9.8309)	Time 1.171 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:21:34,715 Epoch: [19][324/4426]	Eit 84400  lr 5e-05  Le 9.8239 (9.8292)	Time 1.120 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:25:17,331 Epoch: [19][524/4426]	Eit 84600  lr 5e-05  Le 9.7958 (9.8305)	Time 1.106 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:29:13,215 Epoch: [19][724/4426]	Eit 84800  lr 5e-05  Le 9.8257 (9.8302)	Time 1.136 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:33:11,526 Epoch: [19][924/4426]	Eit 85000  lr 5e-05  Le 9.8465 (9.8300)	Time 1.407 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:37:09,010 Epoch: [19][1124/4426]	Eit 85200  lr 5e-05  Le 9.8364 (9.8296)	Time 1.253 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:41:08,559 Epoch: [19][1324/4426]	Eit 85400  lr 5e-05  Le 9.7963 (9.8296)	Time 1.151 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:45:07,827 Epoch: [19][1524/4426]	Eit 85600  lr 5e-05  Le 9.8275 (9.8297)	Time 1.175 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:49:03,795 Epoch: [19][1724/4426]	Eit 85800  lr 5e-05  Le 9.7904 (9.8298)	Time 1.162 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:52:58,853 Epoch: [19][1924/4426]	Eit 86000  lr 5e-05  Le 9.8151 (9.8298)	Time 1.140 (0.000)	Data 0.002 (0.000)	
2021-06-20 20:56:57,156 Epoch: [19][2124/4426]	Eit 86200  lr 5e-05  Le 9.8363 (9.8298)	Time 1.091 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:00:57,817 Epoch: [19][2324/4426]	Eit 86400  lr 5e-05  Le 9.8355 (9.8297)	Time 1.252 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:04:55,378 Epoch: [19][2524/4426]	Eit 86600  lr 5e-05  Le 9.8681 (9.8297)	Time 1.162 (0.000)	Data 0.005 (0.000)	
2021-06-20 21:08:53,885 Epoch: [19][2724/4426]	Eit 86800  lr 5e-05  Le 9.8413 (9.8298)	Time 1.172 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:12:51,154 Epoch: [19][2924/4426]	Eit 87000  lr 5e-05  Le 9.8678 (9.8298)	Time 1.306 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:16:50,146 Epoch: [19][3124/4426]	Eit 87200  lr 5e-05  Le 9.7992 (9.8298)	Time 1.406 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:20:49,272 Epoch: [19][3324/4426]	Eit 87400  lr 5e-05  Le 9.8332 (9.8297)	Time 1.364 (0.000)	Data 0.004 (0.000)	
2021-06-20 21:24:47,517 Epoch: [19][3524/4426]	Eit 87600  lr 5e-05  Le 9.8372 (9.8298)	Time 1.208 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:28:43,626 Epoch: [19][3724/4426]	Eit 87800  lr 5e-05  Le 9.7985 (9.8299)	Time 1.085 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:32:40,595 Epoch: [19][3924/4426]	Eit 88000  lr 5e-05  Le 9.8698 (9.8298)	Time 1.065 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:36:36,934 Epoch: [19][4124/4426]	Eit 88200  lr 5e-05  Le 9.8226 (9.8298)	Time 1.275 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:40:33,383 Epoch: [19][4324/4426]	Eit 88400  lr 5e-05  Le 9.8178 (9.8298)	Time 1.189 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:42:42,598 Test: [0/40]	Le 10.1945 (10.1945)	Time 7.502 (0.000)	
2021-06-20 21:43:03,092 calculate similarity time: 0.09343671798706055
2021-06-20 21:43:03,565 Image to text: 75.9, 96.5, 99.2, 1.0, 2.8
2021-06-20 21:43:04,035 Text to image: 64.6, 91.6, 96.4, 1.0, 4.5
2021-06-20 21:43:04,036 Current rsum is 524.24
2021-06-20 21:43:05,562 runs/coco_butd_region_bert/log
2021-06-20 21:43:05,562 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 21:43:05,564 image encoder trainable parameters: 20490144
2021-06-20 21:43:05,570 txt encoder trainable parameters: 137319072
2021-06-20 21:45:11,586 Epoch: [20][99/4426]	Eit 88600  lr 5e-05  Le 9.8356 (9.8283)	Time 1.158 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:48:57,754 Epoch: [20][299/4426]	Eit 88800  lr 5e-05  Le 9.8111 (9.8274)	Time 1.178 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:52:54,531 Epoch: [20][499/4426]	Eit 89000  lr 5e-05  Le 9.8730 (9.8278)	Time 1.382 (0.000)	Data 0.002 (0.000)	
2021-06-20 21:56:53,280 Epoch: [20][699/4426]	Eit 89200  lr 5e-05  Le 9.8196 (9.8275)	Time 1.278 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:00:51,840 Epoch: [20][899/4426]	Eit 89400  lr 5e-05  Le 9.8461 (9.8274)	Time 1.077 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:04:47,747 Epoch: [20][1099/4426]	Eit 89600  lr 5e-05  Le 9.8189 (9.8277)	Time 1.136 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:08:45,166 Epoch: [20][1299/4426]	Eit 89800  lr 5e-05  Le 9.8359 (9.8277)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:12:43,709 Epoch: [20][1499/4426]	Eit 90000  lr 5e-05  Le 9.8519 (9.8280)	Time 1.158 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:16:43,130 Epoch: [20][1699/4426]	Eit 90200  lr 5e-05  Le 9.8347 (9.8280)	Time 1.160 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:20:39,793 Epoch: [20][1899/4426]	Eit 90400  lr 5e-05  Le 9.8043 (9.8278)	Time 1.121 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:24:38,261 Epoch: [20][2099/4426]	Eit 90600  lr 5e-05  Le 9.8302 (9.8280)	Time 1.130 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:28:36,784 Epoch: [20][2299/4426]	Eit 90800  lr 5e-05  Le 9.8059 (9.8282)	Time 1.293 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:32:34,988 Epoch: [20][2499/4426]	Eit 91000  lr 5e-05  Le 9.8330 (9.8283)	Time 1.089 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:36:34,541 Epoch: [20][2699/4426]	Eit 91200  lr 5e-05  Le 9.8137 (9.8285)	Time 1.190 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:40:33,419 Epoch: [20][2899/4426]	Eit 91400  lr 5e-05  Le 9.8407 (9.8286)	Time 1.296 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:44:30,431 Epoch: [20][3099/4426]	Eit 91600  lr 5e-05  Le 9.8065 (9.8287)	Time 1.228 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:48:27,281 Epoch: [20][3299/4426]	Eit 91800  lr 5e-05  Le 9.8584 (9.8288)	Time 1.162 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:52:22,763 Epoch: [20][3499/4426]	Eit 92000  lr 5e-05  Le 9.8664 (9.8287)	Time 1.261 (0.000)	Data 0.002 (0.000)	
2021-06-20 22:56:22,371 Epoch: [20][3699/4426]	Eit 92200  lr 5e-05  Le 9.8337 (9.8288)	Time 1.064 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:00:21,235 Epoch: [20][3899/4426]	Eit 92400  lr 5e-05  Le 9.8591 (9.8288)	Time 1.023 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:04:17,981 Epoch: [20][4099/4426]	Eit 92600  lr 5e-05  Le 9.8085 (9.8287)	Time 1.223 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:08:17,169 Epoch: [20][4299/4426]	Eit 92800  lr 5e-05  Le 9.8430 (9.8287)	Time 1.095 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:10:48,818 Test: [0/40]	Le 10.1977 (10.1977)	Time 7.516 (0.000)	
2021-06-20 23:11:05,229 calculate similarity time: 0.07113456726074219
2021-06-20 23:11:05,676 Image to text: 75.1, 96.8, 99.4, 1.0, 2.4
2021-06-20 23:11:05,988 Text to image: 65.0, 91.7, 96.3, 1.0, 4.5
2021-06-20 23:11:05,988 Current rsum is 524.3199999999999
2021-06-20 23:11:07,425 runs/coco_butd_region_bert/log
2021-06-20 23:11:07,425 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-20 23:11:07,426 image encoder trainable parameters: 20490144
2021-06-20 23:11:07,432 txt encoder trainable parameters: 137319072
2021-06-20 23:12:42,155 Epoch: [21][74/4426]	Eit 93000  lr 5e-05  Le 9.8580 (9.8264)	Time 1.171 (0.000)	Data 0.003 (0.000)	
2021-06-20 23:16:39,606 Epoch: [21][274/4426]	Eit 93200  lr 5e-05  Le 9.8262 (9.8290)	Time 1.213 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:20:39,795 Epoch: [21][474/4426]	Eit 93400  lr 5e-05  Le 9.8343 (9.8289)	Time 1.244 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:24:38,232 Epoch: [21][674/4426]	Eit 93600  lr 5e-05  Le 9.8009 (9.8282)	Time 1.167 (0.000)	Data 0.003 (0.000)	
2021-06-20 23:28:37,842 Epoch: [21][874/4426]	Eit 93800  lr 5e-05  Le 9.8394 (9.8276)	Time 1.103 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:32:37,497 Epoch: [21][1074/4426]	Eit 94000  lr 5e-05  Le 9.8119 (9.8271)	Time 1.152 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:36:33,963 Epoch: [21][1274/4426]	Eit 94200  lr 5e-05  Le 9.8223 (9.8273)	Time 1.107 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:40:35,196 Epoch: [21][1474/4426]	Eit 94400  lr 5e-05  Le 9.8176 (9.8271)	Time 1.070 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:44:32,866 Epoch: [21][1674/4426]	Eit 94600  lr 5e-05  Le 9.8376 (9.8271)	Time 1.099 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:48:32,509 Epoch: [21][1874/4426]	Eit 94800  lr 5e-05  Le 9.8085 (9.8272)	Time 1.141 (0.000)	Data 0.002 (0.000)	
2021-06-20 23:52:28,064 Epoch: [21][2074/4426]	Eit 95000  lr 5e-05  Le 9.7937 (9.8273)	Time 1.556 (0.000)	Data 0.003 (0.000)	
2021-06-20 23:56:25,897 Epoch: [21][2274/4426]	Eit 95200  lr 5e-05  Le 9.8248 (9.8271)	Time 1.263 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:00:23,558 Epoch: [21][2474/4426]	Eit 95400  lr 5e-05  Le 9.8166 (9.8272)	Time 1.127 (0.000)	Data 0.003 (0.000)	
2021-06-21 00:04:20,675 Epoch: [21][2674/4426]	Eit 95600  lr 5e-05  Le 9.8174 (9.8272)	Time 1.171 (0.000)	Data 0.003 (0.000)	
2021-06-21 00:08:22,419 Epoch: [21][2874/4426]	Eit 95800  lr 5e-05  Le 9.8321 (9.8272)	Time 1.153 (0.000)	Data 0.003 (0.000)	
2021-06-21 00:12:23,086 Epoch: [21][3074/4426]	Eit 96000  lr 5e-05  Le 9.7948 (9.8270)	Time 1.145 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:16:19,853 Epoch: [21][3274/4426]	Eit 96200  lr 5e-05  Le 9.8514 (9.8270)	Time 1.059 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:20:18,089 Epoch: [21][3474/4426]	Eit 96400  lr 5e-05  Le 9.8037 (9.8270)	Time 1.062 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:24:14,554 Epoch: [21][3674/4426]	Eit 96600  lr 5e-05  Le 9.8304 (9.8270)	Time 1.126 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:28:10,715 Epoch: [21][3874/4426]	Eit 96800  lr 5e-05  Le 9.8338 (9.8271)	Time 1.143 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:32:09,660 Epoch: [21][4074/4426]	Eit 97000  lr 5e-05  Le 9.8021 (9.8270)	Time 1.052 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:35:52,743 Epoch: [21][4274/4426]	Eit 97200  lr 5e-05  Le 9.8105 (9.8270)	Time 1.328 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:38:59,639 Test: [0/40]	Le 10.1976 (10.1975)	Time 7.682 (0.000)	
2021-06-21 00:39:20,497 calculate similarity time: 0.06716537475585938
2021-06-21 00:39:21,053 Image to text: 76.4, 96.3, 99.2, 1.0, 3.4
2021-06-21 00:39:21,403 Text to image: 65.0, 91.6, 96.3, 1.0, 4.5
2021-06-21 00:39:21,403 Current rsum is 524.78
2021-06-21 00:39:22,841 runs/coco_butd_region_bert/log
2021-06-21 00:39:22,841 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 00:39:22,843 image encoder trainable parameters: 20490144
2021-06-21 00:39:22,848 txt encoder trainable parameters: 137319072
2021-06-21 00:40:29,034 Epoch: [22][49/4426]	Eit 97400  lr 5e-05  Le 9.8028 (9.8221)	Time 1.084 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:44:27,356 Epoch: [22][249/4426]	Eit 97600  lr 5e-05  Le 9.8242 (9.8275)	Time 1.144 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:48:25,731 Epoch: [22][449/4426]	Eit 97800  lr 5e-05  Le 9.8537 (9.8251)	Time 1.153 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:52:23,033 Epoch: [22][649/4426]	Eit 98000  lr 5e-05  Le 9.8265 (9.8267)	Time 1.110 (0.000)	Data 0.002 (0.000)	
2021-06-21 00:56:21,713 Epoch: [22][849/4426]	Eit 98200  lr 5e-05  Le 9.8211 (9.8262)	Time 1.099 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:00:22,388 Epoch: [22][1049/4426]	Eit 98400  lr 5e-05  Le 9.8097 (9.8259)	Time 1.162 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:04:20,346 Epoch: [22][1249/4426]	Eit 98600  lr 5e-05  Le 9.8145 (9.8258)	Time 1.199 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:08:21,342 Epoch: [22][1449/4426]	Eit 98800  lr 5e-05  Le 9.8348 (9.8259)	Time 1.228 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:12:18,733 Epoch: [22][1649/4426]	Eit 99000  lr 5e-05  Le 9.8324 (9.8259)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:16:17,809 Epoch: [22][1849/4426]	Eit 99200  lr 5e-05  Le 9.8008 (9.8258)	Time 1.209 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:20:14,542 Epoch: [22][2049/4426]	Eit 99400  lr 5e-05  Le 9.8446 (9.8258)	Time 1.052 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:24:14,585 Epoch: [22][2249/4426]	Eit 99600  lr 5e-05  Le 9.8217 (9.8258)	Time 1.282 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:28:11,865 Epoch: [22][2449/4426]	Eit 99800  lr 5e-05  Le 9.8348 (9.8259)	Time 1.305 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:32:08,841 Epoch: [22][2649/4426]	Eit 100000  lr 5e-05  Le 9.8318 (9.8260)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:36:06,520 Epoch: [22][2849/4426]	Eit 100200  lr 5e-05  Le 9.8243 (9.8261)	Time 1.182 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:40:06,237 Epoch: [22][3049/4426]	Eit 100400  lr 5e-05  Le 9.8340 (9.8261)	Time 1.170 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:44:03,998 Epoch: [22][3249/4426]	Eit 100600  lr 5e-05  Le 9.8259 (9.8262)	Time 1.151 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:48:04,295 Epoch: [22][3449/4426]	Eit 100800  lr 5e-05  Le 9.7960 (9.8261)	Time 1.134 (0.000)	Data 0.002 (0.000)	
2021-06-21 01:52:00,315 Epoch: [22][3649/4426]	Eit 101000  lr 5e-05  Le 9.8079 (9.8261)	Time 1.161 (0.000)	Data 0.003 (0.000)	
2021-06-21 01:55:57,995 Epoch: [22][3849/4426]	Eit 101200  lr 5e-05  Le 9.8356 (9.8261)	Time 1.073 (0.000)	Data 0.003 (0.000)	
2021-06-21 01:59:45,155 Epoch: [22][4049/4426]	Eit 101400  lr 5e-05  Le 9.7876 (9.8261)	Time 1.381 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:03:40,382 Epoch: [22][4249/4426]	Eit 101600  lr 5e-05  Le 9.8157 (9.8262)	Time 1.454 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:07:16,833 Test: [0/40]	Le 10.1992 (10.1992)	Time 7.878 (0.000)	
2021-06-21 02:07:37,446 calculate similarity time: 0.06321120262145996
2021-06-21 02:07:37,994 Image to text: 77.4, 96.6, 99.4, 1.0, 2.3
2021-06-21 02:07:38,322 Text to image: 64.5, 91.4, 96.1, 1.0, 4.6
2021-06-21 02:07:38,322 Current rsum is 525.42
2021-06-21 02:07:39,793 runs/coco_butd_region_bert/log
2021-06-21 02:07:39,793 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 02:07:39,795 image encoder trainable parameters: 20490144
2021-06-21 02:07:39,800 txt encoder trainable parameters: 137319072
2021-06-21 02:08:16,059 Epoch: [23][24/4426]	Eit 101800  lr 5e-05  Le 9.8183 (9.8286)	Time 1.167 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:12:13,785 Epoch: [23][224/4426]	Eit 102000  lr 5e-05  Le 9.8491 (9.8249)	Time 1.158 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:16:10,077 Epoch: [23][424/4426]	Eit 102200  lr 5e-05  Le 9.8539 (9.8242)	Time 1.210 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:20:09,948 Epoch: [23][624/4426]	Eit 102400  lr 5e-05  Le 9.8434 (9.8243)	Time 1.145 (0.000)	Data 0.003 (0.000)	
2021-06-21 02:24:08,764 Epoch: [23][824/4426]	Eit 102600  lr 5e-05  Le 9.8290 (9.8243)	Time 1.402 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:28:10,295 Epoch: [23][1024/4426]	Eit 102800  lr 5e-05  Le 9.8783 (9.8247)	Time 1.352 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:32:06,600 Epoch: [23][1224/4426]	Eit 103000  lr 5e-05  Le 9.8199 (9.8249)	Time 1.278 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:36:05,695 Epoch: [23][1424/4426]	Eit 103200  lr 5e-05  Le 9.8230 (9.8249)	Time 1.455 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:40:04,149 Epoch: [23][1624/4426]	Eit 103400  lr 5e-05  Le 9.8307 (9.8251)	Time 1.129 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:44:02,542 Epoch: [23][1824/4426]	Eit 103600  lr 5e-05  Le 9.8209 (9.8250)	Time 1.183 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:47:59,204 Epoch: [23][2024/4426]	Eit 103800  lr 5e-05  Le 9.8306 (9.8249)	Time 1.242 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:51:57,927 Epoch: [23][2224/4426]	Eit 104000  lr 5e-05  Le 9.8557 (9.8248)	Time 1.116 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:55:55,035 Epoch: [23][2424/4426]	Eit 104200  lr 5e-05  Le 9.8078 (9.8247)	Time 1.101 (0.000)	Data 0.002 (0.000)	
2021-06-21 02:59:53,862 Epoch: [23][2624/4426]	Eit 104400  lr 5e-05  Le 9.8113 (9.8246)	Time 1.103 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:03:51,857 Epoch: [23][2824/4426]	Eit 104600  lr 5e-05  Le 9.8076 (9.8248)	Time 1.090 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:07:48,407 Epoch: [23][3024/4426]	Eit 104800  lr 5e-05  Le 9.8312 (9.8248)	Time 1.374 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:11:45,068 Epoch: [23][3224/4426]	Eit 105000  lr 5e-05  Le 9.7835 (9.8248)	Time 1.176 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:15:42,430 Epoch: [23][3424/4426]	Eit 105200  lr 5e-05  Le 9.8254 (9.8249)	Time 1.167 (0.000)	Data 0.003 (0.000)	
2021-06-21 03:19:37,153 Epoch: [23][3624/4426]	Eit 105400  lr 5e-05  Le 9.8406 (9.8247)	Time 1.209 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:23:07,299 Epoch: [23][3824/4426]	Eit 105600  lr 5e-05  Le 9.8037 (9.8247)	Time 0.709 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:25:37,618 Epoch: [23][4024/4426]	Eit 105800  lr 5e-05  Le 9.8752 (9.8247)	Time 0.752 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:28:07,413 Epoch: [23][4224/4426]	Eit 106000  lr 5e-05  Le 9.8356 (9.8248)	Time 0.725 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:30:35,642 Epoch: [23][4424/4426]	Eit 106200  lr 5e-05  Le 9.8493 (9.8248)	Time 0.766 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:30:44,362 Test: [0/40]	Le 10.2004 (10.2004)	Time 7.368 (0.000)	
2021-06-21 03:30:57,100 calculate similarity time: 0.05518746376037598
2021-06-21 03:30:57,606 Image to text: 76.8, 97.1, 99.4, 1.0, 2.4
2021-06-21 03:30:57,925 Text to image: 65.1, 91.7, 96.3, 1.0, 4.6
2021-06-21 03:30:57,925 Current rsum is 526.34
2021-06-21 03:31:01,531 runs/coco_butd_region_bert/log
2021-06-21 03:31:01,531 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 03:31:01,535 image encoder trainable parameters: 20490144
2021-06-21 03:31:01,548 txt encoder trainable parameters: 137319072
2021-06-21 03:33:36,460 Epoch: [24][199/4426]	Eit 106400  lr 5e-05  Le 9.8322 (9.8227)	Time 0.710 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:36:05,205 Epoch: [24][399/4426]	Eit 106600  lr 5e-05  Le 9.8365 (9.8237)	Time 0.717 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:38:32,782 Epoch: [24][599/4426]	Eit 106800  lr 5e-05  Le 9.8167 (9.8231)	Time 0.724 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:40:59,387 Epoch: [24][799/4426]	Eit 107000  lr 5e-05  Le 9.8254 (9.8233)	Time 0.722 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:43:26,384 Epoch: [24][999/4426]	Eit 107200  lr 5e-05  Le 9.8443 (9.8237)	Time 0.741 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:45:52,849 Epoch: [24][1199/4426]	Eit 107400  lr 5e-05  Le 9.8053 (9.8237)	Time 0.784 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:48:19,640 Epoch: [24][1399/4426]	Eit 107600  lr 5e-05  Le 9.8191 (9.8238)	Time 0.737 (0.000)	Data 0.003 (0.000)	
2021-06-21 03:50:45,772 Epoch: [24][1599/4426]	Eit 107800  lr 5e-05  Le 9.8227 (9.8237)	Time 0.849 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:53:11,868 Epoch: [24][1799/4426]	Eit 108000  lr 5e-05  Le 9.8229 (9.8236)	Time 0.734 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:55:39,981 Epoch: [24][1999/4426]	Eit 108200  lr 5e-05  Le 9.7904 (9.8237)	Time 0.852 (0.000)	Data 0.002 (0.000)	
2021-06-21 03:58:06,513 Epoch: [24][2199/4426]	Eit 108400  lr 5e-05  Le 9.8423 (9.8237)	Time 0.692 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:00:32,695 Epoch: [24][2399/4426]	Eit 108600  lr 5e-05  Le 9.8356 (9.8238)	Time 0.722 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:02:58,953 Epoch: [24][2599/4426]	Eit 108800  lr 5e-05  Le 9.8011 (9.8236)	Time 0.689 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:05:26,196 Epoch: [24][2799/4426]	Eit 109000  lr 5e-05  Le 9.8240 (9.8236)	Time 0.783 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:07:53,541 Epoch: [24][2999/4426]	Eit 109200  lr 5e-05  Le 9.7924 (9.8237)	Time 0.761 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:10:19,339 Epoch: [24][3199/4426]	Eit 109400  lr 5e-05  Le 9.8235 (9.8235)	Time 0.734 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:12:43,412 Epoch: [24][3399/4426]	Eit 109600  lr 5e-05  Le 9.7912 (9.8236)	Time 0.659 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:15:07,281 Epoch: [24][3599/4426]	Eit 109800  lr 5e-05  Le 9.8225 (9.8237)	Time 0.657 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:17:32,768 Epoch: [24][3799/4426]	Eit 110000  lr 5e-05  Le 9.8469 (9.8238)	Time 0.800 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:19:58,658 Epoch: [24][3999/4426]	Eit 110200  lr 5e-05  Le 9.7987 (9.8238)	Time 0.716 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:22:24,621 Epoch: [24][4199/4426]	Eit 110400  lr 5e-05  Le 9.8240 (9.8237)	Time 0.669 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:24:51,074 Epoch: [24][4399/4426]	Eit 110600  lr 5e-05  Le 9.8325 (9.8237)	Time 0.738 (0.000)	Data 0.002 (0.000)	
2021-06-21 04:25:19,868 Test: [0/40]	Le 10.1997 (10.1997)	Time 8.725 (0.000)	
2021-06-21 04:25:32,181 calculate similarity time: 0.04585742950439453
2021-06-21 04:25:32,685 Image to text: 76.2, 96.7, 99.3, 1.0, 2.8
2021-06-21 04:25:33,012 Text to image: 65.0, 91.8, 96.1, 1.0, 4.6
2021-06-21 04:25:33,012 Current rsum is 525.12
You have new mail in /var/spool/mail/root
[root@gpu1 vse_infty-master-my-graph-gru-unified-meanpooling]# 
[root@gpu1 vse_infty-master-my-graph-gru-unified-meanpooling]# CUDA_VISIBLE_DEVICES=0,1 python3 eval.py --dataset coco --data_path ../data/coco
INFO:root:Evaluating runs/coco_butd_region_bert...
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified-meanpooling/lib/encoders.py:48: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].weight, 0)
/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified-meanpooling/lib/encoders.py:49: UserWarning: nn.init.constant is now deprecated in favor of nn.init.constant_.
  nn.init.constant(self.W[1].bias, 0)
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
INFO:lib.evaluation:Test: [0/196]	Le 10.2289 (10.2289)	Time 5.705 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2174 (10.2206)	Time 0.618 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2291 (10.2156)	Time 0.440 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2318 (10.2182)	Time 0.454 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2307 (10.2169)	Time 0.414 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2115 (10.2167)	Time 0.489 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2104 (10.2175)	Time 0.438 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2330 (10.2167)	Time 0.426 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2264 (10.2173)	Time 0.543 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2081 (10.2175)	Time 0.386 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2197 (10.2174)	Time 0.422 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.1994 (10.2172)	Time 0.412 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2502 (10.2174)	Time 0.457 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2164 (10.2178)	Time 0.426 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2416 (10.2181)	Time 0.407 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.2017 (10.2183)	Time 0.454 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2110 (10.2181)	Time 0.407 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2109 (10.2180)	Time 0.444 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.2105 (10.2176)	Time 0.464 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1895 (10.2177)	Time 0.427 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.11030364036560059
INFO:lib.evaluation:Image to text: 77.8, 96.7, 98.7, 1.0, 1.7
INFO:lib.evaluation:Text to image: 63.0, 90.1, 95.0, 1.0, 4.7
INFO:lib.evaluation:rsum: 521.2 ar: 91.1 ari: 82.7
INFO:lib.evaluation:calculate similarity time: 0.09767484664916992
INFO:lib.evaluation:Image to text: 75.2, 95.2, 97.8, 1.0, 5.5
INFO:lib.evaluation:Text to image: 61.8, 89.0, 94.4, 1.0, 5.3
INFO:lib.evaluation:rsum: 513.4 ar: 89.4 ari: 81.7
INFO:lib.evaluation:calculate similarity time: 0.07332134246826172
INFO:lib.evaluation:Image to text: 76.6, 94.8, 98.1, 1.0, 1.8
INFO:lib.evaluation:Text to image: 61.9, 89.9, 95.7, 1.0, 4.4
INFO:lib.evaluation:rsum: 517.0 ar: 89.8 ari: 82.5
INFO:lib.evaluation:calculate similarity time: 0.08934283256530762
INFO:lib.evaluation:Image to text: 74.9, 95.1, 98.1, 1.0, 4.3
INFO:lib.evaluation:Text to image: 60.3, 89.3, 95.3, 1.0, 4.8
INFO:lib.evaluation:rsum: 513.1 ar: 89.4 ari: 81.7
INFO:lib.evaluation:calculate similarity time: 0.09338879585266113
INFO:lib.evaluation:Image to text: 76.6, 95.3, 98.2, 1.0, 3.9
INFO:lib.evaluation:Text to image: 62.3, 90.6, 95.6, 1.0, 4.6
INFO:lib.evaluation:rsum: 518.6 ar: 90.0 ari: 82.8
INFO:lib.evaluation:-----------------------------------
INFO:lib.evaluation:Mean metrics: 
INFO:lib.evaluation:rsum: 516.7
INFO:lib.evaluation:Average i2t Recall: 89.9
INFO:lib.evaluation:Image to text: 76.2 95.4 98.2 1.0 3.4
INFO:lib.evaluation:Average t2i Recall: 82.3
INFO:lib.evaluation:Text to image: 61.9 89.8 95.2 1.0 4.8
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
INFO:lib.evaluation:Test: [0/196]	Le 10.2289 (10.2289)	Time 2.113 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2174 (10.2206)	Time 0.524 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2291 (10.2156)	Time 0.409 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2318 (10.2182)	Time 0.448 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2307 (10.2169)	Time 0.406 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2115 (10.2167)	Time 0.448 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2104 (10.2175)	Time 0.431 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2330 (10.2167)	Time 0.422 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2264 (10.2173)	Time 0.566 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2081 (10.2175)	Time 0.448 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2197 (10.2174)	Time 0.435 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.1994 (10.2172)	Time 0.412 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2502 (10.2174)	Time 0.499 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2164 (10.2178)	Time 0.440 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2416 (10.2181)	Time 0.416 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.2017 (10.2183)	Time 0.435 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2110 (10.2181)	Time 0.378 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2109 (10.2180)	Time 0.487 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.2105 (10.2176)	Time 0.475 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1895 (10.2177)	Time 0.396 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 1.0610992908477783
INFO:lib.evaluation:rsum: 414.0
INFO:lib.evaluation:Average i2t Recall: 74.8
INFO:lib.evaluation:Image to text: 52.4 81.9 90.1 1.0 13.1
INFO:lib.evaluation:Average t2i Recall: 63.2
INFO:lib.evaluation:Text to image: 38.6 70.0 81.0 2.0 19.6
INFO:root:Evaluating runs/coco_butd_grid_bert...
Traceback (most recent call last):
  File "eval.py", line 58, in <module>
    main()
  File "eval.py", line 46, in main
    evaluation.evalrank(model_path, data_path=opt.data_path, split='testall', fold5=True)
  File "/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified-meanpooling/lib/evaluation.py", line 196, in evalrank
    checkpoint = torch.load(model_path)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 571, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 229, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 210, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'runs/coco_butd_grid_bert/model_best.pth'
[root@gpu1 vse_infty-master-my-graph-gru-unified-meanpooling]# 

