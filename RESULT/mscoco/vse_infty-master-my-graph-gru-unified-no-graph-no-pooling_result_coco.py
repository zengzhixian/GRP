[root@gpu1 vse_infty-master-my-graph-gru-unified-no-graph-no-pooling]# sh train_region.sh 
2021-06-21 08:45:02,160 Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=False, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vse_mean_warmup_epochs=1, word_dim=300, workers=10)
2021-06-21 08:45:02,160 Model name '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' not found in model shortcut name list (bert-base-uncased, bert-large-uncased, bert-base-cased, bert-large-cased, bert-base-multilingual-uncased, bert-base-multilingual-cased, bert-base-chinese, bert-base-german-cased, bert-large-uncased-whole-word-masking, bert-large-cased-whole-word-masking, bert-large-uncased-whole-word-masking-finetuned-squad, bert-large-cased-whole-word-masking-finetuned-squad, bert-base-cased-finetuned-mrpc). Assuming '/public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased' is a path or url to a directory containing tokenizer files.
2021-06-21 08:45:02,160 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/added_tokens.json. We won't load it.
2021-06-21 08:45:02,160 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/special_tokens_map.json. We won't load it.
2021-06-21 08:45:02,160 Didn't find file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/tokenizer_config.json. We won't load it.
2021-06-21 08:45:02,160 loading file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/vocab.txt
2021-06-21 08:45:02,161 loading file None
2021-06-21 08:45:02,161 loading file None
2021-06-21 08:45:02,161 loading file None
2021-06-21 08:45:30,648 loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
2021-06-21 08:45:30,648 Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

2021-06-21 08:45:30,649 loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
2021-06-21 08:45:36,500 Use adam as the optimizer, with init lr 0.0005
2021-06-21 08:45:36,500 Image encoder is data paralleled now.
2021-06-21 08:45:36,500 runs/coco_butd_region_bert/log
2021-06-21 08:45:36,500 runs/coco_butd_region_bert
2021-06-21 08:45:36,501 image encoder trainable parameters: 3688352
2021-06-21 08:45:36,506 txt encoder trainable parameters: 120517280
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
2021-06-21 08:47:48,116 Epoch: [0][199/4426]	Eit 200  lr 0.0005  Le 10.1244 (10.1409)	Time 0.562 (0.000)	Data 0.010 (0.000)	
2021-06-21 08:49:47,363 Epoch: [0][399/4426]	Eit 400  lr 0.0005  Le 10.0920 (10.1284)	Time 0.791 (0.000)	Data 0.002 (0.000)	
2021-06-21 08:51:45,019 Epoch: [0][599/4426]	Eit 600  lr 0.0005  Le 10.0938 (10.1176)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-21 08:53:42,642 Epoch: [0][799/4426]	Eit 800  lr 0.0005  Le 10.0708 (10.1075)	Time 0.693 (0.000)	Data 0.002 (0.000)	
2021-06-21 08:55:42,691 Epoch: [0][999/4426]	Eit 1000  lr 0.0005  Le 10.0745 (10.0991)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-21 08:57:44,413 Epoch: [0][1199/4426]	Eit 1200  lr 0.0005  Le 10.0406 (10.0913)	Time 0.567 (0.000)	Data 0.002 (0.000)	
2021-06-21 08:59:44,288 Epoch: [0][1399/4426]	Eit 1400  lr 0.0005  Le 10.0629 (10.0849)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:01:46,994 Epoch: [0][1599/4426]	Eit 1600  lr 0.0005  Le 10.0495 (10.0792)	Time 0.567 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:03:48,539 Epoch: [0][1799/4426]	Eit 1800  lr 0.0005  Le 10.0304 (10.0743)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:05:49,996 Epoch: [0][1999/4426]	Eit 2000  lr 0.0005  Le 10.0353 (10.0700)	Time 0.636 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:07:49,268 Epoch: [0][2199/4426]	Eit 2200  lr 0.0005  Le 10.0135 (10.0659)	Time 0.558 (0.000)	Data 0.003 (0.000)	
2021-06-21 09:09:48,863 Epoch: [0][2399/4426]	Eit 2400  lr 0.0005  Le 10.0203 (10.0622)	Time 0.602 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:11:47,574 Epoch: [0][2599/4426]	Eit 2600  lr 0.0005  Le 10.0130 (10.0588)	Time 0.565 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:13:48,994 Epoch: [0][2799/4426]	Eit 2800  lr 0.0005  Le 10.0243 (10.0558)	Time 0.588 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:15:50,528 Epoch: [0][2999/4426]	Eit 3000  lr 0.0005  Le 9.9850 (10.0528)	Time 0.597 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:17:51,286 Epoch: [0][3199/4426]	Eit 3200  lr 0.0005  Le 10.0182 (10.0502)	Time 0.681 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:19:52,125 Epoch: [0][3399/4426]	Eit 3400  lr 0.0005  Le 9.9841 (10.0477)	Time 0.530 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:21:53,997 Epoch: [0][3599/4426]	Eit 3600  lr 0.0005  Le 9.9864 (10.0454)	Time 0.582 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:23:54,695 Epoch: [0][3799/4426]	Eit 3800  lr 0.0005  Le 9.9988 (10.0431)	Time 0.772 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:25:56,854 Epoch: [0][3999/4426]	Eit 4000  lr 0.0005  Le 10.0022 (10.0410)	Time 0.579 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:27:58,320 Epoch: [0][4199/4426]	Eit 4200  lr 0.0005  Le 9.9723 (10.0391)	Time 0.624 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:29:58,464 Epoch: [0][4399/4426]	Eit 4400  lr 0.0005  Le 10.0160 (10.0371)	Time 0.658 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:30:23,191 Test: [0/40]	Le 10.1803 (10.1803)	Time 8.264 (0.000)	
2021-06-21 09:30:34,016 calculate similarity time: 0.053751468658447266
2021-06-21 09:30:34,521 Image to text: 62.7, 90.0, 95.4, 1.0, 2.9
2021-06-21 09:30:34,850 Text to image: 49.3, 83.4, 92.6, 2.0, 4.7
2021-06-21 09:30:34,850 Current rsum is 473.38
2021-06-21 09:30:37,181 runs/coco_butd_region_bert/log
2021-06-21 09:30:37,181 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 09:30:37,182 image encoder trainable parameters: 3688352
2021-06-21 09:30:37,186 txt encoder trainable parameters: 120517280
2021-06-21 09:32:33,084 Epoch: [1][174/4426]	Eit 4600  lr 0.0005  Le 10.0151 (9.9872)	Time 0.618 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:34:36,343 Epoch: [1][374/4426]	Eit 4800  lr 0.0005  Le 10.0111 (9.9867)	Time 0.563 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:36:38,169 Epoch: [1][574/4426]	Eit 5000  lr 0.0005  Le 10.0136 (9.9863)	Time 0.563 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:38:36,840 Epoch: [1][774/4426]	Eit 5200  lr 0.0005  Le 10.0138 (9.9856)	Time 0.640 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:40:35,254 Epoch: [1][974/4426]	Eit 5400  lr 0.0005  Le 9.9814 (9.9851)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:42:33,602 Epoch: [1][1174/4426]	Eit 5600  lr 0.0005  Le 9.9963 (9.9850)	Time 0.577 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:44:31,615 Epoch: [1][1374/4426]	Eit 5800  lr 0.0005  Le 9.9944 (9.9844)	Time 0.569 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:46:30,146 Epoch: [1][1574/4426]	Eit 6000  lr 0.0005  Le 9.9828 (9.9840)	Time 0.647 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:48:30,020 Epoch: [1][1774/4426]	Eit 6200  lr 0.0005  Le 10.0082 (9.9836)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:50:29,151 Epoch: [1][1974/4426]	Eit 6400  lr 0.0005  Le 9.9613 (9.9830)	Time 0.563 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:52:27,659 Epoch: [1][2174/4426]	Eit 6600  lr 0.0005  Le 9.9666 (9.9826)	Time 0.625 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:54:26,329 Epoch: [1][2374/4426]	Eit 6800  lr 0.0005  Le 9.9648 (9.9825)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:56:25,044 Epoch: [1][2574/4426]	Eit 7000  lr 0.0005  Le 9.9836 (9.9818)	Time 0.623 (0.000)	Data 0.002 (0.000)	
2021-06-21 09:58:23,568 Epoch: [1][2774/4426]	Eit 7200  lr 0.0005  Le 9.9698 (9.9816)	Time 0.562 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:00:23,127 Epoch: [1][2974/4426]	Eit 7400  lr 0.0005  Le 9.9531 (9.9812)	Time 0.614 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:02:23,263 Epoch: [1][3174/4426]	Eit 7600  lr 0.0005  Le 10.0119 (9.9807)	Time 0.539 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:04:25,006 Epoch: [1][3374/4426]	Eit 7800  lr 0.0005  Le 9.9581 (9.9803)	Time 0.535 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:06:25,641 Epoch: [1][3574/4426]	Eit 8000  lr 0.0005  Le 9.9571 (9.9798)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:08:27,567 Epoch: [1][3774/4426]	Eit 8200  lr 0.0005  Le 9.9277 (9.9792)	Time 0.647 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:10:31,200 Epoch: [1][3974/4426]	Eit 8400  lr 0.0005  Le 9.9621 (9.9787)	Time 0.645 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:12:35,712 Epoch: [1][4174/4426]	Eit 8600  lr 0.0005  Le 9.9872 (9.9783)	Time 0.614 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:14:37,934 Epoch: [1][4374/4426]	Eit 8800  lr 0.0005  Le 9.9686 (9.9779)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:15:18,446 Test: [0/40]	Le 10.1884 (10.1884)	Time 8.845 (0.000)	
2021-06-21 10:15:29,211 calculate similarity time: 0.046746253967285156
2021-06-21 10:15:29,692 Image to text: 66.3, 91.8, 97.1, 1.0, 3.8
2021-06-21 10:15:30,008 Text to image: 53.7, 86.1, 93.9, 1.0, 4.5
2021-06-21 10:15:30,008 Current rsum is 488.86
2021-06-21 10:15:32,981 runs/coco_butd_region_bert/log
2021-06-21 10:15:32,982 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 10:15:32,983 image encoder trainable parameters: 3688352
2021-06-21 10:15:32,994 txt encoder trainable parameters: 120517280
2021-06-21 10:17:14,484 Epoch: [2][149/4426]	Eit 9000  lr 0.0005  Le 9.9206 (9.9601)	Time 0.779 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:19:18,942 Epoch: [2][349/4426]	Eit 9200  lr 0.0005  Le 9.9348 (9.9603)	Time 0.625 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:21:22,793 Epoch: [2][549/4426]	Eit 9400  lr 0.0005  Le 9.9556 (9.9599)	Time 0.603 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:23:25,184 Epoch: [2][749/4426]	Eit 9600  lr 0.0005  Le 9.9536 (9.9595)	Time 0.607 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:25:29,558 Epoch: [2][949/4426]	Eit 9800  lr 0.0005  Le 9.9773 (9.9593)	Time 0.616 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:27:33,077 Epoch: [2][1149/4426]	Eit 10000  lr 0.0005  Le 9.9348 (9.9595)	Time 0.592 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:29:36,858 Epoch: [2][1349/4426]	Eit 10200  lr 0.0005  Le 9.9555 (9.9594)	Time 0.587 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:31:40,638 Epoch: [2][1549/4426]	Eit 10400  lr 0.0005  Le 9.9649 (9.9594)	Time 0.669 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:33:42,898 Epoch: [2][1749/4426]	Eit 10600  lr 0.0005  Le 9.9551 (9.9594)	Time 0.649 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:35:47,592 Epoch: [2][1949/4426]	Eit 10800  lr 0.0005  Le 9.9885 (9.9590)	Time 0.652 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:37:51,204 Epoch: [2][2149/4426]	Eit 11000  lr 0.0005  Le 9.9181 (9.9586)	Time 0.602 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:39:54,593 Epoch: [2][2349/4426]	Eit 11200  lr 0.0005  Le 9.9811 (9.9587)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:41:54,681 Epoch: [2][2549/4426]	Eit 11400  lr 0.0005  Le 9.9576 (9.9586)	Time 0.588 (0.000)	Data 0.003 (0.000)	
2021-06-21 10:43:57,274 Epoch: [2][2749/4426]	Eit 11600  lr 0.0005  Le 9.9704 (9.9585)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:45:58,600 Epoch: [2][2949/4426]	Eit 11800  lr 0.0005  Le 10.0039 (9.9582)	Time 0.751 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:48:01,861 Epoch: [2][3149/4426]	Eit 12000  lr 0.0005  Le 9.9767 (9.9580)	Time 0.597 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:50:03,450 Epoch: [2][3349/4426]	Eit 12200  lr 0.0005  Le 9.9549 (9.9578)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:52:05,043 Epoch: [2][3549/4426]	Eit 12400  lr 0.0005  Le 9.9274 (9.9577)	Time 0.560 (0.000)	Data 0.003 (0.000)	
2021-06-21 10:54:07,511 Epoch: [2][3749/4426]	Eit 12600  lr 0.0005  Le 9.9389 (9.9573)	Time 0.533 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:56:10,431 Epoch: [2][3949/4426]	Eit 12800  lr 0.0005  Le 9.9559 (9.9571)	Time 0.595 (0.000)	Data 0.002 (0.000)	
2021-06-21 10:58:13,065 Epoch: [2][4149/4426]	Eit 13000  lr 0.0005  Le 9.9262 (9.9570)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:00:16,472 Epoch: [2][4349/4426]	Eit 13200  lr 0.0005  Le 9.9748 (9.9568)	Time 0.593 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:01:12,093 Test: [0/40]	Le 10.1924 (10.1924)	Time 9.098 (0.000)	
2021-06-21 11:01:22,905 calculate similarity time: 0.04707646369934082
2021-06-21 11:01:23,409 Image to text: 69.7, 93.3, 97.9, 1.0, 2.9
2021-06-21 11:01:23,738 Text to image: 55.5, 87.1, 94.9, 1.0, 4.2
2021-06-21 11:01:23,738 Current rsum is 498.42
2021-06-21 11:01:26,662 runs/coco_butd_region_bert/log
2021-06-21 11:01:26,662 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 11:01:26,664 image encoder trainable parameters: 3688352
2021-06-21 11:01:26,674 txt encoder trainable parameters: 120517280
2021-06-21 11:02:51,802 Epoch: [3][124/4426]	Eit 13400  lr 0.0005  Le 9.9908 (9.9452)	Time 0.617 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:04:54,245 Epoch: [3][324/4426]	Eit 13600  lr 0.0005  Le 9.9598 (9.9435)	Time 0.604 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:06:56,394 Epoch: [3][524/4426]	Eit 13800  lr 0.0005  Le 9.9713 (9.9434)	Time 0.628 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:08:56,772 Epoch: [3][724/4426]	Eit 14000  lr 0.0005  Le 9.9370 (9.9434)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:10:58,497 Epoch: [3][924/4426]	Eit 14200  lr 0.0005  Le 9.9581 (9.9430)	Time 0.599 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:13:01,976 Epoch: [3][1124/4426]	Eit 14400  lr 0.0005  Le 9.9143 (9.9434)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:15:03,963 Epoch: [3][1324/4426]	Eit 14600  lr 0.0005  Le 9.9407 (9.9430)	Time 0.638 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:17:05,889 Epoch: [3][1524/4426]	Eit 14800  lr 0.0005  Le 9.9319 (9.9427)	Time 0.578 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:19:08,421 Epoch: [3][1724/4426]	Eit 15000  lr 0.0005  Le 9.9515 (9.9431)	Time 0.669 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:21:08,700 Epoch: [3][1924/4426]	Eit 15200  lr 0.0005  Le 9.9084 (9.9432)	Time 0.626 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:23:11,604 Epoch: [3][2124/4426]	Eit 15400  lr 0.0005  Le 9.9172 (9.9429)	Time 0.780 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:25:15,286 Epoch: [3][2324/4426]	Eit 15600  lr 0.0005  Le 9.9081 (9.9429)	Time 0.625 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:27:16,774 Epoch: [3][2524/4426]	Eit 15800  lr 0.0005  Le 9.9902 (9.9430)	Time 0.656 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:29:17,752 Epoch: [3][2724/4426]	Eit 16000  lr 0.0005  Le 9.9254 (9.9431)	Time 0.560 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:31:18,584 Epoch: [3][2924/4426]	Eit 16200  lr 0.0005  Le 9.9514 (9.9429)	Time 0.642 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:33:18,715 Epoch: [3][3124/4426]	Eit 16400  lr 0.0005  Le 9.9232 (9.9428)	Time 0.566 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:35:17,588 Epoch: [3][3324/4426]	Eit 16600  lr 0.0005  Le 9.9348 (9.9429)	Time 0.558 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:37:17,769 Epoch: [3][3524/4426]	Eit 16800  lr 0.0005  Le 9.9346 (9.9428)	Time 0.709 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:39:15,429 Epoch: [3][3724/4426]	Eit 17000  lr 0.0005  Le 9.9540 (9.9427)	Time 0.569 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:41:13,500 Epoch: [3][3924/4426]	Eit 17200  lr 0.0005  Le 9.9175 (9.9426)	Time 0.567 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:43:11,802 Epoch: [3][4124/4426]	Eit 17400  lr 0.0005  Le 9.9491 (9.9424)	Time 0.558 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:45:13,800 Epoch: [3][4324/4426]	Eit 17600  lr 0.0005  Le 9.9401 (9.9424)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:46:24,123 Test: [0/40]	Le 10.1918 (10.1918)	Time 9.141 (0.000)	
2021-06-21 11:46:34,848 calculate similarity time: 0.04910993576049805
2021-06-21 11:46:35,349 Image to text: 71.7, 94.7, 98.6, 1.0, 3.1
2021-06-21 11:46:35,669 Text to image: 56.0, 87.6, 95.1, 1.0, 4.4
2021-06-21 11:46:35,669 Current rsum is 503.74
2021-06-21 11:46:38,597 runs/coco_butd_region_bert/log
2021-06-21 11:46:38,597 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 11:46:38,599 image encoder trainable parameters: 3688352
2021-06-21 11:46:38,610 txt encoder trainable parameters: 120517280
2021-06-21 11:47:47,275 Epoch: [4][99/4426]	Eit 17800  lr 0.0005  Le 9.9148 (9.9316)	Time 0.579 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:49:53,112 Epoch: [4][299/4426]	Eit 18000  lr 0.0005  Le 9.9423 (9.9325)	Time 0.582 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:54:09,445 Epoch: [4][499/4426]	Eit 18200  lr 0.0005  Le 9.9039 (9.9318)	Time 1.238 (0.000)	Data 0.002 (0.000)	
2021-06-21 11:58:48,665 Epoch: [4][699/4426]	Eit 18400  lr 0.0005  Le 9.9373 (9.9308)	Time 1.203 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:03:30,812 Epoch: [4][899/4426]	Eit 18600  lr 0.0005  Le 9.9546 (9.9311)	Time 1.653 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:08:11,853 Epoch: [4][1099/4426]	Eit 18800  lr 0.0005  Le 9.9739 (9.9305)	Time 1.297 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:12:52,432 Epoch: [4][1299/4426]	Eit 19000  lr 0.0005  Le 9.9462 (9.9306)	Time 1.266 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:17:33,478 Epoch: [4][1499/4426]	Eit 19200  lr 0.0005  Le 9.9222 (9.9309)	Time 1.183 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:22:13,320 Epoch: [4][1699/4426]	Eit 19400  lr 0.0005  Le 9.9594 (9.9307)	Time 1.466 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:26:52,724 Epoch: [4][1899/4426]	Eit 19600  lr 0.0005  Le 9.9392 (9.9307)	Time 1.272 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:31:34,695 Epoch: [4][2099/4426]	Eit 19800  lr 0.0005  Le 9.9470 (9.9307)	Time 1.631 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:36:13,170 Epoch: [4][2299/4426]	Eit 20000  lr 0.0005  Le 9.9274 (9.9307)	Time 1.334 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:40:53,928 Epoch: [4][2499/4426]	Eit 20200  lr 0.0005  Le 9.9236 (9.9307)	Time 1.631 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:45:32,193 Epoch: [4][2699/4426]	Eit 20400  lr 0.0005  Le 9.9302 (9.9310)	Time 1.193 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:50:12,272 Epoch: [4][2899/4426]	Eit 20600  lr 0.0005  Le 9.9371 (9.9313)	Time 1.271 (0.000)	Data 0.001 (0.000)	
2021-06-21 12:54:51,780 Epoch: [4][3099/4426]	Eit 20800  lr 0.0005  Le 9.9803 (9.9312)	Time 1.672 (0.000)	Data 0.002 (0.000)	
2021-06-21 12:59:32,604 Epoch: [4][3299/4426]	Eit 21000  lr 0.0005  Le 9.9262 (9.9311)	Time 1.368 (0.000)	Data 0.003 (0.000)	
2021-06-21 13:03:42,612 Epoch: [4][3499/4426]	Eit 21200  lr 0.0005  Le 9.9383 (9.9310)	Time 1.140 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:08:22,544 Epoch: [4][3699/4426]	Eit 21400  lr 0.0005  Le 9.9291 (9.9308)	Time 1.185 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:13:05,751 Epoch: [4][3899/4426]	Eit 21600  lr 0.0005  Le 9.9198 (9.9310)	Time 1.228 (0.000)	Data 0.001 (0.000)	
2021-06-21 13:17:44,523 Epoch: [4][4099/4426]	Eit 21800  lr 0.0005  Le 9.9190 (9.9311)	Time 1.583 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:22:23,675 Epoch: [4][4299/4426]	Eit 22000  lr 0.0005  Le 9.9286 (9.9310)	Time 1.622 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:25:26,248 Test: [0/40]	Le 10.1862 (10.1862)	Time 8.252 (0.000)	
2021-06-21 13:25:47,802 calculate similarity time: 0.07354593276977539
2021-06-21 13:25:48,309 Image to text: 73.6, 95.6, 99.0, 1.0, 2.7
2021-06-21 13:25:48,761 Text to image: 58.0, 88.7, 95.2, 1.0, 4.2
2021-06-21 13:25:48,761 Current rsum is 510.14000000000004
2021-06-21 13:25:51,722 runs/coco_butd_region_bert/log
2021-06-21 13:25:51,722 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 13:25:51,724 image encoder trainable parameters: 3688352
2021-06-21 13:25:51,731 txt encoder trainable parameters: 120517280
2021-06-21 13:27:44,978 Epoch: [5][74/4426]	Eit 22200  lr 0.0005  Le 9.9147 (9.9200)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:32:23,921 Epoch: [5][274/4426]	Eit 22400  lr 0.0005  Le 9.9445 (9.9211)	Time 1.202 (0.000)	Data 0.003 (0.000)	
2021-06-21 13:37:03,851 Epoch: [5][474/4426]	Eit 22600  lr 0.0005  Le 9.9332 (9.9210)	Time 1.196 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:41:44,305 Epoch: [5][674/4426]	Eit 22800  lr 0.0005  Le 9.9266 (9.9216)	Time 1.525 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:46:23,851 Epoch: [5][874/4426]	Eit 23000  lr 0.0005  Le 9.8925 (9.9222)	Time 1.625 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:51:03,722 Epoch: [5][1074/4426]	Eit 23200  lr 0.0005  Le 9.8946 (9.9223)	Time 1.509 (0.000)	Data 0.002 (0.000)	
2021-06-21 13:55:42,364 Epoch: [5][1274/4426]	Eit 23400  lr 0.0005  Le 9.9139 (9.9225)	Time 1.621 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:00:21,338 Epoch: [5][1474/4426]	Eit 23600  lr 0.0005  Le 9.8891 (9.9221)	Time 1.382 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:05:00,071 Epoch: [5][1674/4426]	Eit 23800  lr 0.0005  Le 9.9569 (9.9221)	Time 1.850 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:09:39,059 Epoch: [5][1874/4426]	Eit 24000  lr 0.0005  Le 9.9175 (9.9222)	Time 1.192 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:13:48,061 Epoch: [5][2074/4426]	Eit 24200  lr 0.0005  Le 9.9070 (9.9223)	Time 1.442 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:18:28,614 Epoch: [5][2274/4426]	Eit 24400  lr 0.0005  Le 9.9510 (9.9224)	Time 1.357 (0.000)	Data 0.001 (0.000)	
2021-06-21 14:23:08,810 Epoch: [5][2474/4426]	Eit 24600  lr 0.0005  Le 9.9568 (9.9225)	Time 1.293 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:27:44,900 Epoch: [5][2674/4426]	Eit 24800  lr 0.0005  Le 9.9381 (9.9224)	Time 1.361 (0.000)	Data 0.001 (0.000)	
2021-06-21 14:32:25,747 Epoch: [5][2874/4426]	Eit 25000  lr 0.0005  Le 9.8938 (9.9225)	Time 1.354 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:37:05,735 Epoch: [5][3074/4426]	Eit 25200  lr 0.0005  Le 9.9372 (9.9226)	Time 1.140 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:41:43,417 Epoch: [5][3274/4426]	Eit 25400  lr 0.0005  Le 9.8801 (9.9226)	Time 1.226 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:46:22,529 Epoch: [5][3474/4426]	Eit 25600  lr 0.0005  Le 9.9330 (9.9228)	Time 1.160 (0.000)	Data 0.002 (0.000)	
2021-06-21 14:51:02,361 Epoch: [5][3674/4426]	Eit 25800  lr 0.0005  Le 9.9630 (9.9226)	Time 1.426 (0.000)	Data 0.001 (0.000)	
2021-06-21 14:55:38,556 Epoch: [5][3874/4426]	Eit 26000  lr 0.0005  Le 9.9155 (9.9228)	Time 1.137 (0.000)	Data 0.008 (0.000)	
2021-06-21 15:00:15,724 Epoch: [5][4074/4426]	Eit 26200  lr 0.0005  Le 9.9226 (9.9228)	Time 1.450 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:04:53,881 Epoch: [5][4274/4426]	Eit 26400  lr 0.0005  Le 9.9274 (9.9227)	Time 1.582 (0.000)	Data 0.001 (0.000)	
2021-06-21 15:08:34,388 Test: [0/40]	Le 10.1911 (10.1911)	Time 8.348 (0.000)	
2021-06-21 15:08:55,808 calculate similarity time: 0.060173749923706055
2021-06-21 15:08:56,208 Image to text: 74.9, 95.9, 98.5, 1.0, 2.3
2021-06-21 15:08:56,605 Text to image: 58.2, 89.0, 95.4, 1.0, 4.3
2021-06-21 15:08:56,605 Current rsum is 511.84000000000003
2021-06-21 15:08:59,624 runs/coco_butd_region_bert/log
2021-06-21 15:08:59,624 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 15:08:59,625 image encoder trainable parameters: 3688352
2021-06-21 15:08:59,633 txt encoder trainable parameters: 120517280
2021-06-21 15:10:16,750 Epoch: [6][49/4426]	Eit 26600  lr 0.0005  Le 9.8730 (9.9133)	Time 1.107 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:14:55,685 Epoch: [6][249/4426]	Eit 26800  lr 0.0005  Le 9.8936 (9.9139)	Time 1.180 (0.000)	Data 0.001 (0.000)	
2021-06-21 15:19:35,262 Epoch: [6][449/4426]	Eit 27000  lr 0.0005  Le 9.9282 (9.9134)	Time 1.387 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:23:42,612 Epoch: [6][649/4426]	Eit 27200  lr 0.0005  Le 9.8935 (9.9137)	Time 1.235 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:28:23,513 Epoch: [6][849/4426]	Eit 27400  lr 0.0005  Le 9.9280 (9.9139)	Time 1.479 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:33:01,701 Epoch: [6][1049/4426]	Eit 27600  lr 0.0005  Le 9.9162 (9.9142)	Time 1.186 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:37:41,402 Epoch: [6][1249/4426]	Eit 27800  lr 0.0005  Le 9.9157 (9.9143)	Time 1.528 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:42:20,944 Epoch: [6][1449/4426]	Eit 28000  lr 0.0005  Le 9.9151 (9.9145)	Time 1.559 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:46:58,632 Epoch: [6][1649/4426]	Eit 28200  lr 0.0005  Le 9.9281 (9.9145)	Time 1.237 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:51:38,746 Epoch: [6][1849/4426]	Eit 28400  lr 0.0005  Le 9.9333 (9.9146)	Time 1.399 (0.000)	Data 0.002 (0.000)	
2021-06-21 15:56:20,821 Epoch: [6][2049/4426]	Eit 28600  lr 0.0005  Le 9.9154 (9.9146)	Time 1.498 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:01:00,253 Epoch: [6][2249/4426]	Eit 28800  lr 0.0005  Le 9.9024 (9.9148)	Time 1.281 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:05:39,570 Epoch: [6][2449/4426]	Eit 29000  lr 0.0005  Le 9.9140 (9.9147)	Time 1.485 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:10:18,106 Epoch: [6][2649/4426]	Eit 29200  lr 0.0005  Le 9.9144 (9.9147)	Time 1.491 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:15:00,491 Epoch: [6][2849/4426]	Eit 29400  lr 0.0005  Le 9.8878 (9.9149)	Time 1.377 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:19:38,912 Epoch: [6][3049/4426]	Eit 29600  lr 0.0005  Le 9.9077 (9.9150)	Time 1.461 (0.000)	Data 0.001 (0.000)	
2021-06-21 16:24:16,557 Epoch: [6][3249/4426]	Eit 29800  lr 0.0005  Le 9.9249 (9.9151)	Time 1.228 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:28:54,063 Epoch: [6][3449/4426]	Eit 30000  lr 0.0005  Le 9.9363 (9.9150)	Time 1.276 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:33:08,178 Epoch: [6][3649/4426]	Eit 30200  lr 0.0005  Le 9.9052 (9.9151)	Time 1.283 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:37:50,618 Epoch: [6][3849/4426]	Eit 30400  lr 0.0005  Le 9.9394 (9.9151)	Time 1.571 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:42:32,877 Epoch: [6][4049/4426]	Eit 30600  lr 0.0005  Le 9.9072 (9.9151)	Time 1.512 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:47:13,860 Epoch: [6][4249/4426]	Eit 30800  lr 0.0005  Le 9.9147 (9.9150)	Time 1.464 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:51:28,230 Test: [0/40]	Le 10.1939 (10.1939)	Time 8.080 (0.000)	
2021-06-21 16:51:50,146 calculate similarity time: 0.07055830955505371
2021-06-21 16:51:50,707 Image to text: 73.4, 95.6, 99.0, 1.0, 2.3
2021-06-21 16:51:51,072 Text to image: 57.8, 89.2, 95.5, 1.0, 4.1
2021-06-21 16:51:51,072 Current rsum is 510.44
2021-06-21 16:51:52,280 runs/coco_butd_region_bert/log
2021-06-21 16:51:52,281 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 16:51:52,281 image encoder trainable parameters: 3688352
2021-06-21 16:51:52,286 txt encoder trainable parameters: 120517280
2021-06-21 16:52:34,517 Epoch: [7][24/4426]	Eit 31000  lr 0.0005  Le 9.8996 (9.9103)	Time 1.478 (0.000)	Data 0.002 (0.000)	
2021-06-21 16:57:10,914 Epoch: [7][224/4426]	Eit 31200  lr 0.0005  Le 9.8899 (9.9077)	Time 1.441 (0.000)	Data 0.001 (0.000)	
2021-06-21 17:01:50,962 Epoch: [7][424/4426]	Eit 31400  lr 0.0005  Le 9.9204 (9.9079)	Time 1.609 (0.000)	Data 0.001 (0.000)	
2021-06-21 17:06:30,092 Epoch: [7][624/4426]	Eit 31600  lr 0.0005  Le 9.9030 (9.9073)	Time 1.153 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:11:10,016 Epoch: [7][824/4426]	Eit 31800  lr 0.0005  Le 9.8859 (9.9071)	Time 1.665 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:15:49,443 Epoch: [7][1024/4426]	Eit 32000  lr 0.0005  Le 9.8946 (9.9078)	Time 1.818 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:20:28,889 Epoch: [7][1224/4426]	Eit 32200  lr 0.0005  Le 9.9070 (9.9079)	Time 1.572 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:25:08,420 Epoch: [7][1424/4426]	Eit 32400  lr 0.0005  Le 9.9013 (9.9081)	Time 1.483 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:29:44,507 Epoch: [7][1624/4426]	Eit 32600  lr 0.0005  Le 9.8912 (9.9080)	Time 1.372 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:34:20,839 Epoch: [7][1824/4426]	Eit 32800  lr 0.0005  Le 9.9085 (9.9081)	Time 1.352 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:38:58,157 Epoch: [7][2024/4426]	Eit 33000  lr 0.0005  Le 9.9015 (9.9084)	Time 1.616 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:43:10,367 Epoch: [7][2224/4426]	Eit 33200  lr 0.0005  Le 9.9141 (9.9083)	Time 1.498 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:47:50,317 Epoch: [7][2424/4426]	Eit 33400  lr 0.0005  Le 9.9079 (9.9086)	Time 1.191 (0.000)	Data 0.012 (0.000)	
2021-06-21 17:52:29,224 Epoch: [7][2624/4426]	Eit 33600  lr 0.0005  Le 9.8845 (9.9085)	Time 1.556 (0.000)	Data 0.002 (0.000)	
2021-06-21 17:57:12,648 Epoch: [7][2824/4426]	Eit 33800  lr 0.0005  Le 9.8731 (9.9087)	Time 1.504 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:01:51,235 Epoch: [7][3024/4426]	Eit 34000  lr 0.0005  Le 9.8888 (9.9087)	Time 1.338 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:06:31,740 Epoch: [7][3224/4426]	Eit 34200  lr 0.0005  Le 9.9101 (9.9088)	Time 1.229 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:11:10,341 Epoch: [7][3424/4426]	Eit 34400  lr 0.0005  Le 9.9217 (9.9088)	Time 1.335 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:15:50,379 Epoch: [7][3624/4426]	Eit 34600  lr 0.0005  Le 9.9399 (9.9090)	Time 1.522 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:20:32,583 Epoch: [7][3824/4426]	Eit 34800  lr 0.0005  Le 9.9117 (9.9090)	Time 1.501 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:25:11,410 Epoch: [7][4024/4426]	Eit 35000  lr 0.0005  Le 9.9078 (9.9090)	Time 1.281 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:29:47,337 Epoch: [7][4224/4426]	Eit 35200  lr 0.0005  Le 9.8953 (9.9090)	Time 1.372 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:34:28,302 Epoch: [7][4424/4426]	Eit 35400  lr 0.0005  Le 9.9227 (9.9089)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:34:38,001 Test: [0/40]	Le 10.2010 (10.2010)	Time 8.260 (0.000)	
2021-06-21 18:34:59,560 calculate similarity time: 0.06714081764221191
2021-06-21 18:35:00,096 Image to text: 73.9, 94.9, 98.8, 1.0, 3.4
2021-06-21 18:35:00,506 Text to image: 58.3, 89.4, 95.5, 1.0, 4.3
2021-06-21 18:35:00,506 Current rsum is 510.74
2021-06-21 18:35:01,973 runs/coco_butd_region_bert/log
2021-06-21 18:35:01,973 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 18:35:01,974 image encoder trainable parameters: 3688352
2021-06-21 18:35:01,978 txt encoder trainable parameters: 120517280
2021-06-21 18:39:48,776 Epoch: [8][199/4426]	Eit 35600  lr 0.0005  Le 9.8920 (9.9011)	Time 1.199 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:44:29,834 Epoch: [8][399/4426]	Eit 35800  lr 0.0005  Le 9.9041 (9.9009)	Time 1.298 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:49:10,090 Epoch: [8][599/4426]	Eit 36000  lr 0.0005  Le 9.8944 (9.9007)	Time 1.312 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:53:22,503 Epoch: [8][799/4426]	Eit 36200  lr 0.0005  Le 9.8818 (9.9008)	Time 1.213 (0.000)	Data 0.002 (0.000)	
2021-06-21 18:58:00,113 Epoch: [8][999/4426]	Eit 36400  lr 0.0005  Le 9.8987 (9.9005)	Time 1.470 (0.000)	Data 0.001 (0.000)	
2021-06-21 19:02:41,733 Epoch: [8][1199/4426]	Eit 36600  lr 0.0005  Le 9.9143 (9.9010)	Time 1.457 (0.000)	Data 0.001 (0.000)	
2021-06-21 19:07:21,923 Epoch: [8][1399/4426]	Eit 36800  lr 0.0005  Le 9.8833 (9.9012)	Time 1.330 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:12:03,867 Epoch: [8][1599/4426]	Eit 37000  lr 0.0005  Le 9.9175 (9.9012)	Time 1.554 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:16:44,685 Epoch: [8][1799/4426]	Eit 37200  lr 0.0005  Le 9.9268 (9.9015)	Time 1.369 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:21:24,672 Epoch: [8][1999/4426]	Eit 37400  lr 0.0005  Le 9.8915 (9.9018)	Time 1.139 (0.000)	Data 0.001 (0.000)	
2021-06-21 19:26:04,841 Epoch: [8][2199/4426]	Eit 37600  lr 0.0005  Le 9.8917 (9.9019)	Time 1.253 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:30:44,122 Epoch: [8][2399/4426]	Eit 37800  lr 0.0005  Le 9.9324 (9.9020)	Time 1.624 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:35:23,420 Epoch: [8][2599/4426]	Eit 38000  lr 0.0005  Le 9.9048 (9.9022)	Time 1.520 (0.000)	Data 0.003 (0.000)	
2021-06-21 19:40:02,431 Epoch: [8][2799/4426]	Eit 38200  lr 0.0005  Le 9.9171 (9.9024)	Time 1.466 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:44:41,259 Epoch: [8][2999/4426]	Eit 38400  lr 0.0005  Le 9.8967 (9.9024)	Time 1.248 (0.000)	Data 0.001 (0.000)	
2021-06-21 19:49:22,894 Epoch: [8][3199/4426]	Eit 38600  lr 0.0005  Le 9.8803 (9.9026)	Time 1.229 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:54:01,490 Epoch: [8][3399/4426]	Eit 38800  lr 0.0005  Le 9.9120 (9.9025)	Time 1.626 (0.000)	Data 0.002 (0.000)	
2021-06-21 19:58:43,589 Epoch: [8][3599/4426]	Eit 39000  lr 0.0005  Le 9.9369 (9.9027)	Time 1.254 (0.000)	Data 0.003 (0.000)	
2021-06-21 20:02:52,720 Epoch: [8][3799/4426]	Eit 39200  lr 0.0005  Le 9.9208 (9.9026)	Time 1.612 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:07:34,176 Epoch: [8][3999/4426]	Eit 39400  lr 0.0005  Le 9.9050 (9.9027)	Time 1.521 (0.000)	Data 0.001 (0.000)	
2021-06-21 20:12:15,069 Epoch: [8][4199/4426]	Eit 39600  lr 0.0005  Le 9.8892 (9.9029)	Time 1.411 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:16:54,256 Epoch: [8][4399/4426]	Eit 39800  lr 0.0005  Le 9.9045 (9.9031)	Time 1.493 (0.000)	Data 0.001 (0.000)	
2021-06-21 20:17:37,577 Test: [0/40]	Le 10.2024 (10.2024)	Time 7.808 (0.000)	
2021-06-21 20:17:58,750 calculate similarity time: 0.06926870346069336
2021-06-21 20:17:59,176 Image to text: 71.9, 96.2, 98.7, 1.0, 2.1
2021-06-21 20:17:59,606 Text to image: 59.5, 89.7, 95.8, 1.0, 4.3
2021-06-21 20:17:59,607 Current rsum is 511.76
2021-06-21 20:18:00,890 runs/coco_butd_region_bert/log
2021-06-21 20:18:00,890 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 20:18:00,891 image encoder trainable parameters: 3688352
2021-06-21 20:18:00,896 txt encoder trainable parameters: 120517280
2021-06-21 20:22:14,062 Epoch: [9][174/4426]	Eit 40000  lr 0.0005  Le 9.9056 (9.8946)	Time 1.548 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:26:53,646 Epoch: [9][374/4426]	Eit 40200  lr 0.0005  Le 9.8889 (9.8954)	Time 1.595 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:31:32,177 Epoch: [9][574/4426]	Eit 40400  lr 0.0005  Le 9.9026 (9.8956)	Time 1.263 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:36:09,929 Epoch: [9][774/4426]	Eit 40600  lr 0.0005  Le 9.9305 (9.8958)	Time 1.346 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:40:50,090 Epoch: [9][974/4426]	Eit 40800  lr 0.0005  Le 9.9161 (9.8961)	Time 1.609 (0.000)	Data 0.001 (0.000)	
2021-06-21 20:45:29,928 Epoch: [9][1174/4426]	Eit 41000  lr 0.0005  Le 9.8961 (9.8965)	Time 1.536 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:50:08,390 Epoch: [9][1374/4426]	Eit 41200  lr 0.0005  Le 9.9087 (9.8966)	Time 1.181 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:54:48,567 Epoch: [9][1574/4426]	Eit 41400  lr 0.0005  Le 9.8981 (9.8967)	Time 1.595 (0.000)	Data 0.002 (0.000)	
2021-06-21 20:59:26,762 Epoch: [9][1774/4426]	Eit 41600  lr 0.0005  Le 9.9249 (9.8971)	Time 1.648 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:04:06,977 Epoch: [9][1974/4426]	Eit 41800  lr 0.0005  Le 9.8976 (9.8972)	Time 1.637 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:08:45,285 Epoch: [9][2174/4426]	Eit 42000  lr 0.0005  Le 9.8607 (9.8972)	Time 1.712 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:12:57,716 Epoch: [9][2374/4426]	Eit 42200  lr 0.0005  Le 9.9319 (9.8974)	Time 1.531 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:17:37,953 Epoch: [9][2574/4426]	Eit 42400  lr 0.0005  Le 9.9300 (9.8975)	Time 1.178 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:22:15,412 Epoch: [9][2774/4426]	Eit 42600  lr 0.0005  Le 9.9045 (9.8974)	Time 1.279 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:26:55,801 Epoch: [9][2974/4426]	Eit 42800  lr 0.0005  Le 9.8862 (9.8977)	Time 1.633 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:31:33,398 Epoch: [9][3174/4426]	Eit 43000  lr 0.0005  Le 9.8805 (9.8979)	Time 1.578 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:36:12,802 Epoch: [9][3374/4426]	Eit 43200  lr 0.0005  Le 9.9345 (9.8978)	Time 1.299 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:40:54,501 Epoch: [9][3574/4426]	Eit 43400  lr 0.0005  Le 9.9010 (9.8981)	Time 1.560 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:45:31,310 Epoch: [9][3774/4426]	Eit 43600  lr 0.0005  Le 9.9215 (9.8983)	Time 1.477 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:50:09,640 Epoch: [9][3974/4426]	Eit 43800  lr 0.0005  Le 9.9407 (9.8983)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-21 21:54:49,558 Epoch: [9][4174/4426]	Eit 44000  lr 0.0005  Le 9.9195 (9.8985)	Time 1.457 (0.000)	Data 0.003 (0.000)	
2021-06-21 21:59:29,666 Epoch: [9][4374/4426]	Eit 44200  lr 0.0005  Le 9.8558 (9.8986)	Time 1.207 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:00:51,135 Test: [0/40]	Le 10.1944 (10.1944)	Time 9.235 (0.000)	
2021-06-21 22:01:13,421 calculate similarity time: 0.10186314582824707
2021-06-21 22:01:13,815 Image to text: 73.3, 94.8, 99.1, 1.0, 2.2
2021-06-21 22:01:14,247 Text to image: 59.3, 88.9, 95.4, 1.0, 4.1
2021-06-21 22:01:14,247 Current rsum is 510.76
2021-06-21 22:01:15,921 runs/coco_butd_region_bert/log
2021-06-21 22:01:15,921 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 22:01:15,922 image encoder trainable parameters: 3688352
2021-06-21 22:01:15,928 txt encoder trainable parameters: 120517280
2021-06-21 22:04:54,152 Epoch: [10][149/4426]	Eit 44400  lr 0.0005  Le 9.8650 (9.8883)	Time 1.710 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:09:33,554 Epoch: [10][349/4426]	Eit 44600  lr 0.0005  Le 9.9008 (9.8911)	Time 1.164 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:14:12,551 Epoch: [10][549/4426]	Eit 44800  lr 0.0005  Le 9.8925 (9.8911)	Time 1.559 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:18:50,925 Epoch: [10][749/4426]	Eit 45000  lr 0.0005  Le 9.9010 (9.8913)	Time 1.486 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:23:01,516 Epoch: [10][949/4426]	Eit 45200  lr 0.0005  Le 9.8881 (9.8914)	Time 1.552 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:27:39,387 Epoch: [10][1149/4426]	Eit 45400  lr 0.0005  Le 9.8756 (9.8918)	Time 1.615 (0.000)	Data 0.001 (0.000)	
2021-06-21 22:32:20,594 Epoch: [10][1349/4426]	Eit 45600  lr 0.0005  Le 9.9041 (9.8919)	Time 1.164 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:37:00,784 Epoch: [10][1549/4426]	Eit 45800  lr 0.0005  Le 9.8815 (9.8923)	Time 1.590 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:41:43,853 Epoch: [10][1749/4426]	Eit 46000  lr 0.0005  Le 9.8879 (9.8925)	Time 1.281 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:46:23,525 Epoch: [10][1949/4426]	Eit 46200  lr 0.0005  Le 9.8884 (9.8926)	Time 1.750 (0.000)	Data 0.002 (0.000)	
2021-06-21 22:51:05,992 Epoch: [10][2149/4426]	Eit 46400  lr 0.0005  Le 9.8925 (9.8928)	Time 1.303 (0.000)	Data 0.001 (0.000)	
2021-06-21 22:55:45,229 Epoch: [10][2349/4426]	Eit 46600  lr 0.0005  Le 9.9110 (9.8929)	Time 1.624 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:00:24,286 Epoch: [10][2549/4426]	Eit 46800  lr 0.0005  Le 9.8612 (9.8930)	Time 1.204 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:05:03,658 Epoch: [10][2749/4426]	Eit 47000  lr 0.0005  Le 9.9116 (9.8930)	Time 1.535 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:09:42,575 Epoch: [10][2949/4426]	Eit 47200  lr 0.0005  Le 9.8920 (9.8930)	Time 1.435 (0.000)	Data 0.001 (0.000)	
2021-06-21 23:14:22,431 Epoch: [10][3149/4426]	Eit 47400  lr 0.0005  Le 9.8736 (9.8931)	Time 1.197 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:19:03,031 Epoch: [10][3349/4426]	Eit 47600  lr 0.0005  Le 9.8768 (9.8933)	Time 1.251 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:23:43,332 Epoch: [10][3549/4426]	Eit 47800  lr 0.0005  Le 9.8711 (9.8933)	Time 1.298 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:28:22,356 Epoch: [10][3749/4426]	Eit 48000  lr 0.0005  Le 9.9230 (9.8933)	Time 1.542 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:32:48,921 Epoch: [10][3949/4426]	Eit 48200  lr 0.0005  Le 9.8699 (9.8934)	Time 1.511 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:37:13,285 Epoch: [10][4149/4426]	Eit 48400  lr 0.0005  Le 9.9200 (9.8935)	Time 1.469 (0.000)	Data 0.001 (0.000)	
2021-06-21 23:41:53,102 Epoch: [10][4349/4426]	Eit 48600  lr 0.0005  Le 9.8587 (9.8935)	Time 1.366 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:43:45,996 Test: [0/40]	Le 10.1942 (10.1942)	Time 8.634 (0.000)	
2021-06-21 23:44:08,642 calculate similarity time: 0.07107877731323242
2021-06-21 23:44:09,203 Image to text: 73.0, 95.7, 99.0, 1.0, 2.6
2021-06-21 23:44:09,680 Text to image: 60.6, 89.8, 95.7, 1.0, 4.1
2021-06-21 23:44:09,680 Current rsum is 513.8199999999999
2021-06-21 23:44:13,526 runs/coco_butd_region_bert/log
2021-06-21 23:44:13,526 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-21 23:44:13,528 image encoder trainable parameters: 3688352
2021-06-21 23:44:13,539 txt encoder trainable parameters: 120517280
2021-06-21 23:47:17,514 Epoch: [11][124/4426]	Eit 48800  lr 0.0005  Le 9.8613 (9.8875)	Time 1.302 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:51:57,994 Epoch: [11][324/4426]	Eit 49000  lr 0.0005  Le 9.9168 (9.8869)	Time 1.403 (0.000)	Data 0.002 (0.000)	
2021-06-21 23:56:39,715 Epoch: [11][524/4426]	Eit 49200  lr 0.0005  Le 9.8690 (9.8867)	Time 1.515 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:01:20,330 Epoch: [11][724/4426]	Eit 49400  lr 0.0005  Le 9.9007 (9.8868)	Time 1.712 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:05:58,914 Epoch: [11][924/4426]	Eit 49600  lr 0.0005  Le 9.8913 (9.8871)	Time 1.586 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:10:39,616 Epoch: [11][1124/4426]	Eit 49800  lr 0.0005  Le 9.8693 (9.8872)	Time 1.645 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:15:19,531 Epoch: [11][1324/4426]	Eit 50000  lr 0.0005  Le 9.9087 (9.8873)	Time 1.241 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:20:01,443 Epoch: [11][1524/4426]	Eit 50200  lr 0.0005  Le 9.9223 (9.8875)	Time 1.708 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:24:42,750 Epoch: [11][1724/4426]	Eit 50400  lr 0.0005  Le 9.8719 (9.8878)	Time 1.522 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:29:21,496 Epoch: [11][1924/4426]	Eit 50600  lr 0.0005  Le 9.8939 (9.8876)	Time 1.278 (0.000)	Data 0.003 (0.000)	
2021-06-22 00:34:00,209 Epoch: [11][2124/4426]	Eit 50800  lr 0.0005  Le 9.8798 (9.8879)	Time 1.167 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:38:39,357 Epoch: [11][2324/4426]	Eit 51000  lr 0.0005  Le 9.8714 (9.8883)	Time 1.639 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:43:11,804 Epoch: [11][2524/4426]	Eit 51200  lr 0.0005  Le 9.8931 (9.8884)	Time 0.562 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:47:27,088 Epoch: [11][2724/4426]	Eit 51400  lr 0.0005  Le 9.8925 (9.8885)	Time 1.093 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:52:07,514 Epoch: [11][2924/4426]	Eit 51600  lr 0.0005  Le 9.8870 (9.8886)	Time 1.428 (0.000)	Data 0.002 (0.000)	
2021-06-22 00:56:48,869 Epoch: [11][3124/4426]	Eit 51800  lr 0.0005  Le 9.8831 (9.8887)	Time 1.456 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:01:26,796 Epoch: [11][3324/4426]	Eit 52000  lr 0.0005  Le 9.8886 (9.8888)	Time 1.535 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:06:05,731 Epoch: [11][3524/4426]	Eit 52200  lr 0.0005  Le 9.9167 (9.8889)	Time 1.222 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:10:43,734 Epoch: [11][3724/4426]	Eit 52400  lr 0.0005  Le 9.8716 (9.8889)	Time 1.193 (0.000)	Data 0.003 (0.000)	
2021-06-22 01:15:22,039 Epoch: [11][3924/4426]	Eit 52600  lr 0.0005  Le 9.8968 (9.8890)	Time 1.243 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:20:01,911 Epoch: [11][4124/4426]	Eit 52800  lr 0.0005  Le 9.9055 (9.8891)	Time 1.398 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:24:40,103 Epoch: [11][4324/4426]	Eit 53000  lr 0.0005  Le 9.8668 (9.8892)	Time 1.676 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:27:07,997 Test: [0/40]	Le 10.2041 (10.2040)	Time 8.490 (0.000)	
2021-06-22 01:27:30,375 calculate similarity time: 0.0648806095123291
2021-06-22 01:27:30,891 Image to text: 74.2, 95.3, 98.8, 1.0, 2.3
2021-06-22 01:27:31,204 Text to image: 59.6, 89.6, 95.9, 1.0, 4.2
2021-06-22 01:27:31,204 Current rsum is 513.34
2021-06-22 01:27:32,585 runs/coco_butd_region_bert/log
2021-06-22 01:27:32,586 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 01:27:32,586 image encoder trainable parameters: 3688352
2021-06-22 01:27:32,591 txt encoder trainable parameters: 120517280
2021-06-22 01:30:00,908 Epoch: [12][99/4426]	Eit 53200  lr 0.0005  Le 9.9031 (9.8791)	Time 1.191 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:34:40,158 Epoch: [12][299/4426]	Eit 53400  lr 0.0005  Le 9.8862 (9.8806)	Time 1.547 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:39:19,086 Epoch: [12][499/4426]	Eit 53600  lr 0.0005  Le 9.8971 (9.8815)	Time 1.620 (0.000)	Data 0.003 (0.000)	
2021-06-22 01:43:58,685 Epoch: [12][699/4426]	Eit 53800  lr 0.0005  Le 9.9010 (9.8815)	Time 1.198 (0.000)	Data 0.013 (0.000)	
2021-06-22 01:48:37,723 Epoch: [12][899/4426]	Eit 54000  lr 0.0005  Le 9.8971 (9.8822)	Time 1.511 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:53:16,528 Epoch: [12][1099/4426]	Eit 54200  lr 0.0005  Le 9.8931 (9.8827)	Time 1.550 (0.000)	Data 0.002 (0.000)	
2021-06-22 01:57:26,881 Epoch: [12][1299/4426]	Eit 54400  lr 0.0005  Le 9.8915 (9.8830)	Time 1.203 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:02:07,927 Epoch: [12][1499/4426]	Eit 54600  lr 0.0005  Le 9.8678 (9.8831)	Time 1.189 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:06:48,040 Epoch: [12][1699/4426]	Eit 54800  lr 0.0005  Le 9.8704 (9.8836)	Time 1.544 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:11:29,298 Epoch: [12][1899/4426]	Eit 55000  lr 0.0005  Le 9.9079 (9.8840)	Time 1.489 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:16:07,633 Epoch: [12][2099/4426]	Eit 55200  lr 0.0005  Le 9.8957 (9.8840)	Time 1.497 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:20:46,972 Epoch: [12][2299/4426]	Eit 55400  lr 0.0005  Le 9.8999 (9.8840)	Time 1.449 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:25:27,883 Epoch: [12][2499/4426]	Eit 55600  lr 0.0005  Le 9.8748 (9.8840)	Time 1.544 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:30:05,979 Epoch: [12][2699/4426]	Eit 55800  lr 0.0005  Le 9.8808 (9.8843)	Time 1.126 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:34:42,911 Epoch: [12][2899/4426]	Eit 56000  lr 0.0005  Le 9.8885 (9.8845)	Time 1.235 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:39:24,482 Epoch: [12][3099/4426]	Eit 56200  lr 0.0005  Le 9.9326 (9.8847)	Time 1.225 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:44:05,633 Epoch: [12][3299/4426]	Eit 56400  lr 0.0005  Le 9.8671 (9.8848)	Time 1.407 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:48:45,537 Epoch: [12][3499/4426]	Eit 56600  lr 0.0005  Le 9.9000 (9.8848)	Time 1.209 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:53:25,009 Epoch: [12][3699/4426]	Eit 56800  lr 0.0005  Le 9.8708 (9.8850)	Time 1.594 (0.000)	Data 0.002 (0.000)	
2021-06-22 02:58:07,219 Epoch: [12][3899/4426]	Eit 57000  lr 0.0005  Le 9.8965 (9.8851)	Time 1.568 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:02:47,399 Epoch: [12][4099/4426]	Eit 57200  lr 0.0005  Le 9.8466 (9.8851)	Time 1.249 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:06:59,082 Epoch: [12][4299/4426]	Eit 57400  lr 0.0005  Le 9.9016 (9.8851)	Time 1.409 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:10:03,044 Test: [0/40]	Le 10.2074 (10.2074)	Time 8.038 (0.000)	
2021-06-22 03:10:25,275 calculate similarity time: 0.06725168228149414
2021-06-22 03:10:25,749 Image to text: 73.6, 95.5, 99.0, 1.0, 3.0
2021-06-22 03:10:26,092 Text to image: 59.9, 89.6, 95.7, 1.0, 4.5
2021-06-22 03:10:26,092 Current rsum is 513.28
2021-06-22 03:10:27,334 runs/coco_butd_region_bert/log
2021-06-22 03:10:27,334 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 03:10:27,335 image encoder trainable parameters: 3688352
2021-06-22 03:10:27,340 txt encoder trainable parameters: 120517280
2021-06-22 03:12:20,764 Epoch: [13][74/4426]	Eit 57600  lr 0.0005  Le 9.9165 (9.8746)	Time 1.169 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:16:57,786 Epoch: [13][274/4426]	Eit 57800  lr 0.0005  Le 9.8923 (9.8784)	Time 1.532 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:21:37,245 Epoch: [13][474/4426]	Eit 58000  lr 0.0005  Le 9.8809 (9.8789)	Time 1.190 (0.000)	Data 0.009 (0.000)	
2021-06-22 03:26:17,909 Epoch: [13][674/4426]	Eit 58200  lr 0.0005  Le 9.9236 (9.8789)	Time 1.601 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:30:57,515 Epoch: [13][874/4426]	Eit 58400  lr 0.0005  Le 9.8960 (9.8793)	Time 1.248 (0.000)	Data 0.003 (0.000)	
2021-06-22 03:35:38,565 Epoch: [13][1074/4426]	Eit 58600  lr 0.0005  Le 9.8785 (9.8795)	Time 1.385 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:40:15,517 Epoch: [13][1274/4426]	Eit 58800  lr 0.0005  Le 9.8828 (9.8802)	Time 1.175 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:44:57,837 Epoch: [13][1474/4426]	Eit 59000  lr 0.0005  Le 9.8709 (9.8800)	Time 1.378 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:49:35,483 Epoch: [13][1674/4426]	Eit 59200  lr 0.0005  Le 9.8514 (9.8802)	Time 1.161 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:54:17,092 Epoch: [13][1874/4426]	Eit 59400  lr 0.0005  Le 9.8775 (9.8803)	Time 1.410 (0.000)	Data 0.002 (0.000)	
2021-06-22 03:58:54,486 Epoch: [13][2074/4426]	Eit 59600  lr 0.0005  Le 9.8653 (9.8802)	Time 1.247 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:03:31,887 Epoch: [13][2274/4426]	Eit 59800  lr 0.0005  Le 9.8530 (9.8804)	Time 1.275 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:08:12,587 Epoch: [13][2474/4426]	Eit 60000  lr 0.0005  Le 9.8757 (9.8805)	Time 1.113 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:12:52,213 Epoch: [13][2674/4426]	Eit 60200  lr 0.0005  Le 9.8592 (9.8806)	Time 1.394 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:17:04,194 Epoch: [13][2874/4426]	Eit 60400  lr 0.0005  Le 9.8773 (9.8807)	Time 1.641 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:21:47,059 Epoch: [13][3074/4426]	Eit 60600  lr 0.0005  Le 9.8377 (9.8808)	Time 1.625 (0.000)	Data 0.011 (0.000)	
2021-06-22 04:26:27,690 Epoch: [13][3274/4426]	Eit 60800  lr 0.0005  Le 9.8826 (9.8809)	Time 1.585 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:31:06,169 Epoch: [13][3474/4426]	Eit 61000  lr 0.0005  Le 9.8870 (9.8810)	Time 1.124 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:35:45,004 Epoch: [13][3674/4426]	Eit 61200  lr 0.0005  Le 9.9227 (9.8810)	Time 1.118 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:40:25,325 Epoch: [13][3874/4426]	Eit 61400  lr 0.0005  Le 9.8666 (9.8812)	Time 1.305 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:45:04,229 Epoch: [13][4074/4426]	Eit 61600  lr 0.0005  Le 9.8751 (9.8813)	Time 1.349 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:49:42,312 Epoch: [13][4274/4426]	Eit 61800  lr 0.0005  Le 9.8915 (9.8814)	Time 1.212 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:53:17,992 Test: [0/40]	Le 10.1999 (10.1999)	Time 7.950 (0.000)	
2021-06-22 04:53:39,407 calculate similarity time: 0.07138895988464355
2021-06-22 04:53:39,941 Image to text: 72.6, 95.7, 98.9, 1.0, 3.3
2021-06-22 04:53:40,287 Text to image: 60.1, 89.7, 95.6, 1.0, 4.6
2021-06-22 04:53:40,287 Current rsum is 512.58
2021-06-22 04:53:41,540 runs/coco_butd_region_bert/log
2021-06-22 04:53:41,540 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 04:53:41,541 image encoder trainable parameters: 3688352
2021-06-22 04:53:41,546 txt encoder trainable parameters: 120517280
2021-06-22 04:54:57,448 Epoch: [14][49/4426]	Eit 62000  lr 0.0005  Le 9.8910 (9.8748)	Time 1.283 (0.000)	Data 0.002 (0.000)	
2021-06-22 04:59:38,857 Epoch: [14][249/4426]	Eit 62200  lr 0.0005  Le 9.8508 (9.8752)	Time 1.241 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:04:21,036 Epoch: [14][449/4426]	Eit 62400  lr 0.0005  Le 9.8679 (9.8751)	Time 1.149 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:08:59,225 Epoch: [14][649/4426]	Eit 62600  lr 0.0005  Le 9.8804 (9.8761)	Time 1.199 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:13:37,677 Epoch: [14][849/4426]	Eit 62800  lr 0.0005  Le 9.8271 (9.8760)	Time 1.704 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:18:17,003 Epoch: [14][1049/4426]	Eit 63000  lr 0.0005  Le 9.8843 (9.8757)	Time 1.440 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:22:56,884 Epoch: [14][1249/4426]	Eit 63200  lr 0.0005  Le 9.8879 (9.8760)	Time 1.544 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:27:11,633 Epoch: [14][1449/4426]	Eit 63400  lr 0.0005  Le 9.8311 (9.8761)	Time 1.203 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:31:49,523 Epoch: [14][1649/4426]	Eit 63600  lr 0.0005  Le 9.8793 (9.8763)	Time 1.478 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:36:28,494 Epoch: [14][1849/4426]	Eit 63800  lr 0.0005  Le 9.8437 (9.8764)	Time 1.650 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:41:06,927 Epoch: [14][2049/4426]	Eit 64000  lr 0.0005  Le 9.8706 (9.8766)	Time 1.645 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:45:48,655 Epoch: [14][2249/4426]	Eit 64200  lr 0.0005  Le 9.8809 (9.8767)	Time 1.469 (0.000)	Data 0.002 (0.000)	
2021-06-22 05:50:27,008 Epoch: [14][2449/4426]	Eit 64400  lr 0.0005  Le 9.8688 (9.8770)	Time 1.743 (0.000)	Data 0.003 (0.000)	
2021-06-22 05:55:07,628 Epoch: [14][2649/4426]	Eit 64600  lr 0.0005  Le 9.8733 (9.8770)	Time 1.610 (0.000)	Data 0.012 (0.000)	
2021-06-22 05:59:45,800 Epoch: [14][2849/4426]	Eit 64800  lr 0.0005  Le 9.8848 (9.8772)	Time 1.224 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:04:24,034 Epoch: [14][3049/4426]	Eit 65000  lr 0.0005  Le 9.8759 (9.8773)	Time 1.536 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:09:05,059 Epoch: [14][3249/4426]	Eit 65200  lr 0.0005  Le 9.8907 (9.8773)	Time 1.683 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:13:46,832 Epoch: [14][3449/4426]	Eit 65400  lr 0.0005  Le 9.8524 (9.8774)	Time 1.394 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:18:25,673 Epoch: [14][3649/4426]	Eit 65600  lr 0.0005  Le 9.8766 (9.8775)	Time 1.101 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:23:06,189 Epoch: [14][3849/4426]	Eit 65800  lr 0.0005  Le 9.8799 (9.8776)	Time 1.234 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:27:44,512 Epoch: [14][4049/4426]	Eit 66000  lr 0.0005  Le 9.8833 (9.8777)	Time 1.610 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:32:26,851 Epoch: [14][4249/4426]	Eit 66200  lr 0.0005  Le 9.8826 (9.8778)	Time 1.541 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:36:11,095 Test: [0/40]	Le 10.1988 (10.1988)	Time 8.029 (0.000)	
2021-06-22 06:36:33,325 calculate similarity time: 0.0602574348449707
2021-06-22 06:36:33,728 Image to text: 71.8, 95.4, 98.5, 1.0, 2.0
2021-06-22 06:36:34,054 Text to image: 59.2, 89.5, 95.9, 1.0, 4.1
2021-06-22 06:36:34,054 Current rsum is 510.32000000000005
2021-06-22 06:36:35,301 runs/coco_butd_region_bert/log
2021-06-22 06:36:35,302 runs/coco_butd_region_bert
2021-06-22 06:36:35,302 Current epoch num is 15, decrease all lr by 10
2021-06-22 06:36:35,302 new lr 5e-05
2021-06-22 06:36:35,302 new lr 5e-06
2021-06-22 06:36:35,302 new lr 5e-05
Use VSE++ objective.
2021-06-22 06:36:35,303 image encoder trainable parameters: 3688352
2021-06-22 06:36:35,307 txt encoder trainable parameters: 120517280
2021-06-22 06:37:18,115 Epoch: [15][24/4426]	Eit 66400  lr 5e-05  Le 9.8853 (9.8716)	Time 1.511 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:41:54,810 Epoch: [15][224/4426]	Eit 66600  lr 5e-05  Le 9.8679 (9.8694)	Time 1.501 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:46:34,235 Epoch: [15][424/4426]	Eit 66800  lr 5e-05  Le 9.8618 (9.8687)	Time 1.163 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:51:12,522 Epoch: [15][624/4426]	Eit 67000  lr 5e-05  Le 9.8503 (9.8674)	Time 1.477 (0.000)	Data 0.002 (0.000)	
2021-06-22 06:55:51,142 Epoch: [15][824/4426]	Eit 67200  lr 5e-05  Le 9.8631 (9.8660)	Time 1.342 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:00:31,241 Epoch: [15][1024/4426]	Eit 67400  lr 5e-05  Le 9.8722 (9.8656)	Time 1.471 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:05:07,810 Epoch: [15][1224/4426]	Eit 67600  lr 5e-05  Le 9.8745 (9.8653)	Time 1.526 (0.000)	Data 0.001 (0.000)	
2021-06-22 07:09:45,484 Epoch: [15][1424/4426]	Eit 67800  lr 5e-05  Le 9.8862 (9.8649)	Time 1.563 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:14:27,091 Epoch: [15][1624/4426]	Eit 68000  lr 5e-05  Le 9.8624 (9.8648)	Time 1.328 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:19:05,959 Epoch: [15][1824/4426]	Eit 68200  lr 5e-05  Le 9.8902 (9.8644)	Time 1.139 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:23:44,142 Epoch: [15][2024/4426]	Eit 68400  lr 5e-05  Le 9.8569 (9.8641)	Time 1.943 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:28:23,125 Epoch: [15][2224/4426]	Eit 68600  lr 5e-05  Le 9.8487 (9.8640)	Time 1.241 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:33:02,383 Epoch: [15][2424/4426]	Eit 68800  lr 5e-05  Le 9.8680 (9.8637)	Time 1.518 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:37:39,492 Epoch: [15][2624/4426]	Eit 69000  lr 5e-05  Le 9.8323 (9.8635)	Time 1.143 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:42:22,908 Epoch: [15][2824/4426]	Eit 69200  lr 5e-05  Le 9.8720 (9.8632)	Time 1.414 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:46:34,661 Epoch: [15][3024/4426]	Eit 69400  lr 5e-05  Le 9.8676 (9.8631)	Time 1.255 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:51:14,870 Epoch: [15][3224/4426]	Eit 69600  lr 5e-05  Le 9.8710 (9.8628)	Time 1.194 (0.000)	Data 0.002 (0.000)	
2021-06-22 07:55:56,231 Epoch: [15][3424/4426]	Eit 69800  lr 5e-05  Le 9.8256 (9.8625)	Time 1.666 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:00:35,556 Epoch: [15][3624/4426]	Eit 70000  lr 5e-05  Le 9.8685 (9.8624)	Time 1.459 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:05:17,689 Epoch: [15][3824/4426]	Eit 70200  lr 5e-05  Le 9.8701 (9.8623)	Time 1.242 (0.000)	Data 0.001 (0.000)	
2021-06-22 08:09:57,449 Epoch: [15][4024/4426]	Eit 70400  lr 5e-05  Le 9.8737 (9.8621)	Time 1.545 (0.000)	Data 0.001 (0.000)	
2021-06-22 08:14:36,329 Epoch: [15][4224/4426]	Eit 70600  lr 5e-05  Le 9.8235 (9.8619)	Time 1.151 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:19:14,750 Epoch: [15][4424/4426]	Eit 70800  lr 5e-05  Le 9.8681 (9.8618)	Time 1.183 (0.000)	Data 0.008 (0.000)	
2021-06-22 08:19:24,113 Test: [0/40]	Le 10.1990 (10.1990)	Time 8.232 (0.000)	
2021-06-22 08:19:45,372 calculate similarity time: 0.10596323013305664
2021-06-22 08:19:45,907 Image to text: 73.5, 95.6, 98.6, 1.0, 1.9
2021-06-22 08:19:46,355 Text to image: 60.9, 90.4, 96.2, 1.0, 4.0
2021-06-22 08:19:46,355 Current rsum is 515.1800000000001
2021-06-22 08:19:49,480 runs/coco_butd_region_bert/log
2021-06-22 08:19:49,480 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 08:19:49,482 image encoder trainable parameters: 3688352
2021-06-22 08:19:49,491 txt encoder trainable parameters: 120517280
2021-06-22 08:24:39,262 Epoch: [16][199/4426]	Eit 71000  lr 5e-05  Le 9.8650 (9.8580)	Time 1.552 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:29:18,607 Epoch: [16][399/4426]	Eit 71200  lr 5e-05  Le 9.8598 (9.8576)	Time 1.237 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:33:59,096 Epoch: [16][599/4426]	Eit 71400  lr 5e-05  Le 9.8609 (9.8575)	Time 1.195 (0.000)	Data 0.001 (0.000)	
2021-06-22 08:38:40,627 Epoch: [16][799/4426]	Eit 71600  lr 5e-05  Le 9.8753 (9.8568)	Time 1.333 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:43:21,755 Epoch: [16][999/4426]	Eit 71800  lr 5e-05  Le 9.8460 (9.8563)	Time 1.550 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:48:01,411 Epoch: [16][1199/4426]	Eit 72000  lr 5e-05  Le 9.8699 (9.8564)	Time 1.574 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:52:41,217 Epoch: [16][1399/4426]	Eit 72200  lr 5e-05  Le 9.8600 (9.8566)	Time 1.438 (0.000)	Data 0.002 (0.000)	
2021-06-22 08:56:47,400 Epoch: [16][1599/4426]	Eit 72400  lr 5e-05  Le 9.8528 (9.8564)	Time 1.202 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:01:26,036 Epoch: [16][1799/4426]	Eit 72600  lr 5e-05  Le 9.8491 (9.8563)	Time 1.534 (0.000)	Data 0.001 (0.000)	
2021-06-22 09:06:05,655 Epoch: [16][1999/4426]	Eit 72800  lr 5e-05  Le 9.8551 (9.8565)	Time 1.562 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:10:46,581 Epoch: [16][2199/4426]	Eit 73000  lr 5e-05  Le 9.8569 (9.8564)	Time 1.502 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:15:24,747 Epoch: [16][2399/4426]	Eit 73200  lr 5e-05  Le 9.8604 (9.8564)	Time 1.177 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:20:04,527 Epoch: [16][2599/4426]	Eit 73400  lr 5e-05  Le 9.8796 (9.8565)	Time 1.629 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:24:42,201 Epoch: [16][2799/4426]	Eit 73600  lr 5e-05  Le 9.8620 (9.8564)	Time 1.355 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:29:21,031 Epoch: [16][2999/4426]	Eit 73800  lr 5e-05  Le 9.8388 (9.8564)	Time 1.194 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:33:58,842 Epoch: [16][3199/4426]	Eit 74000  lr 5e-05  Le 9.8761 (9.8564)	Time 1.337 (0.000)	Data 0.009 (0.000)	
2021-06-22 09:38:40,637 Epoch: [16][3399/4426]	Eit 74200  lr 5e-05  Le 9.8395 (9.8563)	Time 1.492 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:43:21,479 Epoch: [16][3599/4426]	Eit 74400  lr 5e-05  Le 9.8327 (9.8562)	Time 1.618 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:47:58,152 Epoch: [16][3799/4426]	Eit 74600  lr 5e-05  Le 9.8812 (9.8564)	Time 1.527 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:52:35,705 Epoch: [16][3999/4426]	Eit 74800  lr 5e-05  Le 9.8598 (9.8563)	Time 1.231 (0.000)	Data 0.002 (0.000)	
2021-06-22 09:57:14,971 Epoch: [16][4199/4426]	Eit 75000  lr 5e-05  Le 9.8486 (9.8562)	Time 1.539 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:01:56,853 Epoch: [16][4399/4426]	Eit 75200  lr 5e-05  Le 9.8622 (9.8561)	Time 1.653 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:02:42,911 Test: [0/40]	Le 10.2000 (10.2000)	Time 8.841 (0.000)	
2021-06-22 10:03:04,603 calculate similarity time: 0.07096242904663086
2021-06-22 10:03:05,106 Image to text: 75.2, 95.8, 98.6, 1.0, 1.9
2021-06-22 10:03:05,587 Text to image: 61.4, 90.5, 96.1, 1.0, 4.0
2021-06-22 10:03:05,587 Current rsum is 517.6600000000001
2021-06-22 10:03:08,675 runs/coco_butd_region_bert/log
2021-06-22 10:03:08,675 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 10:03:08,677 image encoder trainable parameters: 3688352
2021-06-22 10:03:08,687 txt encoder trainable parameters: 120517280
2021-06-22 10:06:50,107 Epoch: [17][174/4426]	Eit 75400  lr 5e-05  Le 9.8341 (9.8517)	Time 1.541 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:11:31,760 Epoch: [17][374/4426]	Eit 75600  lr 5e-05  Le 9.8545 (9.8525)	Time 1.166 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:16:11,827 Epoch: [17][574/4426]	Eit 75800  lr 5e-05  Le 9.8426 (9.8530)	Time 1.568 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:20:50,802 Epoch: [17][774/4426]	Eit 76000  lr 5e-05  Le 9.8450 (9.8534)	Time 1.604 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:25:29,832 Epoch: [17][974/4426]	Eit 76200  lr 5e-05  Le 9.8409 (9.8534)	Time 1.543 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:30:08,368 Epoch: [17][1174/4426]	Eit 76400  lr 5e-05  Le 9.8887 (9.8532)	Time 1.132 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:34:49,762 Epoch: [17][1374/4426]	Eit 76600  lr 5e-05  Le 9.8501 (9.8536)	Time 1.307 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:39:32,661 Epoch: [17][1574/4426]	Eit 76800  lr 5e-05  Le 9.8715 (9.8533)	Time 1.187 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:44:12,628 Epoch: [17][1774/4426]	Eit 77000  lr 5e-05  Le 9.8324 (9.8532)	Time 1.369 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:48:51,652 Epoch: [17][1974/4426]	Eit 77200  lr 5e-05  Le 9.8606 (9.8533)	Time 1.199 (0.000)	Data 0.009 (0.000)	
2021-06-22 10:53:35,531 Epoch: [17][2174/4426]	Eit 77400  lr 5e-05  Le 9.8507 (9.8533)	Time 1.632 (0.000)	Data 0.002 (0.000)	
2021-06-22 10:58:13,219 Epoch: [17][2374/4426]	Eit 77600  lr 5e-05  Le 9.8600 (9.8532)	Time 1.509 (0.000)	Data 0.001 (0.000)	
2021-06-22 11:02:53,030 Epoch: [17][2574/4426]	Eit 77800  lr 5e-05  Le 9.8413 (9.8532)	Time 1.476 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:07:29,977 Epoch: [17][2774/4426]	Eit 78000  lr 5e-05  Le 9.8941 (9.8533)	Time 1.592 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:12:08,617 Epoch: [17][2974/4426]	Eit 78200  lr 5e-05  Le 9.8493 (9.8534)	Time 1.495 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:16:16,465 Epoch: [17][3174/4426]	Eit 78400  lr 5e-05  Le 9.8614 (9.8533)	Time 1.509 (0.000)	Data 0.003 (0.000)	
2021-06-22 11:20:55,530 Epoch: [17][3374/4426]	Eit 78600  lr 5e-05  Le 9.8341 (9.8532)	Time 1.283 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:25:36,017 Epoch: [17][3574/4426]	Eit 78800  lr 5e-05  Le 9.8446 (9.8533)	Time 1.190 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:30:13,498 Epoch: [17][3774/4426]	Eit 79000  lr 5e-05  Le 9.8482 (9.8534)	Time 1.413 (0.000)	Data 0.001 (0.000)	
2021-06-22 11:34:52,088 Epoch: [17][3974/4426]	Eit 79200  lr 5e-05  Le 9.8570 (9.8533)	Time 1.581 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:39:31,860 Epoch: [17][4174/4426]	Eit 79400  lr 5e-05  Le 9.8675 (9.8532)	Time 1.225 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:44:10,550 Epoch: [17][4374/4426]	Eit 79600  lr 5e-05  Le 9.8702 (9.8532)	Time 1.419 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:45:29,250 Test: [0/40]	Le 10.1992 (10.1991)	Time 8.283 (0.000)	
2021-06-22 11:45:51,091 calculate similarity time: 0.07569575309753418
2021-06-22 11:45:51,551 Image to text: 73.8, 95.9, 99.1, 1.0, 1.8
2021-06-22 11:45:51,982 Text to image: 61.2, 90.7, 96.0, 1.0, 4.1
2021-06-22 11:45:51,982 Current rsum is 516.78
2021-06-22 11:45:53,264 runs/coco_butd_region_bert/log
2021-06-22 11:45:53,264 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 11:45:53,265 image encoder trainable parameters: 3688352
2021-06-22 11:45:53,269 txt encoder trainable parameters: 120517280
2021-06-22 11:49:30,024 Epoch: [18][149/4426]	Eit 79800  lr 5e-05  Le 9.8581 (9.8541)	Time 1.184 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:54:10,442 Epoch: [18][349/4426]	Eit 80000  lr 5e-05  Le 9.8599 (9.8530)	Time 1.658 (0.000)	Data 0.002 (0.000)	
2021-06-22 11:58:48,209 Epoch: [18][549/4426]	Eit 80200  lr 5e-05  Le 9.8392 (9.8521)	Time 1.487 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:03:29,116 Epoch: [18][749/4426]	Eit 80400  lr 5e-05  Le 9.8203 (9.8517)	Time 1.265 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:08:08,539 Epoch: [18][949/4426]	Eit 80600  lr 5e-05  Le 9.8349 (9.8519)	Time 1.533 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:12:48,536 Epoch: [18][1149/4426]	Eit 80800  lr 5e-05  Le 9.8320 (9.8516)	Time 1.310 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:17:30,401 Epoch: [18][1349/4426]	Eit 81000  lr 5e-05  Le 9.8624 (9.8514)	Time 1.383 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:22:11,735 Epoch: [18][1549/4426]	Eit 81200  lr 5e-05  Le 9.8386 (9.8514)	Time 1.462 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:26:29,379 Epoch: [18][1749/4426]	Eit 81400  lr 5e-05  Le 9.8750 (9.8513)	Time 0.672 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:31:02,861 Epoch: [18][1949/4426]	Eit 81600  lr 5e-05  Le 9.8360 (9.8513)	Time 1.250 (0.000)	Data 0.001 (0.000)	
2021-06-22 12:35:41,719 Epoch: [18][2149/4426]	Eit 81800  lr 5e-05  Le 9.9103 (9.8512)	Time 1.556 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:40:21,063 Epoch: [18][2349/4426]	Eit 82000  lr 5e-05  Le 9.8411 (9.8513)	Time 1.180 (0.000)	Data 0.003 (0.000)	
2021-06-22 12:44:58,807 Epoch: [18][2549/4426]	Eit 82200  lr 5e-05  Le 9.8819 (9.8512)	Time 1.197 (0.000)	Data 0.001 (0.000)	
2021-06-22 12:49:38,431 Epoch: [18][2749/4426]	Eit 82400  lr 5e-05  Le 9.8233 (9.8512)	Time 1.227 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:54:17,437 Epoch: [18][2949/4426]	Eit 82600  lr 5e-05  Le 9.8482 (9.8513)	Time 1.379 (0.000)	Data 0.002 (0.000)	
2021-06-22 12:58:56,083 Epoch: [18][3149/4426]	Eit 82800  lr 5e-05  Le 9.8681 (9.8512)	Time 1.573 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:03:36,789 Epoch: [18][3349/4426]	Eit 83000  lr 5e-05  Le 9.8461 (9.8512)	Time 1.580 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:08:14,131 Epoch: [18][3549/4426]	Eit 83200  lr 5e-05  Le 9.8632 (9.8511)	Time 1.537 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:12:55,547 Epoch: [18][3749/4426]	Eit 83400  lr 5e-05  Le 9.8743 (9.8511)	Time 1.404 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:17:37,070 Epoch: [18][3949/4426]	Eit 83600  lr 5e-05  Le 9.8637 (9.8510)	Time 1.503 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:22:15,905 Epoch: [18][4149/4426]	Eit 83800  lr 5e-05  Le 9.8517 (9.8510)	Time 1.282 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:26:54,311 Epoch: [18][4349/4426]	Eit 84000  lr 5e-05  Le 9.8399 (9.8511)	Time 1.227 (0.000)	Data 0.003 (0.000)	
2021-06-22 13:28:47,609 Test: [0/40]	Le 10.2034 (10.2034)	Time 8.259 (0.000)	
2021-06-22 13:29:09,861 calculate similarity time: 0.05920743942260742
2021-06-22 13:29:10,307 Image to text: 74.5, 96.0, 98.8, 1.0, 1.9
2021-06-22 13:29:10,632 Text to image: 61.6, 90.5, 96.1, 1.0, 4.2
2021-06-22 13:29:10,632 Current rsum is 517.46
2021-06-22 13:29:11,881 runs/coco_butd_region_bert/log
2021-06-22 13:29:11,881 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 13:29:11,882 image encoder trainable parameters: 3688352
2021-06-22 13:29:11,887 txt encoder trainable parameters: 120517280
2021-06-22 13:32:14,382 Epoch: [19][124/4426]	Eit 84200  lr 5e-05  Le 9.8520 (9.8510)	Time 1.399 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:36:36,786 Epoch: [19][324/4426]	Eit 84400  lr 5e-05  Le 9.8417 (9.8486)	Time 0.666 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:41:02,281 Epoch: [19][524/4426]	Eit 84600  lr 5e-05  Le 9.8408 (9.8490)	Time 1.521 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:45:40,457 Epoch: [19][724/4426]	Eit 84800  lr 5e-05  Le 9.8436 (9.8494)	Time 1.446 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:50:18,257 Epoch: [19][924/4426]	Eit 85000  lr 5e-05  Le 9.8325 (9.8500)	Time 1.536 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:54:56,537 Epoch: [19][1124/4426]	Eit 85200  lr 5e-05  Le 9.8220 (9.8497)	Time 1.271 (0.000)	Data 0.002 (0.000)	
2021-06-22 13:59:34,618 Epoch: [19][1324/4426]	Eit 85400  lr 5e-05  Le 9.8397 (9.8498)	Time 1.246 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:04:16,604 Epoch: [19][1524/4426]	Eit 85600  lr 5e-05  Le 9.8588 (9.8498)	Time 1.369 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:08:59,349 Epoch: [19][1724/4426]	Eit 85800  lr 5e-05  Le 9.8390 (9.8498)	Time 1.506 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:13:38,032 Epoch: [19][1924/4426]	Eit 86000  lr 5e-05  Le 9.8471 (9.8498)	Time 1.482 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:18:16,075 Epoch: [19][2124/4426]	Eit 86200  lr 5e-05  Le 9.8601 (9.8499)	Time 1.273 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:22:54,048 Epoch: [19][2324/4426]	Eit 86400  lr 5e-05  Le 9.8298 (9.8499)	Time 1.454 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:27:35,580 Epoch: [19][2524/4426]	Eit 86600  lr 5e-05  Le 9.8531 (9.8499)	Time 1.454 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:32:15,117 Epoch: [19][2724/4426]	Eit 86800  lr 5e-05  Le 9.8516 (9.8499)	Time 1.225 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:36:58,190 Epoch: [19][2924/4426]	Eit 87000  lr 5e-05  Le 9.8269 (9.8499)	Time 1.566 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:41:38,929 Epoch: [19][3124/4426]	Eit 87200  lr 5e-05  Le 9.8627 (9.8499)	Time 1.530 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:46:19,600 Epoch: [19][3324/4426]	Eit 87400  lr 5e-05  Le 9.8483 (9.8499)	Time 1.186 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:50:26,836 Epoch: [19][3524/4426]	Eit 87600  lr 5e-05  Le 9.8497 (9.8498)	Time 1.328 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:55:05,836 Epoch: [19][3724/4426]	Eit 87800  lr 5e-05  Le 9.8462 (9.8498)	Time 1.170 (0.000)	Data 0.002 (0.000)	
2021-06-22 14:59:42,749 Epoch: [19][3924/4426]	Eit 88000  lr 5e-05  Le 9.8657 (9.8498)	Time 1.273 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:04:21,890 Epoch: [19][4124/4426]	Eit 88200  lr 5e-05  Le 9.8493 (9.8497)	Time 1.121 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:08:59,508 Epoch: [19][4324/4426]	Eit 88400  lr 5e-05  Le 9.8650 (9.8497)	Time 1.500 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:11:30,920 Test: [0/40]	Le 10.2054 (10.2054)	Time 9.959 (0.000)	
2021-06-22 15:11:52,003 calculate similarity time: 0.05549502372741699
2021-06-22 15:11:52,400 Image to text: 75.8, 95.9, 99.1, 1.0, 1.9
2021-06-22 15:11:52,714 Text to image: 61.4, 90.4, 96.0, 1.0, 4.3
2021-06-22 15:11:52,714 Current rsum is 518.48
2021-06-22 15:11:56,013 runs/coco_butd_region_bert/log
2021-06-22 15:11:56,014 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 15:11:56,015 image encoder trainable parameters: 3688352
2021-06-22 15:11:56,022 txt encoder trainable parameters: 120517280
2021-06-22 15:14:26,010 Epoch: [20][99/4426]	Eit 88600  lr 5e-05  Le 9.8981 (9.8473)	Time 1.296 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:19:01,990 Epoch: [20][299/4426]	Eit 88800  lr 5e-05  Le 9.8495 (9.8481)	Time 1.205 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:23:39,582 Epoch: [20][499/4426]	Eit 89000  lr 5e-05  Le 9.8454 (9.8476)	Time 1.239 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:28:18,780 Epoch: [20][699/4426]	Eit 89200  lr 5e-05  Le 9.8480 (9.8481)	Time 1.710 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:32:57,219 Epoch: [20][899/4426]	Eit 89400  lr 5e-05  Le 9.8490 (9.8481)	Time 1.351 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:37:35,920 Epoch: [20][1099/4426]	Eit 89600  lr 5e-05  Le 9.8360 (9.8485)	Time 1.188 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:42:14,305 Epoch: [20][1299/4426]	Eit 89800  lr 5e-05  Le 9.8683 (9.8485)	Time 1.353 (0.000)	Data 0.009 (0.000)	
2021-06-22 15:46:55,343 Epoch: [20][1499/4426]	Eit 90000  lr 5e-05  Le 9.8131 (9.8484)	Time 1.256 (0.000)	Data 0.002 (0.000)	
2021-06-22 15:51:32,294 Epoch: [20][1699/4426]	Eit 90200  lr 5e-05  Le 9.8521 (9.8482)	Time 1.199 (0.000)	Data 0.001 (0.000)	
2021-06-22 15:56:11,204 Epoch: [20][1899/4426]	Eit 90400  lr 5e-05  Le 9.8234 (9.8482)	Time 1.453 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:00:16,945 Epoch: [20][2099/4426]	Eit 90600  lr 5e-05  Le 9.8748 (9.8485)	Time 1.592 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:04:56,022 Epoch: [20][2299/4426]	Eit 90800  lr 5e-05  Le 9.8752 (9.8486)	Time 1.524 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:09:33,551 Epoch: [20][2499/4426]	Eit 91000  lr 5e-05  Le 9.8560 (9.8488)	Time 1.401 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:14:13,279 Epoch: [20][2699/4426]	Eit 91200  lr 5e-05  Le 9.8663 (9.8487)	Time 1.190 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:18:51,972 Epoch: [20][2899/4426]	Eit 91400  lr 5e-05  Le 9.8876 (9.8487)	Time 1.068 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:23:30,049 Epoch: [20][3099/4426]	Eit 91600  lr 5e-05  Le 9.8223 (9.8486)	Time 1.544 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:28:06,817 Epoch: [20][3299/4426]	Eit 91800  lr 5e-05  Le 9.8350 (9.8486)	Time 1.585 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:32:44,741 Epoch: [20][3499/4426]	Eit 92000  lr 5e-05  Le 9.8563 (9.8486)	Time 1.453 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:37:20,474 Epoch: [20][3699/4426]	Eit 92200  lr 5e-05  Le 9.8665 (9.8486)	Time 1.253 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:41:56,987 Epoch: [20][3899/4426]	Eit 92400  lr 5e-05  Le 9.8887 (9.8486)	Time 1.634 (0.000)	Data 0.003 (0.000)	
2021-06-22 16:46:34,382 Epoch: [20][4099/4426]	Eit 92600  lr 5e-05  Le 9.8382 (9.8485)	Time 1.132 (0.000)	Data 0.003 (0.000)	
2021-06-22 16:51:11,678 Epoch: [20][4299/4426]	Eit 92800  lr 5e-05  Le 9.8648 (9.8485)	Time 1.229 (0.000)	Data 0.002 (0.000)	
2021-06-22 16:54:16,934 Test: [0/40]	Le 10.2031 (10.2031)	Time 9.279 (0.000)	
2021-06-22 16:54:38,624 calculate similarity time: 0.08243298530578613
2021-06-22 16:54:39,097 Image to text: 74.9, 96.1, 99.1, 1.0, 1.8
2021-06-22 16:54:39,414 Text to image: 61.9, 90.5, 95.8, 1.0, 4.3
2021-06-22 16:54:39,414 Current rsum is 518.3
2021-06-22 16:54:40,635 runs/coco_butd_region_bert/log
2021-06-22 16:54:40,635 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 16:54:40,636 image encoder trainable parameters: 3688352
2021-06-22 16:54:40,640 txt encoder trainable parameters: 120517280
2021-06-22 16:56:32,650 Epoch: [21][74/4426]	Eit 93000  lr 5e-05  Le 9.8524 (9.8465)	Time 1.329 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:01:12,490 Epoch: [21][274/4426]	Eit 93200  lr 5e-05  Le 9.8455 (9.8478)	Time 1.511 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:05:51,718 Epoch: [21][474/4426]	Eit 93400  lr 5e-05  Le 9.8768 (9.8478)	Time 1.382 (0.000)	Data 0.004 (0.000)	
2021-06-22 17:08:56,087 Epoch: [21][674/4426]	Eit 93600  lr 5e-05  Le 9.8250 (9.8482)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:10:59,088 Epoch: [21][874/4426]	Eit 93800  lr 5e-05  Le 9.8354 (9.8474)	Time 0.583 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:13:03,633 Epoch: [21][1074/4426]	Eit 94000  lr 5e-05  Le 9.8607 (9.8472)	Time 0.682 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:15:05,879 Epoch: [21][1274/4426]	Eit 94200  lr 5e-05  Le 9.8621 (9.8473)	Time 0.607 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:17:08,180 Epoch: [21][1474/4426]	Eit 94400  lr 5e-05  Le 9.8164 (9.8469)	Time 0.574 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:19:08,205 Epoch: [21][1674/4426]	Eit 94600  lr 5e-05  Le 9.8742 (9.8470)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:21:08,911 Epoch: [21][1874/4426]	Eit 94800  lr 5e-05  Le 9.8606 (9.8467)	Time 0.557 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:23:11,248 Epoch: [21][2074/4426]	Eit 95000  lr 5e-05  Le 9.8588 (9.8468)	Time 0.607 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:25:12,836 Epoch: [21][2274/4426]	Eit 95200  lr 5e-05  Le 9.8489 (9.8467)	Time 0.605 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:27:12,178 Epoch: [21][2474/4426]	Eit 95400  lr 5e-05  Le 9.8486 (9.8465)	Time 0.538 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:29:13,803 Epoch: [21][2674/4426]	Eit 95600  lr 5e-05  Le 9.8364 (9.8466)	Time 0.600 (0.000)	Data 0.007 (0.000)	
2021-06-22 17:31:14,777 Epoch: [21][2874/4426]	Eit 95800  lr 5e-05  Le 9.8475 (9.8466)	Time 0.589 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:33:15,740 Epoch: [21][3074/4426]	Eit 96000  lr 5e-05  Le 9.8485 (9.8467)	Time 0.562 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:35:15,447 Epoch: [21][3274/4426]	Eit 96200  lr 5e-05  Le 9.8508 (9.8468)	Time 0.658 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:37:18,615 Epoch: [21][3474/4426]	Eit 96400  lr 5e-05  Le 9.8652 (9.8469)	Time 0.571 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:39:19,683 Epoch: [21][3674/4426]	Eit 96600  lr 5e-05  Le 9.8337 (9.8469)	Time 0.613 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:41:21,590 Epoch: [21][3874/4426]	Eit 96800  lr 5e-05  Le 9.8334 (9.8469)	Time 0.586 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:43:21,229 Epoch: [21][4074/4426]	Eit 97000  lr 5e-05  Le 9.8321 (9.8469)	Time 0.585 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:45:20,250 Epoch: [21][4274/4426]	Eit 97200  lr 5e-05  Le 9.8261 (9.8470)	Time 0.561 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:47:01,156 Test: [0/40]	Le 10.2030 (10.2030)	Time 9.491 (0.000)	
2021-06-22 17:47:12,014 calculate similarity time: 0.04786419868469238
2021-06-22 17:47:12,399 Image to text: 76.7, 96.0, 99.1, 1.0, 2.0
2021-06-22 17:47:12,713 Text to image: 61.8, 90.6, 96.0, 1.0, 4.3
2021-06-22 17:47:12,714 Current rsum is 520.22
2021-06-22 17:47:15,530 runs/coco_butd_region_bert/log
2021-06-22 17:47:15,530 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 17:47:15,532 image encoder trainable parameters: 3688352
2021-06-22 17:47:15,543 txt encoder trainable parameters: 120517280
2021-06-22 17:47:53,923 Epoch: [22][49/4426]	Eit 97400  lr 5e-05  Le 9.8322 (9.8416)	Time 0.580 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:49:54,794 Epoch: [22][249/4426]	Eit 97600  lr 5e-05  Le 9.8360 (9.8448)	Time 0.562 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:51:56,725 Epoch: [22][449/4426]	Eit 97800  lr 5e-05  Le 9.8251 (9.8440)	Time 0.763 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:53:56,942 Epoch: [22][649/4426]	Eit 98000  lr 5e-05  Le 9.8681 (9.8447)	Time 0.596 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:55:57,449 Epoch: [22][849/4426]	Eit 98200  lr 5e-05  Le 9.8206 (9.8451)	Time 0.592 (0.000)	Data 0.002 (0.000)	
2021-06-22 17:58:00,100 Epoch: [22][1049/4426]	Eit 98400  lr 5e-05  Le 9.8611 (9.8456)	Time 0.607 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:00:00,047 Epoch: [22][1249/4426]	Eit 98600  lr 5e-05  Le 9.8239 (9.8457)	Time 0.620 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:01:59,087 Epoch: [22][1449/4426]	Eit 98800  lr 5e-05  Le 9.8241 (9.8457)	Time 0.573 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:03:57,811 Epoch: [22][1649/4426]	Eit 99000  lr 5e-05  Le 9.8450 (9.8455)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:05:58,078 Epoch: [22][1849/4426]	Eit 99200  lr 5e-05  Le 9.8126 (9.8455)	Time 0.654 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:08:02,254 Epoch: [22][2049/4426]	Eit 99400  lr 5e-05  Le 9.8185 (9.8454)	Time 0.670 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:10:02,112 Epoch: [22][2249/4426]	Eit 99600  lr 5e-05  Le 9.8563 (9.8452)	Time 0.558 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:12:00,028 Epoch: [22][2449/4426]	Eit 99800  lr 5e-05  Le 9.8588 (9.8453)	Time 0.533 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:13:59,514 Epoch: [22][2649/4426]	Eit 100000  lr 5e-05  Le 9.8715 (9.8451)	Time 0.574 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:15:57,476 Epoch: [22][2849/4426]	Eit 100200  lr 5e-05  Le 9.8744 (9.8450)	Time 0.560 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:17:58,078 Epoch: [22][3049/4426]	Eit 100400  lr 5e-05  Le 9.8561 (9.8451)	Time 0.573 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:19:56,192 Epoch: [22][3249/4426]	Eit 100600  lr 5e-05  Le 9.8587 (9.8452)	Time 0.575 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:21:56,581 Epoch: [22][3449/4426]	Eit 100800  lr 5e-05  Le 9.8533 (9.8453)	Time 0.633 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:24:00,239 Epoch: [22][3649/4426]	Eit 101000  lr 5e-05  Le 9.8604 (9.8452)	Time 0.594 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:25:58,225 Epoch: [22][3849/4426]	Eit 101200  lr 5e-05  Le 9.8684 (9.8453)	Time 0.565 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:28:01,033 Epoch: [22][4049/4426]	Eit 101400  lr 5e-05  Le 9.8509 (9.8453)	Time 0.727 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:30:02,259 Epoch: [22][4249/4426]	Eit 101600  lr 5e-05  Le 9.8518 (9.8452)	Time 0.735 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:31:56,994 Test: [0/40]	Le 10.2047 (10.2047)	Time 9.417 (0.000)	
2021-06-22 18:32:07,768 calculate similarity time: 0.049007415771484375
2021-06-22 18:32:08,280 Image to text: 75.5, 96.3, 98.9, 1.0, 2.0
2021-06-22 18:32:08,602 Text to image: 61.5, 90.5, 95.9, 1.0, 4.3
2021-06-22 18:32:08,602 Current rsum is 518.54
2021-06-22 18:32:09,777 runs/coco_butd_region_bert/log
2021-06-22 18:32:09,778 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 18:32:09,779 image encoder trainable parameters: 3688352
2021-06-22 18:32:09,789 txt encoder trainable parameters: 120517280
2021-06-22 18:32:34,183 Epoch: [23][24/4426]	Eit 101800  lr 5e-05  Le 9.8307 (9.8445)	Time 0.538 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:34:34,557 Epoch: [23][224/4426]	Eit 102000  lr 5e-05  Le 9.8316 (9.8438)	Time 0.596 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:36:34,841 Epoch: [23][424/4426]	Eit 102200  lr 5e-05  Le 9.8325 (9.8441)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:38:35,979 Epoch: [23][624/4426]	Eit 102400  lr 5e-05  Le 9.8819 (9.8438)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:40:37,351 Epoch: [23][824/4426]	Eit 102600  lr 5e-05  Le 9.8382 (9.8439)	Time 0.606 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:42:38,706 Epoch: [23][1024/4426]	Eit 102800  lr 5e-05  Le 9.8725 (9.8445)	Time 0.656 (0.000)	Data 0.005 (0.000)	
2021-06-22 18:44:41,052 Epoch: [23][1224/4426]	Eit 103000  lr 5e-05  Le 9.8277 (9.8443)	Time 0.621 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:46:40,789 Epoch: [23][1424/4426]	Eit 103200  lr 5e-05  Le 9.8549 (9.8441)	Time 0.627 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:48:41,417 Epoch: [23][1624/4426]	Eit 103400  lr 5e-05  Le 9.8055 (9.8443)	Time 0.558 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:50:42,462 Epoch: [23][1824/4426]	Eit 103600  lr 5e-05  Le 9.8374 (9.8443)	Time 0.715 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:52:43,494 Epoch: [23][2024/4426]	Eit 103800  lr 5e-05  Le 9.8158 (9.8443)	Time 0.590 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:54:41,967 Epoch: [23][2224/4426]	Eit 104000  lr 5e-05  Le 9.8285 (9.8442)	Time 0.559 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:56:40,617 Epoch: [23][2424/4426]	Eit 104200  lr 5e-05  Le 9.8250 (9.8442)	Time 0.578 (0.000)	Data 0.002 (0.000)	
2021-06-22 18:58:41,166 Epoch: [23][2624/4426]	Eit 104400  lr 5e-05  Le 9.8382 (9.8442)	Time 0.667 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:00:44,469 Epoch: [23][2824/4426]	Eit 104600  lr 5e-05  Le 9.8342 (9.8442)	Time 0.652 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:02:46,481 Epoch: [23][3024/4426]	Eit 104800  lr 5e-05  Le 9.8372 (9.8442)	Time 0.579 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:04:45,434 Epoch: [23][3224/4426]	Eit 105000  lr 5e-05  Le 9.8530 (9.8444)	Time 0.617 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:06:47,275 Epoch: [23][3424/4426]	Eit 105200  lr 5e-05  Le 9.8371 (9.8444)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:08:50,269 Epoch: [23][3624/4426]	Eit 105400  lr 5e-05  Le 9.8142 (9.8444)	Time 0.615 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:10:49,708 Epoch: [23][3824/4426]	Eit 105600  lr 5e-05  Le 9.8673 (9.8444)	Time 0.735 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:12:51,709 Epoch: [23][4024/4426]	Eit 105800  lr 5e-05  Le 9.8642 (9.8445)	Time 0.558 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:14:50,708 Epoch: [23][4224/4426]	Eit 106000  lr 5e-05  Le 9.8275 (9.8445)	Time 0.581 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:16:50,341 Epoch: [23][4424/4426]	Eit 106200  lr 5e-05  Le 9.8608 (9.8446)	Time 0.609 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:17:00,701 Test: [0/40]	Le 10.2034 (10.2034)	Time 9.084 (0.000)	
2021-06-22 19:17:12,373 calculate similarity time: 0.060157060623168945
2021-06-22 19:17:12,893 Image to text: 75.1, 95.8, 99.0, 1.0, 2.0
2021-06-22 19:17:13,236 Text to image: 61.5, 90.3, 95.5, 1.0, 4.4
2021-06-22 19:17:13,236 Current rsum is 517.22
2021-06-22 19:17:14,580 runs/coco_butd_region_bert/log
2021-06-22 19:17:14,580 runs/coco_butd_region_bert
Use VSE++ objective.
2021-06-22 19:17:14,581 image encoder trainable parameters: 3688352
2021-06-22 19:17:14,586 txt encoder trainable parameters: 120517280
2021-06-22 19:19:27,619 Epoch: [24][199/4426]	Eit 106400  lr 5e-05  Le 9.8669 (9.8428)	Time 0.766 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:21:30,482 Epoch: [24][399/4426]	Eit 106600  lr 5e-05  Le 9.8306 (9.8440)	Time 0.661 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:23:33,586 Epoch: [24][599/4426]	Eit 106800  lr 5e-05  Le 9.8480 (9.8439)	Time 0.645 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:25:36,032 Epoch: [24][799/4426]	Eit 107000  lr 5e-05  Le 9.8631 (9.8435)	Time 0.639 (0.000)	Data 0.003 (0.000)	
2021-06-22 19:27:36,871 Epoch: [24][999/4426]	Eit 107200  lr 5e-05  Le 9.8508 (9.8439)	Time 0.620 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:29:36,085 Epoch: [24][1199/4426]	Eit 107400  lr 5e-05  Le 9.8437 (9.8436)	Time 0.647 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:31:33,505 Epoch: [24][1399/4426]	Eit 107600  lr 5e-05  Le 9.8495 (9.8436)	Time 0.597 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:33:33,993 Epoch: [24][1599/4426]	Eit 107800  lr 5e-05  Le 9.8527 (9.8435)	Time 0.735 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:35:33,868 Epoch: [24][1799/4426]	Eit 108000  lr 5e-05  Le 9.8157 (9.8435)	Time 0.613 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:37:33,755 Epoch: [24][1999/4426]	Eit 108200  lr 5e-05  Le 9.8493 (9.8434)	Time 0.565 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:39:34,561 Epoch: [24][2199/4426]	Eit 108400  lr 5e-05  Le 9.8305 (9.8435)	Time 0.744 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:41:33,543 Epoch: [24][2399/4426]	Eit 108600  lr 5e-05  Le 9.8499 (9.8435)	Time 0.550 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:44:53,655 Epoch: [24][2599/4426]	Eit 108800  lr 5e-05  Le 9.8492 (9.8436)	Time 0.617 (0.000)	Data 0.004 (0.000)	
2021-06-22 19:46:53,438 Epoch: [24][2799/4426]	Eit 109000  lr 5e-05  Le 9.8173 (9.8437)	Time 0.600 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:48:55,861 Epoch: [24][2999/4426]	Eit 109200  lr 5e-05  Le 9.8695 (9.8438)	Time 0.941 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:51:11,476 Epoch: [24][3199/4426]	Eit 109400  lr 5e-05  Le 9.8257 (9.8438)	Time 1.278 (0.000)	Data 0.001 (0.000)	
2021-06-22 19:55:26,385 Epoch: [24][3399/4426]	Eit 109600  lr 5e-05  Le 9.8947 (9.8440)	Time 0.601 (0.000)	Data 0.002 (0.000)	
2021-06-22 19:59:23,274 Epoch: [24][3599/4426]	Eit 109800  lr 5e-05  Le 9.8343 (9.8440)	Time 1.175 (0.000)	Data 0.002 (0.000)	
2021-06-22 20:04:11,108 Epoch: [24][3799/4426]	Eit 110000  lr 5e-05  Le 9.8300 (9.8439)	Time 1.488 (0.000)	Data 0.002 (0.000)	
2021-06-22 20:09:07,004 Epoch: [24][3999/4426]	Eit 110200  lr 5e-05  Le 9.8098 (9.8439)	Time 1.597 (0.000)	Data 0.001 (0.000)	
2021-06-22 20:13:58,643 Epoch: [24][4199/4426]	Eit 110400  lr 5e-05  Le 9.8289 (9.8439)	Time 1.644 (0.000)	Data 0.002 (0.000)	
2021-06-22 20:18:29,373 Epoch: [24][4399/4426]	Eit 110600  lr 5e-05  Le 9.8302 (9.8439)	Time 1.490 (0.000)	Data 0.002 (0.000)	
2021-06-22 20:19:15,717 Test: [0/40]	Le 10.2030 (10.2030)	Time 9.560 (0.000)	
2021-06-22 20:19:38,447 calculate similarity time: 0.07892084121704102
2021-06-22 20:19:38,910 Image to text: 75.6, 96.2, 99.1, 1.0, 2.1
2021-06-22 20:19:39,226 Text to image: 61.6, 90.5, 95.8, 1.0, 4.3
2021-06-22 20:19:39,226 Current rsum is 518.8
You have new mail in /var/spool/mail/root
[root@gpu1 vse_infty-master-my-graph-gru-unified-no-graph-no-pooling]# CUDA_VISIBLE_DEVICES=0,1 python3 eval.py --dataset coco --data_path ../data/coco
INFO:root:Evaluating runs/coco_butd_region_bert...
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
/root/anaconda3/lib/python3.6/site-packages/torch/nn/modules/rnn.py:735: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at  /pytorch/aten/src/ATen/native/cudnn/RNN.cpp:1264.)
  self.dropout, self.training, self.bidirectional, self.batch_first)
INFO:lib.evaluation:Test: [0/196]	Le 10.2218 (10.2218)	Time 5.957 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2164 (10.2136)	Time 0.645 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2227 (10.2137)	Time 0.555 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2258 (10.2154)	Time 0.477 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2330 (10.2140)	Time 0.476 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2081 (10.2140)	Time 0.560 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2197 (10.2146)	Time 0.493 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2301 (10.2142)	Time 0.565 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2138 (10.2146)	Time 0.621 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2159 (10.2152)	Time 0.520 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2257 (10.2158)	Time 0.468 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.2062 (10.2155)	Time 0.544 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2461 (10.2158)	Time 0.597 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2053 (10.2160)	Time 0.612 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2444 (10.2162)	Time 0.534 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.2120 (10.2165)	Time 0.556 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2260 (10.2166)	Time 0.496 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2152 (10.2165)	Time 0.575 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.2061 (10.2162)	Time 0.474 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1990 (10.2166)	Time 0.508 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.10186648368835449
INFO:lib.evaluation:Image to text: 74.0, 95.4, 98.0, 1.0, 1.9
INFO:lib.evaluation:Text to image: 59.5, 89.6, 94.8, 1.0, 4.6
INFO:lib.evaluation:rsum: 511.2 ar: 89.1 ari: 81.3
INFO:lib.evaluation:calculate similarity time: 0.11366009712219238
INFO:lib.evaluation:Image to text: 73.9, 93.9, 97.8, 1.0, 2.1
INFO:lib.evaluation:Text to image: 58.8, 87.3, 93.8, 1.0, 5.5
INFO:lib.evaluation:rsum: 505.4 ar: 88.5 ari: 79.9
INFO:lib.evaluation:calculate similarity time: 0.12491822242736816
INFO:lib.evaluation:Image to text: 73.4, 94.7, 98.2, 1.0, 2.0
INFO:lib.evaluation:Text to image: 58.8, 88.7, 94.6, 1.0, 4.9
INFO:lib.evaluation:rsum: 508.4 ar: 88.8 ari: 80.7
INFO:lib.evaluation:calculate similarity time: 0.11034893989562988
INFO:lib.evaluation:Image to text: 72.7, 94.4, 98.1, 1.0, 2.0
INFO:lib.evaluation:Text to image: 56.1, 87.7, 94.6, 1.0, 4.2
INFO:lib.evaluation:rsum: 503.6 ar: 88.4 ari: 79.5
INFO:lib.evaluation:calculate similarity time: 0.12340760231018066
INFO:lib.evaluation:Image to text: 73.1, 94.4, 97.6, 1.0, 2.0
INFO:lib.evaluation:Text to image: 58.9, 88.8, 94.7, 1.0, 4.4
INFO:lib.evaluation:rsum: 507.5 ar: 88.4 ari: 80.8
INFO:lib.evaluation:-----------------------------------
INFO:lib.evaluation:Mean metrics: 
INFO:lib.evaluation:rsum: 507.2
INFO:lib.evaluation:Average i2t Recall: 88.6
INFO:lib.evaluation:Image to text: 73.4 94.6 97.9 1.0 2.0
INFO:lib.evaluation:Average t2i Recall: 80.4
INFO:lib.evaluation:Text to image: 58.4 88.4 94.5 1.0 4.7
INFO:lib.evaluation:Namespace(backbone_lr_factor=0.01, backbone_path='', backbone_source='detector', backbone_warmup_epochs=5, batch_size=128, data_name='coco', data_path='../data/coco', embed_size=1024, embedding_warmup_epochs=2, grad_clip=2.0, img_dim=2048, input_scale_factor=1, learning_rate=0.0005, log_step=200, logger_name='runs/coco_butd_region_bert/log', lr_update=15, margin=0.2, max_violation=True, model_name='runs/coco_butd_region_bert', no_imgnorm=False, no_txtnorm=False, num_epochs=25, optim='adam', precomp_enc_type='basic', reset_start_epoch=False, resume='', val_step=500, vocab_path='./vocab/', vocab_size=30522, vse_mean_warmup_epochs=1, word_dim=300, workers=5)
INFO:transformers.tokenization_utils:loading file https://s3.amazonaws.com/models.huggingface.co/bert/bert-base-uncased-vocab.txt from cache at /root/.cache/torch/transformers/26bc1ad6c0ac742e9b52263248f6d0f00068293b33709fae12320c0e35ccfbbb.542ce4285a40d23a559526243235df47c5f75c197f04f37d1a0c124c32c9a084
INFO:transformers.configuration_utils:loading configuration file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/config.json
INFO:transformers.configuration_utils:Model config {
  "attention_probs_dropout_prob": 0.1,
  "finetuning_task": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_labels": 2,
  "output_attentions": false,
  "output_hidden_states": false,
  "pruned_heads": {},
  "torchscript": false,
  "type_vocab_size": 2,
  "use_bfloat16": false,
  "vocab_size": 30522
}

INFO:transformers.modeling_utils:loading weights file /public/ZZX/SCAN_dataset/vse_infty-master/bert-base-uncased/pytorch_model.bin
INFO:lib.vse:Use adam as the optimizer, with init lr 0.0005
INFO:lib.vse:Image encoder is data paralleled now.
INFO:lib.evaluation:Loading dataset
INFO:lib.evaluation:Computing results...
INFO:lib.evaluation:Test: [0/196]	Le 10.2218 (10.2218)	Time 2.067 (0.000)	
INFO:lib.evaluation:Test: [10/196]	Le 10.2164 (10.2136)	Time 0.634 (0.000)	
INFO:lib.evaluation:Test: [20/196]	Le 10.2227 (10.2137)	Time 0.542 (0.000)	
INFO:lib.evaluation:Test: [30/196]	Le 10.2258 (10.2154)	Time 0.567 (0.000)	
INFO:lib.evaluation:Test: [40/196]	Le 10.2330 (10.2140)	Time 0.534 (0.000)	
INFO:lib.evaluation:Test: [50/196]	Le 10.2081 (10.2140)	Time 0.558 (0.000)	
INFO:lib.evaluation:Test: [60/196]	Le 10.2197 (10.2146)	Time 0.512 (0.000)	
INFO:lib.evaluation:Test: [70/196]	Le 10.2301 (10.2142)	Time 0.501 (0.000)	
INFO:lib.evaluation:Test: [80/196]	Le 10.2138 (10.2146)	Time 0.482 (0.000)	
INFO:lib.evaluation:Test: [90/196]	Le 10.2159 (10.2152)	Time 0.683 (0.000)	
INFO:lib.evaluation:Test: [100/196]	Le 10.2257 (10.2158)	Time 0.584 (0.000)	
INFO:lib.evaluation:Test: [110/196]	Le 10.2062 (10.2155)	Time 0.545 (0.000)	
INFO:lib.evaluation:Test: [120/196]	Le 10.2461 (10.2158)	Time 0.518 (0.000)	
INFO:lib.evaluation:Test: [130/196]	Le 10.2053 (10.2160)	Time 0.547 (0.000)	
INFO:lib.evaluation:Test: [140/196]	Le 10.2444 (10.2162)	Time 0.536 (0.000)	
INFO:lib.evaluation:Test: [150/196]	Le 10.2120 (10.2165)	Time 0.495 (0.000)	
INFO:lib.evaluation:Test: [160/196]	Le 10.2260 (10.2166)	Time 0.528 (0.000)	
INFO:lib.evaluation:Test: [170/196]	Le 10.2152 (10.2165)	Time 0.596 (0.000)	
INFO:lib.evaluation:Test: [180/196]	Le 10.2061 (10.2162)	Time 0.551 (0.000)	
INFO:lib.evaluation:Test: [190/196]	Le 10.1990 (10.2166)	Time 0.615 (0.000)	
INFO:lib.evaluation:Images: 5000, Captions: 25000
INFO:lib.evaluation:calculate similarity time: 0.9770543575286865
INFO:lib.evaluation:rsum: 399.1
INFO:lib.evaluation:Average i2t Recall: 72.9
INFO:lib.evaluation:Image to text: 49.8 80.0 88.7 2.0 5.7
INFO:lib.evaluation:Average t2i Recall: 60.2
INFO:lib.evaluation:Text to image: 35.5 66.7 78.2 3.0 19.3
INFO:root:Evaluating runs/coco_butd_grid_bert...
Traceback (most recent call last):
  File "eval.py", line 58, in <module>
    main()
  File "eval.py", line 46, in main
    evaluation.evalrank(model_path, data_path=opt.data_path, split='testall', fold5=True)
  File "/public/ZZX/SCAN_dataset/vse_infty-master-my-graph-gru-unified-no-graph-no-pooling/lib/evaluation.py", line 196, in evalrank
    checkpoint = torch.load(model_path)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 571, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 229, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/root/anaconda3/lib/python3.6/site-packages/torch/serialization.py", line 210, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'runs/coco_butd_grid_bert/model_best.pth'
[root@gpu1 vse_infty-master-my-graph-gru-unified-no-graph-no-pooling]# 

